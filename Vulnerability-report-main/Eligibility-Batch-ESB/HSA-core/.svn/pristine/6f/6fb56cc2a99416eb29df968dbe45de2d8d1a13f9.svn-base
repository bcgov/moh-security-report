/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package ca.bc.gov.moh.hsa.util.audit;

import java.io.File;
import org.apache.camel.component.file.FileEndpoint;
import org.apache.camel.component.file.FileOperations;
import org.apache.camel.component.file.GenericFileProducer;

/**
 *
 * @author conrad.gustafson
 */
public class AuditErrorFileEndPoint extends FileEndpoint {

    private final String messageContext;
    private final FileDropComponent fileDropComponent;
    
    public AuditErrorFileEndPoint(String endpointUri, FileDropComponent fileDropComponent, String messageContext) {
        super(endpointUri, fileDropComponent);
        this.messageContext = messageContext;
        this.fileDropComponent = fileDropComponent;
    }
    
    @Override
    public GenericFileProducer<File> createProducer() throws Exception {
        // This is just so that we can check for exceptions.
        super.createProducer();
        return new AuditErrorFileProducer(this, new FileOperations(this));
    }

    public String getMessageContext() {
        return messageContext;
    }

    boolean isMessageToBeSaved(String transactionType, String messageContext) {
        return fileDropComponent.isMessageToBeSaved(transactionType, messageContext);
    }
    
}
