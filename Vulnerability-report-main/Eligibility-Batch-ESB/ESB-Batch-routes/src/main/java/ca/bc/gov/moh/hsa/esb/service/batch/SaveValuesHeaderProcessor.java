/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.moh.hsa.esb.service.batch;

import ca.bc.gov.moh.hsa.esb.service.batch.dto.BatchRequestDTO;
import org.apache.camel.Exchange;
import org.apache.camel.Processor;
import org.springframework.stereotype.Component;

/**
 * Store values from the original HL7 request to be used as output parameters
 *
 * @author greg.perkins
 */
@Component
public class SaveValuesHeaderProcessor implements Processor {

    /**
     * Process this exchange by storing input values as headers
     *
     * @param exchange Exchange
     * @throws Exception
     */
    @Override
    public void process(Exchange exchange) throws Exception {
        BatchRequestDTO dto = exchange.getIn().getBody(BatchRequestDTO.class);
        exchange.getIn().setHeader(HeaderConstants.SENDING_ORG, dto.getSender().getOrganization());
        exchange.getIn().setHeader(HeaderConstants.SENDING_ORG_OID, dto.getOrganizationOid());
        exchange.getIn().setHeader(HeaderConstants.SENDING_DEVICE, dto.getSender().getSystemName());
        exchange.getIn().setHeader(HeaderConstants.SENDING_DEVICE_OID, dto.getDeviceOid());
        exchange.getIn().setHeader(HeaderConstants.GET_DEMO_ID, dto.getGetDemoId());
        exchange.getIn().setHeader(HeaderConstants.GET_ELIG_ID, dto.getGetEligId());
        exchange.getIn().setHeader(HeaderConstants.BATCH_ID, dto.gettBatchId());
        exchange.setProperty("ORIGINAL_REQUEST", dto);
    }

}
