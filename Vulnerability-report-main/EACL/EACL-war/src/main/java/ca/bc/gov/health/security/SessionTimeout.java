package ca.bc.gov.health.security;

import jakarta.enterprise.context.RequestScoped;
import jakarta.faces.context.FacesContext;
import jakarta.inject.Inject;
import jakarta.inject.Named;
import java.io.IOException;

@RequestScoped
@Named("SessionTimeout")
public class SessionTimeout {

    @Inject
    private OidcConfig oidcConfig;
        
    public void extendSession() {
        // This method doesn't do anything we just call it extend user sessions 
    }

    public void endSession() throws IOException {
        String keycloakLogoutUrl = oidcConfig.getProviderUri() + "protocol/openid-connect/logout?redirect_uri=" + oidcConfig.getRedirectUri();

        FacesContext.getCurrentInstance()
                .getExternalContext()
                .redirect(keycloakLogoutUrl);
        FacesContext.getCurrentInstance().getExternalContext().invalidateSession();        
    }
}
