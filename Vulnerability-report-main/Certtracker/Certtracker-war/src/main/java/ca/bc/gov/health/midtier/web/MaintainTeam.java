package ca.bc.gov.health.midtier.web;

import ca.bc.gov.health.jsf.BaseBean;
import ca.bc.gov.health.midtier.ejb.entity.*;
import ca.bc.gov.health.midtier.ejb.session.*;
import jakarta.annotation.PostConstruct;
import jakarta.ejb.EJB;
import jakarta.faces.application.FacesMessage;
import jakarta.faces.context.FacesContext;
import jakarta.faces.view.ViewScoped;
import jakarta.inject.Named;
import java.io.Serializable;
import java.util.List;

@Named("MaintainTeam")
@ViewScoped
public class MaintainTeam extends BaseBean implements Serializable {

  @EJB private TeamFacadeLocal teamFacade;

  private List<Team> allTeams;
  private Team team;
  private Object selectedKey;

  public MaintainTeam() {}

  @PostConstruct
  public void init() {
    allTeams = teamFacade.findAll();
    team = new Team();
  }

  public String add() {
    nullify();
    teamFacade.create(team);
    FacesContext.getCurrentInstance()
        .addMessage(
            null, new FacesMessage(FacesMessage.SEVERITY_INFO, "Add Successful", "Add Successful"));
    init();
    ((Droplists) findBean("Droplists")).init();
    return clear();
  }

  public String update() {
    nullify();
    teamFacade.edit(team);
    FacesContext.getCurrentInstance()
        .addMessage(
            null,
            new FacesMessage(FacesMessage.SEVERITY_INFO, "Update Successful", "Update Successful"));
    ((Droplists) findBean("Droplists")).init();
    return clear();
  }

  public String delete() {
    teamFacade.remove(team);
    init();
    ((Droplists) findBean("Droplists")).init();
    return clear();
  }

  public String clear() {
    selectedKey = null;
    team = new Team();
    return null;
  }

  public String select() {
    for (int i = 0; i < allTeams.size(); i++) {
      if (allTeams.get(i).getTeamId().equals(selectedKey)) {
        team = allTeams.get(i);
      }
    }
    return null;
  }

  private void nullify() {}

  public List<Team> getAllTeams() {
    return allTeams;
  }

  public void setAllTeams(List<Team> allTeams) {
    this.allTeams = allTeams;
  }

  public Team getTeam() {
    return team;
  }

  public void setTeam(Team team) {
    this.team = team;
  }

  public Object getSelectedKey() {
    return selectedKey;
  }

  public void setSelectedKey(Object selectedKey) {
    this.selectedKey = selectedKey;
  }
}
