<!--
	Document: EmbeddedDistribution.xhtml
	Created: Tue Jun 30 03:17:00 PDT 2011
	Author: Troy McGinnis-->
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:p="http://primefaces.org/ui"
xmlns:composite="http://java.sun.com/jsf/composite"
template="/templates/template.xhtml">
    <composite:interface>
        <composite:attribute name="list"/>
    </composite:interface>

    <composite:implementation>
        <p:panel id="distributionQueuePanel">
            <f:facet name="header">
                <h:outputText value="Distribution List"/>
            </f:facet>
            
            <!-- LIST OF DISTRIBUTIONS -->
            <p:outputPanel layout="block">
                <h:form>
                    <br/>
                    <p:outputPanel layout="block" id="ajaxDistributionQueuePanel">
                        <p:dataTable emptyMessage="No #{msg['Distribution.desc']}s found" rowIndexVar="index" value="#{DistributionBuffer.distributionQueue}" rows="10" var="row" id="distributionQueueTable" styleClass="stable" sortBy="#{row.monitorId.monitorNm}">

                        <!-- MONITOR ID COLUMN -->
                        <p:column id="monitorCol" sortBy="#{row.monitorId.monitorNm}" sortOrder="asc">
                            <f:facet name="header">
                                <div id="whiteLink">
                                <p:commandLink value="#{msg['Distribution.monitorId.desc']}"
                                                 update="distributionQueueTable"
                                                 action="#{distributionSortingBean.sortByMonitor}"/>
                                </div>
                            </f:facet>
                            <h:outputText value="#{row.monitorId.monitorNm}"/>
                        </p:column>

                        <!-- CONTACT ID COLUMN -->
                        <p:column id="contactCol" sortBy="#{row.contactId.contactId}">
                            <f:facet name="header">
                                <div id="whiteLink">
                                <p:commandLink value="#{msg['Distribution.contactId.desc']}"
                                                 update="distributionQueueTable"
                                                 action="#{distributionSortingBean.sortByContact}"/>
                                </div>
                            </f:facet>
                        <h:outputText value="#{row.contactId.contactId}"/>
                        </p:column>

                        <!-- PRIMARY CONTACT YN COLUMN -->
                        <p:column id="primaryCol" sortBy="#{row.primaryContactYn}">
                            <f:facet name="header">
                                <div id="whiteLink">
                                <p:commandLink value="#{msg['Distribution.primaryContactYn.desc']}"
                                                 update="distributionQueueTable"
                                                 action="#{distributionSortingBean.sortByPrimaryContact}"/>
                                </div>
                            </f:facet>
                        <h:outputText value="#{row.primaryContactYn}"/>
                        </p:column>

                        <!-- TEAM ID COLUMN -->
                        <p:column id="teamCol" sortBy="#{row.teamId.teamNm}">
                            <f:facet name="header">
                                <div id="whiteLink">
                                <p:commandLink value="#{msg['Distribution.teamId.desc']}"
                                                 update="distributionQueueTable"
                                                 action="#{distributionSortingBean.sortByTeam}"/>
                                </div>
                            </f:facet>
                        <h:outputText value="#{row.teamId.teamId}"/>
                        </p:column>
                        
                        </p:dataTable>
                        <br/>
                        <div style="text-align:right">                            
                            <p:commandButton value="Add #{msg['Distribution.desc']}"
                                oncomplete="#{p:resolveFirstComponentWithId('addDistributionQueuePopup', view).clientId}.show();
                                distributionListReset('j_idt152:addDistributionForm:contactMenu', 'j_idt152:addDistributionForm:teamMenu');">
                            </p:commandButton>                                    
                        </div>
                    </p:outputPanel>
                </h:form>
            </p:outputPanel>
            
            <!-- ADD DISTRIBUTION POPUP -->
            <h:form id="addDistributionQueueForm">
                <p:dialog id="addDistributionQueuePopup" modal="true" resizable="true">
                    <f:facet name="header">
                        <h:outputText value="Add #{msg['Distribution.desc']}" />
                    </f:facet>
                    <table class="dataEntry" cellpadding="2" cellspacing="0">
                    <tr>
                    <td class="label"><h:outputText value="#{msg['Distribution.contactId.desc']}"/></td>
                    <td><f:validateBean disabled="true" >
                            <h:selectOneMenu id="contactMenu" style="width:200px;" value="#{DistributionBuffer.distribution.contactId.contactId}" 
                                             onchange='inputCheckDisable("j_idt152:addDistributionForm:contactMenu", "j_idt152:addDistributionForm:teamMenu")' >
                                <f:selectItem itemValue="" itemLabel=""/>
                                <f:selectItems value="#{Droplists.contacts}"/>
                            </h:selectOneMenu>
                        </f:validateBean>
                    </td>
                    <td></td>
                    </tr>
                    <tr>
                    <td class="label"><h:outputText value="#{msg['Distribution.teamId.desc']}"/></td>
                    <td>
                    <f:validateBean disabled="true" >
                        <h:selectOneMenu id="teamMenu" style="width:200px;" value="#{DistributionBuffer.distribution.teamId.teamId}" 
                                         onchange='inputCheckDisable("j_idt152:addDistributionForm:teamMenu", "j_idt152:addDistributionForm:contactMenu"' >
                            <f:selectItem itemValue="" itemLabel=""/>
                            <f:selectItems value="#{Droplists.teams}"/>
                        </h:selectOneMenu>
                    </f:validateBean></td>
                    <td></td>
                    </tr>
                    <tr>
                    <td class="label"><h:outputText value="#{msg['Distribution.primaryContactYn.desc']}"/></td>
                    <td><input id="contactCheck" type="checkbox" checked="#{DistributionBuffer.distribution.primaryContactYn=='Y'?'checked':''}" onclick="if(this.checked){this.nextSibling.value='Y'}else{this.nextSibling.value='N'}"/>
                    <h:inputHidden value="#{DistributionBuffer.distribution.primaryContactYn}"/>
                    </td>
                    <td></td>
                    </tr>
                    <tr><td colspan="3"><br/></td></tr>
                    </table>
                    <div style="text-align:right">
                        <h:commandButton action="#{DistributionBuffer.queueDistribution}" 
                                           value="#{msg['button.add']}">
                        </h:commandButton>

                        <h:commandButton value="#{msg['button.cancel']}" onclick="myDialog.hide();return false;">
                        </h:commandButton>
                    </div>
                </p:dialog>
            </h:form>
            
        </p:panel>
    </composite:implementation>
</ui:composition>