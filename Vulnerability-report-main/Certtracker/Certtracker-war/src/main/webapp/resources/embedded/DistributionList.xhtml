<!--
        Document: EmbeddedDistribution.xhtml
        Created: Tue Jun 30 03:17:00 PDT 2011
        Author: Troy McGinnis-->
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:composite="http://java.sun.com/jsf/composite"
                template="/templates/template.xhtml">
    <composite:interface>
        <composite:attribute name="list"/>
        <composite:attribute name="refresh"/>
    </composite:interface>

    <composite:implementation>
        <p:panel id="distributionListPanel">
            <f:facet name="header">
                <h:outputText value="Distribution List"/>
            </f:facet>

            <!-- LIST OF DISTRIBUTIONS -->
            <h:form id="tableForm">
                <br/>
                <p:outputPanel layout="block" id="ajaxDistributionListPanel">
                    <p:dataTable emptyMessage="No #{msg['Distribution.desc']}s found" rowIndexVar="index" value="#{MaintainMonitor.monitor.distributionList}" rows="10" var="row" id="distributionTable" styleClass="stable" sortBy="#{row.monitorId.monitorNm}" tableStyle="width:auto">

                        <!-- MONITOR ID COLUMN -->
                        <p:column id="monitorCol" sortBy="#{row.monitorId.monitorNm}" sortOrder="asc">
                            <f:facet name="header">
                                <div id="whiteLink">
                                    <p:commandLink value="#{msg['Distribution.monitorId.desc']}"
                                                   update="distributionTable"
                                                   action="#{distributionSortingBean.sortByMonitor}"/>
                                </div>
                            </f:facet>
                            <h:outputText value="#{row.monitorId.monitorNm}"/>
                        </p:column>

                        <!-- CONTACT ID COLUMN -->
                        <p:column id="contactCol" sortBy="#{row.contactId.emailTxt}">
                            <f:facet name="header">
                                <div id="whiteLink">
                                    <p:commandLink value="#{msg['Distribution.contactId.desc']}"
                                                   update="distributionTable"
                                                   action="#{distributionSortingBean.sortByContact}"/>
                                </div>
                            </f:facet>
                            <h:outputText value="#{row.contactId.emailTxt}"/>
                        </p:column>

                        <!-- PRIMARY CONTACT YN COLUMN -->
                        <p:column id="primaryCol" sortBy="#{row.primaryContactYn}">
                            <f:facet name="header">
                                <div id="whiteLink">
                                    <p:commandLink value="#{msg['Distribution.primaryContactYn.desc']}"
                                                   update="distributionTable"
                                                   action="#{distributionSortingBean.sortByPrimaryContact}"/>
                                </div>
                            </f:facet>
                            <h:outputText value="#{row.primaryContactYn}"/>
                        </p:column>

                        <!-- TEAM ID COLUMN -->
                        <p:column id="teamCol" sortBy="#{row.teamId.teamNm}">
                            <f:facet name="header">
                                <div id="whiteLink">
                                    <p:commandLink value="#{msg['Distribution.teamId.desc']}"
                                                   update="distributionTable"
                                                   action="#{distributionSortingBean.sortByTeam}"/>
                                </div>
                            </f:facet>
                            <h:outputText value="#{row.teamId.teamNm}"/>
                        </p:column>

                        <p:column style="text-align: center;">
                            <f:facet name="header"><h:outputText value="View"/></f:facet>
                            <h:commandButton id="selectButton" action="#{MaintainDistribution.select}" value="#{msg['button.select']}" immediate="true">
                                <f:setPropertyActionListener id="selectParam" target="#{flash.selectedDistributionKey}" value="#{row.distributionId}"/></h:commandButton>
                        </p:column>

                    </p:dataTable>


                    <p:outputPanel style="text-align:right">                            
                        <p:commandButton value="Add #{msg['Distribution.desc']}" 
                                         action="#{MaintainDistribution.distributionListSetup}"
                                         oncomplete="PF('distPopo').show(); distributionListReset('j_idt152:addDistributionForm:contactMenu', 'j_idt152:addDistributionForm:teamMenu');" >

                        </p:commandButton>                                    

                    </p:outputPanel>
                </p:outputPanel>
                <!-- ADD DISTRIBUTION POPUP -->
                <p:dialog id="addDistributionPopup" modal="true" resizable="true" widgetVar="distPopo">
                    <f:facet name="header">
                        <h:outputText value="Add #{msg['Distribution.desc']}" />
                    </f:facet>
                    <table class="dataEntry" cellpadding="2" cellspacing="0">
                        <tr>
                            <td class="label"><h:outputText value="#{msg['Distribution.contactId.desc']}"/></td>
                            <td><f:validateBean disabled="true" >
                                    <h:selectOneMenu id="contactMenu" style="width:200px;" value="#{MaintainDistribution.distribution.contactId.contactId}" 
                                                     onchange='inputCheckDisable("j_idt152:tableForm:contactMenu", "j_idt152:tableForm:teamMenu")' >
                                        <f:selectItem itemValue="" itemLabel=""/>
                                        <f:selectItems value="#{Droplists.contacts}"/>
                                    </h:selectOneMenu>
                                </f:validateBean>
                            </td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="label"><h:outputText value="#{msg['Distribution.teamId.desc']}"/></td>
                            <td>
                                <f:validateBean disabled="true" >
                                    <h:selectOneMenu id="teamMenu" style="width:200px;" value="#{MaintainDistribution.distribution.teamId.teamId}" 
                                                     onchange='inputCheckDisable("j_idt152:talbeForm:teamMenu", "j_idt152:tableForm:contactMenu"' >
                                        <f:selectItem itemValue="" itemLabel=""/>
                                        <f:selectItems value="#{Droplists.teams}"/>
                                    </h:selectOneMenu>
                                </f:validateBean></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="label"><h:outputText value="#{msg['Distribution.primaryContactYn.desc']}"/></td>
                            <td><input id="contactCheck" type="checkbox" checked="#{MaintainDistribution.distribution.primaryContactYn=='Y'?'checked':''}" onclick="if (this.checked) {
                                        this.nextSibling.value = 'Y'
                                    } else {
                                        this.nextSibling.value = 'N'
                                    }"/>
                                <h:inputHidden value="#{MaintainDistribution.distribution.primaryContactYn}"/>
                            </td>
                            <td></td>
                        </tr>
                        <tr><td colspan="3"><br/></td></tr>
                    </table>
                    <div style="text-align:right">
                        <p:commandButton action="#{MaintainDistribution.addFromMonitor}" 
                                         value="#{msg['button.add']}"
                                         onclick="#{p:resolveFirstComponentWithId('addDistributionPopup', view).clientId}.hide();
                                    return true;"
                                         update="tableForm:distributionTable addDistributionPopup">
                        </p:commandButton>

                        <h:commandButton value="#{msg['button.cancel']}" onclick="myDialog.hide();
                                return false;">
                        </h:commandButton>
                    </div>
                </p:dialog>
            </h:form>

        </p:panel>
    </composite:implementation>
</ui:composition>