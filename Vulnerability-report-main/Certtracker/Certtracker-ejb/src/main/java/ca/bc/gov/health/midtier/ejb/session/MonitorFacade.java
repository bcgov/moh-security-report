/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.health.midtier.ejb.session;

import ca.bc.gov.health.midtier.ejb.entity.Application;
import ca.bc.gov.health.midtier.ejb.entity.Monitor;
import ca.bc.gov.health.midtier.ejb.entity.SigningAuthority;
import jakarta.ejb.Stateless;
import jakarta.persistence.EntityManager;
import jakarta.persistence.PersistenceContext;

/** @author greg.perkins */
@Stateless
public class MonitorFacade extends AbstractFacade<Monitor> implements MonitorFacadeLocal {
  @PersistenceContext(unitName = "MidTier-ejbPU")
  private EntityManager em;

  protected EntityManager getEntityManager() {
    return em;
  }

  public MonitorFacade() {
    super(Monitor.class);
  }

  @Override
  public Monitor find(Object id) {
    Monitor m = super.find(id);
    // Touch Lazy LOBs
    m.getCertificateTxt();
    m.getRequestTxt();
    return m;
  }

  @Override
  public void edit(Monitor entity) {
    entity.setApplicationId(
        em.find(Application.class, entity.getApplicationId().getApplicationId()));
    entity.setAuthorityId(
        em.find(SigningAuthority.class, entity.getAuthorityId().getAuthorityId()));
    super.edit(entity);
  }
}
