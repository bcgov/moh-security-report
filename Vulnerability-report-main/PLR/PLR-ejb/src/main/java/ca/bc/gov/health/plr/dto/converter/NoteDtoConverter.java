package ca.bc.gov.health.plr.dto.converter;

import ca.bc.gov.health.plr.dto.provider.NoteDto;
import ca.bc.gov.health.plr.ejb.entity.GrsCtBooleanTypes;
import ca.bc.gov.health.plr.ejb.entity.GrsCtEndReasonTypes;
import ca.bc.gov.health.plr.ejb.entity.PrsCtDataOwnerCodes;
import ca.bc.gov.health.plr.ejb.entity.PrsNotes;
import ca.bc.gov.health.plr.ejb.entity.PrsProviders;
import ca.bc.gov.health.plr.ejb.entity.util.DatabaseConstants;
import ca.bc.gov.health.plr.persistence.CodeTableCodes;
import ca.bc.gov.health.plr.persistence.CodesDao;
import javax.ejb.EJB;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

/**
 * Convert a Note DTO into a Note Entity.
 *
 * @author David Sharpe <david.a.sharpe@cgi.com>
 */
@Stateless
public class NoteDtoConverter {

    @PersistenceContext(unitName = "PLR-ejbPU")
    private EntityManager em;
    @EJB
    private CodesDao codesDao;
    @EJB
    DtoConverter dtoConverter;
    public PrsNotes toEntity(NoteDto dto) {
        PrsNotes entity = new PrsNotes();

        if (dto.getPauthId() != null) {
            entity.setPauthPauthId(em.find(PrsProviders.class, dto.getPauthId()));
        }

        
        if (dto.getDataOwnerCode() != null) {
            entity.setDataOwnerCode(codesDao.lookup(PrsCtDataOwnerCodes.class, dto.getDataOwnerCode()));
        }

        if (dto.getIdentifier() != null) {
            entity.setNoteChid(dto.getIdentifier());
        }

        if (dto.getNoteText() != null) {
            entity.setNoteText(dto.getNoteText());
        }

        if (dto.getId() != null) {
            entity.setNotId(dto.getId());
        }
        
        dtoConverter.copyCommonProperties(dto, entity);
        
        return entity;
    }
    
}
