package ca.bc.gov.health.plr.dto.converter;

import ca.bc.gov.health.plr.dto.provider.AbstractProviderDetail;
import ca.bc.gov.health.plr.ejb.entity.EntityCommon;
import ca.bc.gov.health.plr.ejb.entity.GrsCtBooleanTypes;
import ca.bc.gov.health.plr.ejb.entity.GrsCtEndReasonTypes;
import ca.bc.gov.health.plr.ejb.entity.util.DatabaseConstants;
import ca.bc.gov.health.plr.persistence.CodeTableCodes;
import ca.bc.gov.health.plr.persistence.CodesDao;
import javax.ejb.EJB;
import javax.ejb.Stateless;

/**
 *
 * @author David Sharpe <david.a.sharpe@cgi.com>
 */
@Stateless
public class DtoConverter {

    @EJB
    CodesDao codesDao;


    /**
     * Copies properties common to all DTOs and entities.
     *
     * @param dto
     * @param entity
     */
    public void copyCommonProperties(AbstractProviderDetail dto, EntityCommon entity) {

        if (dto.isActive()) {
            entity.setActiveFlag(codesDao.lookup(GrsCtBooleanTypes.class, CodeTableCodes.GrsCtBooleanTypes.YES));
        } else {
            entity.setActiveFlag(codesDao.lookup(GrsCtBooleanTypes.class, CodeTableCodes.GrsCtBooleanTypes.NO));
        }

        if (dto.getEffectiveStartDate() != null) {
            entity.setEffectiveStartDate(dto.getEffectiveStartDate());
        }

        if (dto.getEffectiveEndDate() != null) {
            entity.setEffectiveEndDate(dto.getEffectiveEndDate());
        } else {
            entity.setEffectiveEndDate(DatabaseConstants.SYSTEM_HIGH_DATE.toDate());
        }

        if (dto.getGenerationNum() != null) {
            entity.setGenerationNum(dto.getGenerationNum());
        }

        if (dto.getInvalidatedDate() != null) {
            entity.setInvalidatedDts(dto.getInvalidatedDate());
        }

        if (dto.getUserChid() != null) {
            entity.setUserChid(dto.getUserChid());
        }

        if (dto.getCreatedDate() != null) {
            entity.setCreatedDts(dto.getCreatedDate());
        }

        if (dto.getEndReasonCode() != null) {
            entity.setEndReasonCode(codesDao.lookup(GrsCtEndReasonTypes.class, dto.getEndReasonCode()));
        } else if (dto.getEndReasonCodeId() != null) {
            entity.setEndReasonCode(codesDao.lookup(GrsCtEndReasonTypes.class, dto.getEndReasonCodeId()));
        }
    }

}
