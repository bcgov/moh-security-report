/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.health.plr.util;

import java.math.BigDecimal;
import java.math.RoundingMode;

/**
 *
 * @author jonathan.wiebe
 */
public class Stats {
    private long samples = 0;
    private BigDecimal mean = new BigDecimal(0.0);
    private BigDecimal meansqd = new BigDecimal(0.0);
    private BigDecimal max = new BigDecimal(Double.MIN_VALUE);
    private BigDecimal min = new BigDecimal(Double.MAX_VALUE);
    private BigDecimal var = new BigDecimal(0.0);
    
    public Stats() {
    }
    public void add(BigDecimal value) {
        samples++;
        max = max.max(value);
        min = min.min(value);
        if(samples == 1) {
            mean = value;
            meansqd = value.multiply(value);
        } else {
            mean = mean.multiply(new BigDecimal(samples-1)).add(value).divide(new BigDecimal(samples),5, RoundingMode.HALF_UP);
            meansqd = meansqd.multiply(new BigDecimal(samples-1)).add(value.multiply(value)).divide(new BigDecimal(samples),5, RoundingMode.HALF_UP);
            var = meansqd.subtract(mean.multiply(mean));
        }
        
    }
    public long getSamples() {
        return samples;
    }
    
    public void add(double value) {
        add(new BigDecimal(value));
    }
    public void add(long value) {
        add(new BigDecimal(value));
    }
    
    public BigDecimal getMean() {
        return mean;
    }
    public Double getStd() {
        return Math.sqrt(var.doubleValue());
    }
    public BigDecimal getMax() {
        return max;
    }
    public BigDecimal getMin() {
        return min;
    }
    
    public static void main(String[] s) {
        Stats ss = new Stats();
        ss.add(1l);
        ss.add(2l);
        ss.add(3l);
        ss.add(4l);
        ss.add(4.4);
        ss.add(-4.4);
        System.out.println(ss.getMean());
        System.out.println(ss.getStd());
        System.out.println(ss.getMin());
        System.out.println(ss.getMax());
    }
}
