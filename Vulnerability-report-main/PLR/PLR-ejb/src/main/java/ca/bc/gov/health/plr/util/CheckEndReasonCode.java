/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.health.plr.util;

import ca.bc.gov.health.plr.ejb.entity.GrsCtEndReasonTypes;
import ca.bc.gov.health.plr.persistence.CodeTableCodes;
import ca.bc.gov.health.plr.persistence.CodesDao;
import javax.ejb.Singleton;
import javax.inject.Inject;

/**
 * I got tired of checking for ceased records.  This makes it easy.
 * 
 * @author Jonathan.Wiebe
 */
@Singleton
public class CheckEndReasonCode {
    @Inject
    private CodesDao codesDao;
    
    public boolean isCeased(Object obj) {
        String code = (String)ReflectionUtils.methodInvoke(obj, "getEndReasonCode");
        Long id = (Long)ReflectionUtils.methodInvoke(obj, "getEndReasonCodeId");
        GrsCtEndReasonTypes ceaseCt = codesDao.lookup(GrsCtEndReasonTypes.class, CodeTableCodes.GrsCtEndReasonTypes.CEASE);
        if(ceaseCt != null && (ceaseCt.getCtlId().equals(id) || ceaseCt.getCtlNameCode().equals(code))) {
            return true;
        } else {
            return false;
        }
    }
    public boolean isCorrected(Object obj) {
        String code = (String)ReflectionUtils.methodInvoke(obj, "getEndReasonCode");
        Long id = (Long)ReflectionUtils.methodInvoke(obj, "getEndReasonCodeId");
        GrsCtEndReasonTypes ceaseCt = codesDao.lookup(GrsCtEndReasonTypes.class, CodeTableCodes.GrsCtEndReasonTypes.CORRECT);
        if(ceaseCt != null && (ceaseCt.getCtlId().equals(id) || ceaseCt.getCtlNameCode().equals(code))) {
            return true;
        } else {
            return false;
        }
    }
    public boolean isChange(Object obj) {
        String code = (String)ReflectionUtils.methodInvoke(obj, "getEndReasonCode");
        Long id = (Long)ReflectionUtils.methodInvoke(obj, "getEndReasonCodeId");
        GrsCtEndReasonTypes ceaseCt = codesDao.lookup(GrsCtEndReasonTypes.class, CodeTableCodes.GrsCtEndReasonTypes.CHANGE);
        if(ceaseCt != null && (ceaseCt.getCtlId().equals(id) || ceaseCt.getCtlNameCode().equals(code))) {
            return true;
        } else {
            return false;
        }
    }
}
