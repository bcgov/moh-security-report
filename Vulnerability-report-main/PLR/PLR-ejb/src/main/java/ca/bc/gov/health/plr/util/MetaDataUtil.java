/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.health.plr.util;

import ca.bc.gov.health.plr.dto.provider.AddressDto;
import ca.bc.gov.health.plr.dto.provider.CollegeIdentifierDto;
import ca.bc.gov.health.plr.dto.provider.ConditionsDto;
import ca.bc.gov.health.plr.dto.provider.ConfidentialityIndicatorDto;
import ca.bc.gov.health.plr.dto.provider.CredentialsDto;
import ca.bc.gov.health.plr.dto.provider.DemographicDetailsDto;
import ca.bc.gov.health.plr.dto.provider.DisciplinaryActionDto;
import ca.bc.gov.health.plr.dto.provider.ElectronicAddressDto;
import ca.bc.gov.health.plr.dto.provider.ExpertiseDto;
import ca.bc.gov.health.plr.dto.provider.InformationRouteDto;
import ca.bc.gov.health.plr.dto.provider.NoteDto;
import ca.bc.gov.health.plr.dto.provider.OrgNameDto;
import ca.bc.gov.health.plr.dto.provider.PersonNameDto;
import ca.bc.gov.health.plr.dto.provider.ProviderRelationshipDto;
import ca.bc.gov.health.plr.dto.provider.RegistryIdentifierDto;
import ca.bc.gov.health.plr.dto.provider.RegistryUserRelationshipDto;
import ca.bc.gov.health.plr.dto.provider.StatusDto;
import ca.bc.gov.health.plr.dto.provider.TelecommunicationDto;
import ca.bc.gov.health.plr.dto.provider.WorkLocationDetailsDto;
import ca.bc.gov.health.plr.ejb.entity.GrsCtTransactionTypes;
import ca.bc.gov.health.plr.ejb.session.GrsCtTransactionTypesFacade;
import ca.bc.gov.health.plr.persistence.CodeTableCodes;
import ca.bc.gov.health.plr.persistence.CodesDao;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.util.logging.Logger;
import javax.ejb.EJB;
import javax.ejb.Stateless;

/**
 *
 * @author adebiyi.kuseju
 */
@Stateless
public class MetaDataUtil {
    
    private static final Logger logger = Logger.getLogger(MetaDataUtil.class.getName());
    
    @EJB
    protected CodesDao codesDao;
    
    @EJB
    private GrsCtTransactionTypesFacade grsCtTransactionTypesFacade;
    
    public GrsCtTransactionTypes getTransactionType(Object dto, boolean forceCreate) throws NoSuchMethodException, IllegalArgumentException, IllegalAccessException, InvocationTargetException {
        GrsCtTransactionTypes grsCtTransactionTypes = null;

        if (dto instanceof AddressDto) {
            
            if (((AddressDto) dto).getPauthId() == null && ((AddressDto) dto).getWlWlId() == null
                    || ((AddressDto) dto).getPauthId() != null && ((AddressDto) dto).getWlWlId() == null) {
                grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_ADDRESS) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_ADDRESS);
            } else {
                grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_WORK_LOCATION_ADDRESS) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_WORK_LOCATION_ADDRESS);
            }

        } else if (dto instanceof ConditionsDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_CONDITION) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_CONDITION);

        } else if (dto instanceof ConfidentialityIndicatorDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_CONFIDENTIALITY) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_CONFIDENTIALITY);

        } else if (dto instanceof CredentialsDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_CREDENTIAL) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_CREDENTIAL);

        } else if (dto instanceof DemographicDetailsDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_DEMOGRAPHIC) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_DEMOGRAPHIC_);

        } else if (dto instanceof DisciplinaryActionDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_DISCIPLINARY_ACTION) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_DISCIPLINARY_ACTION);

        } else if (dto instanceof ElectronicAddressDto) {
                        
            if (((ElectronicAddressDto) dto).getPauthId() == null && ((ElectronicAddressDto) dto).getWlWlId() == null
                    || ((ElectronicAddressDto) dto).getPauthId() != null && ((ElectronicAddressDto) dto).getWlWlId() == null) {
                grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_E_ADDRESS) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_E_ADDRESS);
            } else {
                grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_WORK_LOCATION_E_ADDRESS) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_WORK_LOCATION_E_ADDRESS);
            }

        } else if (dto instanceof ExpertiseDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_EXPERTISE) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_EXPERTISE);

        } else if (dto instanceof InformationRouteDto) {
                        
            if (((InformationRouteDto) dto).getPauthId() == null && ((InformationRouteDto) dto).getWlWlId() == null
                    || ((InformationRouteDto) dto).getPauthId() != null && ((InformationRouteDto) dto).getWlWlId() == null) {
                grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_INFORMATION_ROUTE) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_INFORMATION_ROUTE);
            } else {
                grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_WORK_LOCATION_INFORMATION_ROUTE) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_WORK_LOCATION_INFORMATION_ROUTE);
            }

        } else if (dto instanceof NoteDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_NOTE) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_NOTE);

        } else if (dto instanceof OrgNameDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_ORGANIZATION_NAME) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_ORGANIZATION_NAME);

        } else if (dto instanceof PersonNameDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_PERSONAL_NAME) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_PERSONAL_NAME);

        } else if (dto instanceof CollegeIdentifierDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_IDENTIFIER) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_IDENTIFIER);

        } else if (dto instanceof ProviderRelationshipDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_RELATIONSHIP) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_RELATIONSHIP);

        } else if (dto instanceof RegistryIdentifierDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_REGISTRY_IDENTIFIER) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_REGISTRY_IDENTIFIER);

        } else if (dto instanceof RegistryUserRelationshipDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_REGISTRY_USER_RELATIONSHIP) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_REGISTRY_USER_RELATIONSHIP);

        } else if (dto instanceof StatusDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_STATUS) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_STATUS);

        } else if (dto instanceof TelecommunicationDto) {
            
            if (((TelecommunicationDto) dto).getPauthId() == null && ((TelecommunicationDto) dto).getWlWlId() == null
                    || ((TelecommunicationDto) dto).getPauthId() != null && ((TelecommunicationDto) dto).getWlWlId() == null) {
                grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_TELEPHONE) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_TELEPHONE);
            } else {
                grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_WORK_LOCATION_TELEPHONE) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_WORK_LOCATION_TELEPHONE);
            }
            
        } else if (dto instanceof WorkLocationDetailsDto) {
            grsCtTransactionTypes = (isNew(dto) || forceCreate) ? getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.CREATE_WORK_LOCATION_DETAIL) : getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes.UPDATE_WORK_LOCATION_DETAIL);

        }

        return grsCtTransactionTypes;
    }
    
    public boolean isNew(Object dto) throws NoSuchMethodException, IllegalAccessException, IllegalArgumentException, InvocationTargetException {
        Method getId = dto.getClass().getMethod("getId");
        return getId.invoke(dto) == null;
    }
    
    public GrsCtTransactionTypes getSpecificTransactionType(CodeTableCodes.GrsCtTransactionTypes txType) {
        return grsCtTransactionTypesFacade.findByType(txType);
    }
    

    
}
