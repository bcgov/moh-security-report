package ca.bc.gov.health.plr.rule.provider;

import java.util.regex.Pattern;
import javax.validation.ConstraintValidator;
import javax.validation.ConstraintValidatorContext;

/**
 * Base64 field validator for EA REQ-00320.
 * 
 * (Note that no Base64 fields exist in the application at the time of this writing, 31Dec14,
 * so this validator is not used outside of its test cases. We decided to implement it now because 
 * there is a requirement that will require it: PDF uploads of disciplinary notes. If you are reading
 * this and the application is in maintenance phase, you should probably delete this feature.)
 *
 * @author David Sharpe <david.a.sharpe@cgi.com>
 */
public class AcceptableBase64Validator implements ConstraintValidator<AcceptableBase64, String> {

    private static final Pattern illegalCharacters = Pattern.compile("[^+/0-9A-Za-z]");

    @Override
    public void initialize(AcceptableBase64 constraintAnnotation) {
    }

    @Override
    public boolean isValid(String value, ConstraintValidatorContext context) {
        AcceptableCharacterValidator validator = new AcceptableCharacterValidator(illegalCharacters);
        return validator.valildate(value, context);
    }

}
