/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.health.plr.producer;

import ca.bc.gov.health.login.PLRHealthNetServerAuthenticationModule;
import ca.bc.gov.health.login.UserPrincipal;
import ca.bc.gov.health.plr.producer.type.Authenticated;
import javax.enterprise.inject.Produces;
import javax.faces.context.FacesContext;

/**
 * A CDI producer (facade) responsible injecting an instance 
 * of ca.bc.gov.health.login.UserPrincipal that contains relevant 
 * information about the currently logged in user
 *
 * @author Adebiyi.Kuseju
 */
public class UserPrincipalProducer {

    @Produces
    @Authenticated
    public UserPrincipal createUserPrincipal() {
        UserPrincipal up = null;
        FacesContext facesCtx = FacesContext.getCurrentInstance();

        if (facesCtx != null) {
            up =  (UserPrincipal) facesCtx.getExternalContext().getSessionMap().get(PLRHealthNetServerAuthenticationModule.USER_SESSION_KEY);

        }
        
        return up;
    }
}
