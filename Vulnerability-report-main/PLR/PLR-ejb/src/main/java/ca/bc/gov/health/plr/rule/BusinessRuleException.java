/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.health.plr.rule;

import java.util.ArrayList;
import java.util.List;

/**
 * Exception class indicating one or more business rules have failed
 *
 * @author greg.perkins
 */
public class BusinessRuleException extends Exception {

    private static final long serialVersionUID = 1L;

    private List<BusinessRuleResult> results = new ArrayList<BusinessRuleResult>();

    public BusinessRuleException(final BusinessRuleResult result) {
        super(concatenateResults(new ArrayList<BusinessRuleResult>() {
            {
                add(result);
            }
        }));
        results.add(result);
    }

    public BusinessRuleException(List<BusinessRuleResult> results) {
        super(concatenateResults(results));
        this.results.addAll(results);
    }

    public static String concatenateMessages(List<BusinessRuleMessage> messages) {
        StringBuilder buff = new StringBuilder();
        for (BusinessRuleMessage msg : messages) {
            buff.append(msg.getMessageCode() + ": " + msg.getMessage());
            buff.append("\n");
        }
        return buff.toString();
    }

    public static String concatenateResults(List<BusinessRuleResult> results) {
        StringBuilder buff = new StringBuilder();
        for (BusinessRuleResult result : results) {
            buff.append(concatenateMessages(result.getMessages()));
        }
        return buff.toString();
    }
    

    public List<BusinessRuleResult> getResults() {
        return results;
    }

    public void setResults(List<BusinessRuleResult> results) {
        this.results = results;
    }
    
}
