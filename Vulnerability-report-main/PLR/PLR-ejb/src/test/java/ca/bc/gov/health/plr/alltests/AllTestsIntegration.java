/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.health.plr.alltests;

import ca.bc.gov.health.plr.dto.converter.AddressDtoConverterTest;
import ca.bc.gov.health.plr.dto.converter.ConditionDtoConverterTest;
import ca.bc.gov.health.plr.dto.converter.DisciplinaryActionDtoConverterTest;
import ca.bc.gov.health.plr.dto.converter.ElectronicAddressDtoConverterTest;
import ca.bc.gov.health.plr.dto.converter.PersonNameDtoConverterTest;
import ca.bc.gov.health.plr.dto.converter.ProviderDtoConverterTest;
import ca.bc.gov.health.plr.dto.converter.ProviderIdentifierDtoConverterTest;
import ca.bc.gov.health.plr.dto.converter.RegistryUserDtoConverterTest;
import ca.bc.gov.health.plr.dto.converter.StatusDtoConverterTest;
import ca.bc.gov.health.plr.dto.converter.TelephoneDtoConverterTest;
import ca.bc.gov.health.plr.dto.converter.WorkLocationDetailsDtoConverterTest;
import ca.bc.gov.health.plr.dto.converter.WorkLocationDtoConverterTest;
import ca.bc.gov.health.plr.dto.dps.DataPermissionsConverterTest;
import ca.bc.gov.health.plr.dto.provider.PersonNameDtoLastFirstNameComparatorTest;
import ca.bc.gov.health.plr.dto.provider.PersonNameDtoTest;
import ca.bc.gov.health.plr.dto.provider.ProviderDtoLastFirstNameComparatorTest;
import ca.bc.gov.health.plr.dto.reguser.AccessProfileDtoConverterTest;
import ca.bc.gov.health.plr.dto.reguser.DistributionDtoConverterTest;
import ca.bc.gov.health.plr.ejb.entity.util.DatabaseConstants;
import ca.bc.gov.health.plr.ejb.entity.util.EntityUtilsTest;
import ca.bc.gov.health.plr.persistence.BusinessRuleMessageDaoTest;
import ca.bc.gov.health.plr.persistence.CodesDaoTest;
import ca.bc.gov.health.plr.persistence.TestConstants;
import ca.bc.gov.health.plr.remote.BatchTransactionStatusServiceTest;
import ca.bc.gov.health.plr.remote.LocalDtoConverterTest;
import ca.bc.gov.health.plr.remote.MaintainProviderEsbProcessorNoIntSetupTest;
import ca.bc.gov.health.plr.remote.MaintainProviderEsbServiceOrgWorkLocValidationTest;
import ca.bc.gov.health.plr.remote.MaintainProviderEsbServiceValidationTest;
import ca.bc.gov.health.plr.remote.MaintainProviderEsbService_AddProviderTest;
import ca.bc.gov.health.plr.remote.MaintainProviderEsbService_Orgs_Test;
import ca.bc.gov.health.plr.remote.MaintainProviderServiceAuditingTest;
import ca.bc.gov.health.plr.rule.provider.AcceptableCodeIdValidatorTest;
import ca.bc.gov.health.plr.rule.provider.AcceptableCodeNameValidatorTest;
import ca.bc.gov.health.plr.rule.provider.AddressCrossFieldValidatorTest;
import ca.bc.gov.health.plr.rule.provider.ProviderConfidentialityTest;
import ca.bc.gov.health.plr.rule.provider.ValidateEmailAddressTest;
import ca.bc.gov.health.plr.rule.provider.ValidateGenderTest;
import ca.bc.gov.health.plr.rule.provider.search.ValidateSearchProviderTypePermissionTest;
import ca.bc.gov.health.plr.service.EmailServiceTest;
import ca.bc.gov.health.plr.service.PLRConfigurationResourceLoaderTest;
import ca.bc.gov.health.plr.service.audit.ProviderChangeEventConsumerTest;
import ca.bc.gov.health.plr.service.auditing.AuditingServiceTest;
import ca.bc.gov.health.plr.service.dps.DpsServiceTest;
import ca.bc.gov.health.plr.service.dps.DpsUniqueValidatorTest;
import ca.bc.gov.health.plr.service.provider.AddProviderLinkageTest;
import ca.bc.gov.health.plr.service.provider.AddProviderServiceNegativeTest;
import ca.bc.gov.health.plr.service.provider.AddProviderServicePostiveTest;
import ca.bc.gov.health.plr.service.provider.AddressSupportServiceTest;
import ca.bc.gov.health.plr.service.provider.CeasingRuleHelperTest;
import ca.bc.gov.health.plr.service.provider.JournalServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainAddressServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainConditionServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainConfidentialityServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainCredentialsServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainDemographicDetailsServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainDisciplinaryActionServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainElectronicAddressServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainExpertiseServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainInformationRouteServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainNoteServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainOrgNameServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainPersonNameServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainProviderIdentifierServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainProviderRelationshipServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainProviderServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainRegistryIdentifierServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainRegistryUserRelationshipServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainStatusServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainTelephoneServiceTest;
import ca.bc.gov.health.plr.service.provider.MaintainWorkLocationServiceTest;
import ca.bc.gov.health.plr.service.provider.ProviderAuthorizationServiceTest;
import ca.bc.gov.health.plr.service.provider.SearchProviderServiceTest;
import ca.bc.gov.health.plr.service.provider.security.AccessRestrictionServiceTest;
import ca.bc.gov.health.plr.service.registry.user.MaintainAccessProfileServiceTest;
import ca.bc.gov.health.plr.service.registry.user.MaintainDistributionServiceTest;
import ca.bc.gov.health.plr.service.registry.user.MaintainPartyServiceTest;
import ca.bc.gov.health.plr.service.registry.user.RegistryUserServiceTest;
import ca.bc.gov.health.plr.service.validators.EffectiveDatesValidatorTest;
import ca.bc.gov.health.plr.service.validators.UserChidGeneratorTest;
import ca.bc.gov.health.plr.util.CheckEndReasonCodeTest;
import ca.bc.gov.health.plr.util.CreateProviderUtils;
import ca.bc.gov.health.plr.util.ReflectionUtilsTest;
import ca.bc.gov.health.plr.util.TestConfig;
import java.io.File;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;
import java.util.Properties;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.ejb.embeddable.EJBContainer;
import org.junit.ClassRule;
import org.junit.rules.ExternalResource;
import org.junit.runner.RunWith;
import org.junit.runners.Suite;
 
@RunWith(Suite.class)
@Suite.SuiteClasses({
    ValidateEmailAddressTest.class,

    // The order of the following tests seems to be really important.
    // Leave the class list in this order.
    
    ca.bc.gov.health.plr.remote.MaintainProviderEsbServiceTest.class,
    ca.bc.gov.health.plr.service.remote.MaintainProviderEsbServiceTest.class,
    MaintainProviderEsbService_AddProviderTest.class,
    ca.bc.gov.health.plr.remote.MaintainProviderEsbProcessorTest.class,
    ca.bc.gov.health.plr.service.remote.MaintainProviderEsbProcessorTest.class,
    ca.bc.gov.health.plr.remote.SearchProviderEsbServiceTest.class,
    ca.bc.gov.health.plr.service.remote.SearchProviderEsbServiceTest.class,

    UserChidGeneratorTest.class,
    RegistryUserServiceTest.class,
    MaintainPartyServiceTest.class,
    MaintainAccessProfileServiceTest.class,
    MaintainDistributionServiceTest.class,
    AccessRestrictionServiceTest.class,
    SearchProviderServiceTest.class,
    ProviderAuthorizationServiceTest.class,
    MaintainDemographicDetailsServiceTest.class,
    MaintainDisciplinaryActionServiceTest.class,
    MaintainElectronicAddressServiceTest.class,
    MaintainInformationRouteServiceTest.class,
    MaintainNoteServiceTest.class,
    MaintainPersonNameServiceTest.class,
    MaintainProviderRelationshipServiceTest.class,
    MaintainRegistryIdentifierServiceTest.class,
    MaintainStatusServiceTest.class,
    MaintainTelephoneServiceTest.class,
    MaintainWorkLocationServiceTest.class,
    MaintainRegistryUserRelationshipServiceTest.class,
    MaintainProviderServiceTest.class,
    MaintainProviderIdentifierServiceTest.class,
    MaintainAddressServiceTest.class,
    MaintainConditionServiceTest.class,
    MaintainProviderEsbServiceValidationTest.class,
    MaintainOrgNameServiceTest.class,
    MaintainExpertiseServiceTest.class,
    MaintainCredentialsServiceTest.class,
    MaintainConfidentialityServiceTest.class,
    JournalServiceTest.class,
    CeasingRuleHelperTest.class,
    AddressSupportServiceTest.class,
    AddProviderServicePostiveTest.class,
    AddProviderServiceNegativeTest.class,
    DpsServiceTest.class,
    DpsUniqueValidatorTest.class,
    AuditingServiceTest.class,
    ProviderChangeEventConsumerTest.class, 
    PLRConfigurationResourceLoaderTest.class,
    EmailServiceTest.class,
    ValidateSearchProviderTypePermissionTest.class,
    ValidateGenderTest.class,
    ProviderConfidentialityTest.class,
    AddressCrossFieldValidatorTest.class,
    AcceptableCodeIdValidatorTest.class,
    AcceptableCodeNameValidatorTest.class,
    MaintainProviderServiceAuditingTest.class,
    MaintainProviderEsbProcessorNoIntSetupTest.class,

    MaintainProviderEsbService_Orgs_Test.class,
    MaintainProviderEsbServiceOrgWorkLocValidationTest.class,
    LocalDtoConverterTest.class,
    BatchTransactionStatusServiceTest.class,
    CodesDaoTest.class,
    BusinessRuleMessageDaoTest.class,
    EntityUtilsTest.class,
    AccessProfileDtoConverterTest.class,
    DistributionDtoConverterTest.class,
    PersonNameDtoConverterTest.class,
    PersonNameDtoTest.class,
    PersonNameDtoLastFirstNameComparatorTest.class,
    ProviderDtoLastFirstNameComparatorTest.class,
    DataPermissionsConverterTest.class,
    ElectronicAddressDtoConverterTest.class,
    ProviderIdentifierDtoConverterTest.class,
    ProviderDtoConverterTest.class,
    TelephoneDtoConverterTest.class,
    WorkLocationDetailsDtoConverterTest.class,
    WorkLocationDtoConverterTest.class,
    AddressDtoConverterTest.class,
    ConditionDtoConverterTest.class,
    DisciplinaryActionDtoConverterTest.class,
    RegistryUserDtoConverterTest.class,
    EffectiveDatesValidatorTest.class,
    StatusDtoConverterTest.class,
    ReflectionUtilsTest.class,
    AddProviderLinkageTest.class
})

public class AllTestsIntegration {
    
    private static final String CLASSNAME = AllTestsUnit.class.getSimpleName();
    private static final Logger LOG = Logger.getLogger(CLASSNAME);
    
    //GF configs 
    private static final String GF_EJB_EMBEDDED_PROPERTY_START = "org.glassfish.ejb.embedded.";
    private static final String GF_INSTALLATION_ROOT = GF_EJB_EMBEDDED_PROPERTY_START + "glassfish.installation.root";
    private static final String GF_INSTANCE_ROOT = GF_EJB_EMBEDDED_PROPERTY_START + "glassfish.instance.root";

    public static EJBContainer container;
    
    @ClassRule
    public static ExternalResource resource = new ExternalResource() {
        @Override
        protected void before() throws IOException {
            Properties props = TestConfig.getTestConfig();

            Map<Object, Object> properties = new HashMap<>();
            properties.put(EJBContainer.APP_NAME, DatabaseConstants.PERSISTENCE_CONTEXT_UNIT_NAME);
            properties.put(EJBContainer.MODULES, new File[] {
                new File(props.getProperty(TestConstants.PLR_EJB_CODE_BASE)),
                new File(props.getProperty(TestConstants.PLR_EJB_TEST_CODE_BASE))});
          
//            properties.put(GF_INSTANCE_ROOT, "C:\\Servers\\payara-5.2020.3\\payara5\\glassfish\\domains\\domain1"); //${com.sun.aas.instanceRoot}
//            properties.put(GF_INSTALLATION_ROOT, "C:\\Servers\\payara-5.2020.3\\payara5\\glassfish"); //${com.sun.aas.installRoot}

            properties.put(GF_INSTANCE_ROOT, "C:\\apps\\4-Tools\\payara-IntegrTest_5.2020.4\\payara5\\glassfish\\domains\\domain1"); //${com.sun.aas.instanceRoot}
            properties.put(GF_INSTALLATION_ROOT, "C:\\apps\\4-Tools\\payara-IntegrTest_5.2020.4\\payara5\\glassfish"); //${com.sun.aas.installRoot}
              
            LOG.log(Level.INFO, "AllTestsIntegration looking up EJB payara container...");
            
            container = javax.ejb.embeddable.EJBContainer.createEJBContainer(properties);

        }

        @Override
        protected void after() {
            container.close();
        }
    };
}

