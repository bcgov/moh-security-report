package ca.bc.gov.health.plr.dto.reguser;

import ca.bc.gov.health.plr.ejb.entity.GrsAccessProfiles;
import ca.bc.gov.health.plr.ejb.entity.GrsDistributionProfiles;
import ca.bc.gov.health.plr.ejb.entity.util.DatabaseConstants;
import ca.bc.gov.health.plr.service.provider.IntegrationSetup;
import java.util.Calendar;
import java.util.Date;
import org.junit.After;
import org.junit.AfterClass;
import static org.junit.Assert.*;
import org.junit.Before;
import org.junit.BeforeClass;
import org.junit.Test;

/**
 *
 * @author sumesh.kariyil
 */
public class DistributionDtoConverterTest extends IntegrationSetup {

    public DistributionDtoConverterTest() {
    }

    @BeforeClass
    public static void setUpClass() {
    }

    @AfterClass
    public static void tearDownClass() {
    }

    @Before
    public void setUp() {
    }

    @After
    public void tearDown() {
    }

    /**
     * Test of toEntity method
     */
    @Test
    public void testToEntity_AddressType() throws Exception {
        DistributionDto dto = populateDTO();

        GrsDistributionProfiles result = distributionDtoConverter.toEntity(dto);
        assertNotNull(result.getRuRuId());
    }
    
    @Test
    public void testToEntity_defaultEffectiveEndDate() throws Exception {
        DistributionDto dto = populateDTO();
        GrsDistributionProfiles result = distributionDtoConverter.toEntity(dto);
        assertNotNull(result.getEffectiveEndDate());
        assertEquals(DatabaseConstants.SYSTEM_HIGH_DATE.toDate(), result.getEffectiveEndDate());
    }
    
    @Test
    public void testToEntity_effectiveEndDate() throws Exception {
        DistributionDto dto = populateDTO();

        
        Date currDate= new Date();
        dto.setEffectiveEndDate(currDate);

        GrsDistributionProfiles result = distributionDtoConverter.toEntity(dto);
        assertNotSame(result.getEffectiveEndDate(), DatabaseConstants.SYSTEM_HIGH_DATE.toDate());        
        assertEquals(result.getEffectiveEndDate(), currDate);        
    }

    private DistributionDto populateDTO() {
        DistributionDto dto = new DistributionDto();
        dto.setRuRuId(1l);
        
        return dto;
    }
}
