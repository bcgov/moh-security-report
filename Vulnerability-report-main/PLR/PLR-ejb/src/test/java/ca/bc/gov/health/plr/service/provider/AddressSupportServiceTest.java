package ca.bc.gov.health.plr.service.provider;

import ca.bc.gov.health.plr.ejb.entity.GrsAddresses;
import ca.bc.gov.health.plr.soap.addressdoctor.generated.Address;
import static org.junit.Assert.assertEquals;
import org.junit.Test;

/**
 *
 * @author tim.osse
 */
public class AddressSupportServiceTest {

    @Test
    public void testFixPostalCodeSpacing() throws Exception {

        AddressSupportService mockSupport = new AddressSupportService();
        Address address = new Address();
        String correctFormatPC = "V8W 2E1";

        //Test correction path
        GrsAddresses criteria = new GrsAddresses();
        criteria.setAddressLine1Txt("1175 Douglas Street");
        criteria.setAddressLine2Txt("");
        criteria.setAddressLine3Txt("");
        criteria.setCityTxt("Victoria");
        criteria.setProvinceOrStateTxt("BC");
        criteria.setPostalCodeOrZipTxt("V8W2E1");

        mockSupport.fixPostalCodeSpacing(criteria, address);
        assertEquals(correctFormatPC, address.getPostalCode().getString().get(0));

        //Format already correct test
        criteria.setAddressLine1Txt("1175 Douglas Street");
        criteria.setAddressLine2Txt("");
        criteria.setAddressLine3Txt("");
        criteria.setCityTxt("Victoria");
        criteria.setProvinceOrStateTxt("BC");
        criteria.setPostalCodeOrZipTxt(correctFormatPC);

        mockSupport.fixPostalCodeSpacing(criteria, address);
        assertEquals(correctFormatPC, address.getPostalCode().getString().get(0));
    }

    @Test
    public void testFixPostalCodeSpacing_LessThan6() throws Exception {

        AddressSupportService mockSupport = new AddressSupportService();
        Address address = new Address();

        //Test correction path
        GrsAddresses criteria = new GrsAddresses();
        criteria.setAddressLine1Txt("1175 Douglas Street");
        criteria.setAddressLine2Txt("");
        criteria.setAddressLine3Txt("");
        criteria.setCityTxt("Victoria");
        criteria.setProvinceOrStateTxt("BC");
        criteria.setPostalCodeOrZipTxt("V8W2E");

        mockSupport.fixPostalCodeSpacing(criteria, address);
        assertEquals("V8W2E", address.getPostalCode().getString().get(0));
    }

    @Test
    public void testFixPostalCodeSpacing_MoreThan6() throws Exception {

        AddressSupportService mockSupport = new AddressSupportService();
        Address address = new Address();

        //Test correction path
        GrsAddresses criteria = new GrsAddresses();
        criteria.setAddressLine1Txt("1175 Douglas Street");
        criteria.setAddressLine2Txt("");
        criteria.setAddressLine3Txt("");
        criteria.setCityTxt("Victoria");
        criteria.setProvinceOrStateTxt("BC");
        criteria.setPostalCodeOrZipTxt("V8W2EER");

        mockSupport.fixPostalCodeSpacing(criteria, address);
        assertEquals("V8W2EER", address.getPostalCode().getString().get(0));
    }

}
