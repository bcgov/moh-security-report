package ca.bc.gov.health.plr.dto.converter;

import ca.bc.gov.health.plr.dto.provider.DisciplinaryActionDto;
import ca.bc.gov.health.plr.ejb.entity.PrsDisciplinaryActions;
import ca.bc.gov.health.plr.ejb.entity.util.DatabaseConstants;
import ca.bc.gov.health.plr.service.provider.IntegrationSetup;
import static ca.bc.gov.health.plr.service.provider.IntegrationSetup.disciplinaryActionConverter;
import java.util.Calendar;
import java.util.Date;
import org.junit.After;
import org.junit.AfterClass;
import static org.junit.Assert.assertEquals;
import org.junit.Before;
import org.junit.BeforeClass;
import org.junit.Test;

/**
 *
 * @author ian.scott
 */
public class DisciplinaryActionDtoConverterTest extends IntegrationSetup {

    public DisciplinaryActionDtoConverterTest() {
    }

    @BeforeClass
    public static void setUpClass() {
    }

    @AfterClass
    public static void tearDownClass() {
    }

    @Before
    public void setUp() {
    }

    @After
    public void tearDown() {
    }

    /**
     * Test of toEntity method
     */
    @Test
    public void testToEntity_ActiveFlag() throws Exception {
        DisciplinaryActionDto dto = populateDTO();

        PrsDisciplinaryActions result = disciplinaryActionConverter.toEntity(dto);
        assertEquals(result.getActiveFlag().getCtlNameCode(), "Y");
        assertEquals(result.getActiveFlag().getCtlDescTxt(), "Yes");
        Calendar cal = Calendar.getInstance();
        cal.set(9999, 11,30,0,0,0);
        cal.set(Calendar.MILLISECOND, 0);
        assertEquals(result.getEffectiveEndDate().getTime(), cal.getTime().getTime());
    }
    
     /**
     * Test of toEntity method
     */
    @Test
    public void testToEntity_ArchiveDateNotNull() throws Exception {
        DisciplinaryActionDto dto = populateDTO();
        Date now = new Date();
        dto.setArchiveDate(now);
        
        PrsDisciplinaryActions result = disciplinaryActionConverter.toEntity(dto);
        assertEquals(now, result.getArchiveDate());
    }
    
    
    /**
     * Test of toEntity method
     */
    @Test
    public void testToEntity_ArchiveDateNull() throws Exception {
        DisciplinaryActionDto dto = populateDTO();
        
        PrsDisciplinaryActions result = disciplinaryActionConverter.toEntity(dto);
        assertEquals(DatabaseConstants.SYSTEM_HIGH_DATE.toDate(), result.getArchiveDate());
    }

    private DisciplinaryActionDto populateDTO() {
        DisciplinaryActionDto dto = new DisciplinaryActionDto();

        dto.setPauthId(67l);
        dto.setActive(true);

        return dto;
    }
}
