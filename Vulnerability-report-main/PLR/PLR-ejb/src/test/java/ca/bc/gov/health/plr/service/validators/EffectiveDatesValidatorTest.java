/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.health.plr.service.validators;

import ca.bc.gov.health.plr.ejb.entity.PrsNotes;
import ca.bc.gov.health.plr.service.provider.IntegrationSetup;
import ca.bc.gov.health.plr.util.DateUtils;
import java.util.Calendar;
import java.util.Date;
import org.junit.Test;
import static org.junit.Assert.*;

/**
 *
 * @author adebiyi.kuseju
 */
public class EffectiveDatesValidatorTest extends IntegrationSetup {
    

    
    
    /**
     * Test of validate method, of class EffectiveDatesValidator.
     */
    @Test
    public void testValidate_positive_NoEndDate(){
        PrsNotes entity = new PrsNotes();
        
        Calendar cal = Calendar.getInstance();
        cal.setTime(new Date());
        DateUtils.truncateTime(cal);                
        entity.setEffectiveStartDate(cal.getTime());               
        
        try {
            effectiveDatesValidator.validate(entity);
        } catch (EntityValidationException ex) {
            fail("EntityValidationException should not be thrown");
        }
    }
    
    /**
     * Test of validate method, of class EffectiveDatesValidator.
     */
    @Test
    public void testValidate_positive_EndDate(){
        PrsNotes entity = new PrsNotes();
        
        Calendar cal = Calendar.getInstance();
        cal.setTime(new Date());
        DateUtils.truncateTime(cal);                
        entity.setEffectiveStartDate(cal.getTime());
        
        cal = Calendar.getInstance();
        cal.setTime(new Date());
        cal.add(Calendar.DAY_OF_MONTH, 1);
        DateUtils.truncateTime(cal);
        entity.setEffectiveEndDate(cal.getTime());
        
        try {
            effectiveDatesValidator.validate(entity);
        } catch (EntityValidationException ex) {
            fail("EntityValidationException should not be thrown");
        }
    }
    
    /**
     * Test of validate method, of class EffectiveDatesValidator.
     */
    @Test
    public void testValidate_positive_NoDates(){
        PrsNotes entity = new PrsNotes();
               
        
        try {
            effectiveDatesValidator.validate(entity);
        } catch (EntityValidationException ex) {
            fail("EntityValidationException should not be thrown");
        }
    }
    
    /**
     * Test of validate method, of class EffectiveDatesValidator.
     */
    @Test(expected=EntityValidationException.class)
    public void testValidate_negative() throws Exception {
        PrsNotes entity = new PrsNotes();
        
        Calendar cal = Calendar.getInstance();
        cal.setTime(new Date());
        DateUtils.truncateTime(cal);                
        entity.setEffectiveStartDate(cal.getTime());
        
        cal = Calendar.getInstance();
        cal.setTime(new Date());
        cal.add(Calendar.DAY_OF_MONTH, -1);
        DateUtils.truncateTime(cal);
        entity.setEffectiveEndDate(cal.getTime());
        
        effectiveDatesValidator.validate(entity);

    }
    
}
