<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="/templates/gov21Template.xhtml">
    <ui:define name="title">Search Registry User</ui:define>
    <ui:define name="body">

        <style>
            #tableLayout td {
                border: none;
            }
        </style>

        <h2>Search Registry User</h2>
        <hr/>
		
        <p:messages id="messages" showDetail="false" closable="true" >
			<p:autoUpdate disabled="false"/>
		</p:messages>
		
        <h:form id="registryUserSearchForm">

            <table id="tableLayout" style="border: none; width: 700px">
                <tbody>
                    <tr>
                        <td style="width: 35%">
                            <p:outputLabel for="regUserType" value="Registry User Type" styleClass="frmDialogLbl"/>
                            <p:selectOneMenu id="regUserType" value="#{searchRegUserManager.searchParam.registryUserType}">
                                <f:selectItems value="#{Droplists.grsCtRegUserTypes}" />
                            </p:selectOneMenu>
                        </td>
                        <td style="width: 35%">
                            <p:outputLabel for="earliestRegDate" value="Earliest Registration Date" styleClass="frmDialogLbl"/>
                            <p:calendar id="earliestRegDate" value="#{searchRegUserManager.searchParam.earliestRegDate}" showOn="button" navigator="true" size="11"/>
                            <p:watermark value="1980-06-30" for="earliestRegDate"/>
                        </td>
                        <td style="vertical-align: bottom;">
                            <p:commandButton id="idNoteSubmitButton" 
                                             value="Search" 
                                             actionListener="#{searchRegUserManager.search()}" 
                                             update="tbl" />
                            <p:ajaxStatus style="display:inline-block">
                                <f:facet name="start"><h:graphicImage value="/images/Spinner.gif"/></f:facet>
                                <f:facet name="complete"><h:outputText value="" /></f:facet>                     
                            </p:ajaxStatus>
                        </td>
                    </tr>                    
                </tbody>
            </table>

            <p:dataTable id="tbl" var="result" value="#{searchRegUserManager.searchResult}"  rows="10" paginator="true" paginatorPosition="bottom" paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" rowsPerPageTemplate="5,10,15" style="padding-top: 50px">
                <p:column styleClass="wrap" sortBy="#{result.activeOrgNameDto.name}">
                    <f:facet name="header">
                        <h:outputText value="Name"/>
                    </f:facet>
                    <h:outputText value="#{result.activePersonNameDto.fullName}, " rendered="#{result.activePersonNameDto.fullName ne null}"/>
                    <h:outputText value="#{result.activeOrgNameDto.name}"/>
                </p:column>
                <p:column styleClass="wrap" sortBy="#{result.regIdentifier}">
                    <f:facet name="header">
                        <h:outputText value="Registry Id"/>
                    </f:facet>
                    <h:link outcome="RegUserDetails" value="#{result.regIdentifier}">
                        <f:param name="r" value="#{result.id}" />
                    </h:link>
                </p:column>                       
                <p:column styleClass="wrap" sortBy="#{result.activeAddressDto.fullAddress}">
                    <f:facet name="header">
                        <h:outputText value="Address"/>
                    </f:facet>
                    <h:outputText value="#{result.activeAddressDto.fullAddress}"/>
                </p:column>
                <p:column sortBy="#{result.regUserType}">
                    <f:facet name="header">
                        <h:outputText value="Registry User Type"/>
                    </f:facet>
                    <h:outputText value="#{result.regUserType}"/> 
                </p:column>
            </p:dataTable>
        </h:form>
    </ui:define>
</ui:composition>