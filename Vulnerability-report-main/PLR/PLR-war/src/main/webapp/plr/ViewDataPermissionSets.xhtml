<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="/templates/gov21Template.xhtml">
    <ui:define name="title">Data Permission Sets</ui:define>
    <ui:define name="body">
        <style>
            #tableLayout td {
                border: none;
            }      
            tr.highlight {
                background: #999999  !important ;
                color : red !important;
            }
            #content tr, td{
                background: none;
            }
            .icon-spacing {
                padding-right: 3px;
            }  
        </style>
        <ui:include src="/WEB-INF/admin/modal/MaintainDPS.xhtml" />
        <ui:include src="/WEB-INF/admin/modal/MaintainPermissions.xhtml" /> 
        <f:metadata>
            <f:event type="preRenderView" listener="#{dpsManager.searchDps()}" />
        </f:metadata>
        <h2>Data Permission Sets</h2>
        <hr/>
		
        <p:messages id="messages" showDetail="false" closable="true" >
			<p:autoUpdate disabled="false"/>
		</p:messages>
		
        <h:form id="dpsListForm">
            <div class="formControls" style="text-align:right">
                <p:commandLink process="@this" actionListener="#{maintainDpsManager.addDps()}" 
                               update=":maintainDPSDialog" oncomplete="PF('maintainDPSModal').show()">
                    <p:resetInput target=":maintainDPSForm" />
                    <h:graphicImage library="images" name="new-big.png" title="Add" styleClass="icon-spacing"/>
                    <f:setPropertyActionListener value=":dpsListForm" target="#{dpsManager.panelToUpdate}" />
                    <f:setPropertyActionListener value="#{dpsManager.groups}" target="#{maintainDpsManager.groups}" />
                </p:commandLink>
            </div>


            <p:dataTable id="tbl" var="result" value="#{dpsManager.groups}"  
                         rows="10" paginator="true" paginatorPosition="bottom" 
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" 
                         rowsPerPageTemplate="5,10,15" style="padding-top: 5px">                
                <p:column styleClass="wrap" sortBy="#{result.groupChid}">
                    <f:facet name="header">
                        <h:outputText value="Name"/>
                    </f:facet>
                    <h:outputText value="#{result.groupChid} " />
                </p:column>
                <p:column styleClass="wrap" sortBy="#{result.activeGroupDesc.description}">
                    <f:facet name="header">
                        <h:outputText value="Description"/>
                    </f:facet>
                    <h:outputText value="#{result.activeGroupDesc.description}"/>
                </p:column>                       
                <p:column styleClass="wrap" style="width: 12%">
                    <f:facet name="header">
                        <h:outputText value=""/>
                    </f:facet>
                    <p:commandLink process="@this" actionListener="#{maintainDpsManager.updateDps(result)}" 
                                   update=":maintainDPSDialog" oncomplete="PF('maintainDPSModal').show()">
                        <p:resetInput target=":maintainDPSForm" />
                        <h:graphicImage library="images" name="edit-big.png" title="Update" styleClass="icon-spacing"/>
                        <f:setPropertyActionListener value=":dpsListForm" target="#{dpsManager.panelToUpdate}" /> 
                        <f:setPropertyActionListener value="#{dpsManager.groups}" target="#{maintainDpsManager.groups}" />
                    </p:commandLink>

                    <p:commandLink process="@this" actionListener="#{maintainPermissionsManager.viewPermissions(result)}" 
                                   update=":maintainPermissionDialog" oncomplete="PF('maintainPermissionModal').show()">  
                        <p:resetInput target=":maintainPermissionForm" />
                        <h:graphicImage library="images" name="permissions.png" title="Permissions" styleClass="icon-spacing"/>
                        <f:setPropertyActionListener value="" target="#{dpsManager.panelToUpdate}" /> 
                    </p:commandLink>

                    <p:commandLink process="@this" actionListener="#{maintainDpsManager.cloneDps(result)}" 
                                   update=":maintainDPSDialog" oncomplete="PF('maintainDPSModal').show()">
                        <p:resetInput target=":maintainDPSForm" />
                        <h:graphicImage library="images" name="copy.png" title="Clone" styleClass="icon-spacing"/>
                        <f:setPropertyActionListener value=":dpsListForm" target="#{dpsManager.panelToUpdate}" /> 
                        <f:setPropertyActionListener value="#{dpsManager.groups}" target="#{maintainDpsManager.groups}" />
                    </p:commandLink>

                </p:column>

            </p:dataTable>
        </h:form>
    </ui:define>
</ui:composition>

