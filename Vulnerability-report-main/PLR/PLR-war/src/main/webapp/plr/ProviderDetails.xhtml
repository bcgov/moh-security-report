<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="/templates/gov21Template.xhtml">

    <f:metadata>
        <f:viewParam name="p" value="#{viewProviderManager.pauthId}" 
                     required="#{not facesContext.postback}" requiredMessage="Bad URL. Please use a link from within the application." />
        <f:event type="preRenderView" listener="#{viewProviderManager.viewDetails}" />
    </f:metadata>

    <ui:define name="title">View Provider Details</ui:define>
    <ui:define name="body">
        <script>
            // <![CDATA[
            // toggle collapse
            function processExpandAll() {
                expandAll();
            }
            // ]]>
        </script>
        <style>
            td {
                border: none;
            }

            .ui-norecords-found {
                padding-left: 1em;
            }

            .icon-spacing {
                padding-right: 3px;
            }
            #outer-div {
                display: flex;
                justify-content: left;
            }
            #inner-div > div {
                display: inline-block;
                text-align: left;
                padding: 3px;
            }
        </style>

        <ui:include src="/WEB-INF/provider/modal/MaintainRegistryIdentifier.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainIdentifier.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainStatus.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainExpertise.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainCredential.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainPersonName.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainOrgName.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainAddress.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainTelecommunication.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainElectronicAddress.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainDemographicDetails.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainWorkLocation.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainCondition.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainDisciplinaryAction.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainInformationRoute.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainConfidentialityIndicator.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainProviderRelationship.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainRegistryUserRelationship.xhtml" />
        <ui:include src="/WEB-INF/provider/modal/MaintainNote.xhtml" />

        <h:panelGroup id="headerGroup">
            <h:form id="form">
                <div style="display:inline; font-size:1.5em;">
                    <ui:fragment rendered="#{viewProviderManager.providerDetails.providerType == 'PRACTITIONER'}">
                        <h:outputText value="#{providerDetailsUtil.getMostRecentName(viewProviderManager.providerDetails.indNames)}"/>
                        <h:outputText value=" - #{providerDetailsUtil.getMostRecentCollegeId(viewProviderManager.providerDetails.identifiers)}"/>
                        <h:outputText value="(#{providerDetailsUtil.getMostRecentDataOwnerCode(viewProviderManager.providerDetails.indNames)})" 
                                      rendered="#{!viewProviderManager.providerDetails.confidential}"/>
                    </ui:fragment>
                    <ui:fragment rendered="#{viewProviderManager.providerDetails.providerType == 'ORGANIZATION'}">
                        <h:outputText style="white-space: pre-wrap;word-break: break-all" value="#{providerDetailsUtil.getMostRecentOrgName(viewProviderManager.providerDetails.orgNames)}"/>
                        <h:outputText value="(#{providerDetailsUtil.getMostRecentOrgDataOwnerCode(viewProviderManager.providerDetails.orgNames)})" 
                                      rendered="#{!viewProviderManager.providerDetails.confidential}"/>
                    </ui:fragment>
                    <h:outputText value=" - #{providerDetailsUtil.getMostRecentStatus(viewProviderManager.providerDetails.statuses)}" 
                                  rendered="#{!viewProviderManager.providerDetails.confidential}"/>
                </div>
                <div style="float: right;">
                    <p:commandLink action="#{viewProviderManager.toggleCollapse}" rendered="#{!viewProviderManager.collapsed}">
                        <h:graphicImage library="images" name="collapse.png" title="Collapse All" onclick="processExpandAll();" styleClass="icon-spacing"/>
                    </p:commandLink>
                    <p:commandLink action="#{viewProviderManager.toggleCollapse}" rendered="#{viewProviderManager.collapsed}">
                        <h:graphicImage library="images" name="expand.png" title="Expand All" onclick="processExpandAll();" styleClass="icon-spacing"/>
                    </p:commandLink>
                    <p:commandLink>
                        <h:graphicImage library="images" name="printer.png" title="Print" onclick="print();" styleClass="icon-spacing"/>
                    </p:commandLink>
                </div>
                <div style="float: right;">
                    <p:ajaxStatus style="display:inline-block">
                        <f:facet name="start"><h:graphicImage value="/resources/Spinner.gif"/></f:facet>
                        <f:facet name="complete"><h:outputText value="" /></f:facet>                     
                    </p:ajaxStatus>                    
                    <p:menuButton value="#{viewProviderManager.providerDetailsViewModeForDisplay}" >
                        <p:menuitem value="Current" actionListener="#{viewProviderManager.showCurrentView}" update=":providerDetailsGroup, :headerGroup" />
                        <p:menuitem value="History" actionListener="#{viewProviderManager.showHistoryView}" update=":providerDetailsGroup, :headerGroup" rendered="#{viewProviderManager.userRoleService.primarySource || viewProviderManager.userRoleService.secondarySource || viewProviderManager.userRoleService.regAdmin || viewProviderManager.userRoleService.consumer}"/>
                        <p:menuitem value="Audit" actionListener="#{viewProviderManager.showAuditView}" update=":providerDetailsGroup, :headerGroup" rendered="#{viewProviderManager.userRoleService.primarySource || viewProviderManager.userRoleService.secondarySource || viewProviderManager.userRoleService.regAdmin}"/>
                    </p:menuButton>                    
                </div>
                <p:remoteCommand name="expandAll" process="@this" actionListener="#{viewProviderManager.toggleCollapse}" update=":providerDetailsGroup, :headerGroup" />
            </h:form>

        </h:panelGroup>
		
        <p:messages id="modalMessages" showDetail="false" closable="true" globalOnly="true">
			<p:autoUpdate disabled="false"/>
		</p:messages>
		
        <p:growl severity="info" showDetail="false" for="#{viewProviderManager.PROVIDER_DETAILS_GROWL}" globalOnly="false" >
			<p:autoUpdate disabled="false"/>
		</p:growl>
        
        <br/>

        <h:panelGroup id="providerDetailsGroup">
            <ui:include src="/WEB-INF/provider/details/RegistryIdentifiers.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/Identifiers.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/Statuses.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/Expertise.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/Credentials.xhtml" /><br/>
            <h:panelGroup rendered="#{viewProviderManager.providerDetails.providerType == 'PRACTITIONER'}">
                <ui:include src="/WEB-INF/provider/details/PersonNames.xhtml"/><br/>
            </h:panelGroup>
            <h:panelGroup rendered="#{viewProviderManager.providerDetails.providerType == 'ORGANIZATION'}">    
                <ui:include src="/WEB-INF/provider/details/OrgNames.xhtml"/><br/>
            </h:panelGroup>
            <ui:include src="/WEB-INF/provider/details/Addresses.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/Telecommunications.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/ElectronicAddresses.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/Demographics.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/WorkLocations.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/Conditions.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/DisciplinaryActions.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/InformationRoutes.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/Confidentiality.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/ProviderRelationships.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/RegistryUserRelationships.xhtml" /><br/>
            <ui:include src="/WEB-INF/provider/details/Notes.xhtml" /><br/>
        </h:panelGroup>
    </ui:define>
</ui:composition>