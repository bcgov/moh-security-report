<?xml version="1.0" encoding="UTF-8"?>
<!--
    Document: DsrDeliverySiteIdentifierSearch.jsp
    Created: Wed Nov 28 10:02:00 PST 2012
    Author: JSF Code Generator-->
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:richext="http://java.sun.com/jsf/composite/richext"
                template="/templates/gov21Template.xhtml">
    <ui:define name="title"><h:outputText value="#{msg['MergeDeliverySite.title']}"/></ui:define>
    <ui:define name="body">
        <style>
            .plain {
                border: 0;
                background: none;
            }
        </style>
        <h2><h:outputText value="#{msg['MergeDeliverySite.title']}"/></h2>
        <hr/>
		
        <p:messages id="messages" showDetail="false" closable="true" >
			<p:autoUpdate disabled="false"/>
		</p:messages>
		
        <richext:spacer height="10"/>
        <h:form id="mergeForm">
            <p:outputPanel>
                <p:panel>
                    <f:facet name="header">
                        <h:outputText value="#{msg['MergeDeliverySite.surviving.ds.id']}"/>
                    </f:facet> 

                    <table cellpadding="2" cellspacing="0">
                        <tr>
                            <td>
                                <h:outputText value="#{msg['MergeDeliverySite.ds.id']}"/>
                            </td>
                            <td colspan="4">
                                <h:inputText id="surviving" value="#{DsrMergeSitesBean.survivingSite.primaryId.identifierNo}" size="#{msg['textfield.larger.size']}" required="true" readonly="true" requiredMessage="Surviving DS ID must be provided" />
                            </td>
                            <td>
                                <p:commandButton value="#{msg['button.search']}" process="@this" action="#{PrsWorkLocationBean.clearSearch}" oncomplete="PF('searchPopupForm').show();" update="survivingSiteNameBlock searchPopupForm">
                                    <f:setPropertyActionListener value="surviving" target="#{DsrMergeSitesBean.idType}" />
                                </p:commandButton>
                            </td>
                        </tr>
                        <tr>
                            <td>                               
                            </td>
                            <td colspan="5">
                                <p:outputPanel id="survivingSiteNameBlock">
                                    <h:outputText value="#{msg['MergeDeliverySite.site.name']} " rendered="#{not empty DsrMergeSitesBean.survivingSite.wlId}"/>
                                    <h:outputText value="#{DsrMergeSitesBean.survivingSite.prsWorkLocationDetailsList[0].workLocationNameTxt}" rendered="#{not empty DsrMergeSitesBean.survivingSite.wlId}"/>
                                </p:outputPanel>
                            </td>
                        </tr>
                    </table>
                </p:panel>
                <richext:spacer height="30"/>
                <p:panel>
                    <f:facet name="header">
                        <h:outputText value="#{msg['MergeDeliverySite.nonsurviving.ds.id']}"/>
                    </f:facet> 
                    <table cellpadding="2" cellspacing="0">
                        <tr>
                            <td>
                                <h:outputText value="#{msg['MergeDeliverySite.ds.id']}"/>
                            </td>
                            <td colspan="4">
                                <h:inputText id="nonSurviving" value="#{DsrMergeSitesBean.nonSurvivingSite.primaryId.identifierNo}" size="#{msg['textfield.larger.size']}" required="true" readonly="true" requiredMessage="Non-Surviving DS ID must be provided" />
                            </td>
                            <td>
                                <p:commandButton value="#{msg['button.search']}" process="@this" action="#{PrsWorkLocationBean.clearSearch}" oncomplete="PF('searchPopupForm').show();" update="searchPopupForm" >
                                    <f:setPropertyActionListener value="non-surviving" target="#{DsrMergeSitesBean.idType}" />
                                </p:commandButton>
                            </td>
                        </tr>
                        <tr>
                            <td>                               
                            </td>
                            <td colspan="5">
                                <p:outputPanel id="nonSurvivingSiteNameBlock">
                                    <h:outputText value="#{msg['MergeDeliverySite.site.name']} " rendered="#{not empty DsrMergeSitesBean.nonSurvivingSite.wlId}"/>
                                    <h:outputText value="#{DsrMergeSitesBean.nonSurvivingSite.prsWorkLocationDetailsList[0].workLocationNameTxt}" rendered="#{not empty DsrMergeSitesBean.nonSurvivingSite.wlId}"/>
                                </p:outputPanel>
                            </td>                            
                        </tr>
                    </table>
                </p:panel>
                <richext:spacer height="20"/>
                <div style="text-align: right">
                    <p:commandButton id="mergeButton" value="#{msg['button.merge']}" action="#{DsrMergeSitesBean.merge}" ajax="false" disabled="#{DsrMergeSitesBean.survivingSite.primaryId.identifierNo == null or DsrMergeSitesBean.nonSurvivingSite.primaryId.identifierNo == null}"/>                    
                    <richext:spacer width="10"/>
                    <p:commandButton value="#{msg['button.clear']}" action="#{DsrMergeSitesBean.clear}" process="@this" update="@form"/>
                </div>
            </p:outputPanel>

            <p:dialog styleClass="no-mandatory-text" id="searchPopupForm" widgetVar="searchPopupForm" modal="true" minWidth="800" width="800" minHeight="600" height="600" closeOnEscape="true" closable="true">
                <f:facet name="header">
                    Search Criteria
                </f:facet>                
                <ui:include src="/WEB-INF/fragments/DeliverySiteSearchCriteria.xhtml">
                    <ui:param name="action" value="mergeSearch"/>
                </ui:include>  
                <ui:include src="/WEB-INF/fragments/DeliverySiteSearchResult.xhtml">
                    <ui:param name="action" value="mergeSearch"/>
                </ui:include>  
            </p:dialog>
        </h:form>
    </ui:define>
</ui:composition>
