<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:custom="http://java.sun.com/jsf/composite/custom">
    <p:panel id="telecommunicationsPanel" header="Telecommunications">
        <h:panelGrid styleClass="recordDetailsPanels">
            <h:outputText styleClass="ui-norecords-found" rendered="#{empty viewRegUserManager.registryUserDetails.telecommunication }" 
                          value="There are no telecommunications to display."/>
            <ui:repeat var="telecom" value="#{viewRegUserManager.registryUserDetails.telecommunication}">
                <p:panel id="telecommunicationPanel" header="#{telecom.areaCode} #{telecom.number} #{telecom.extension} (#{telecom.type}) (#{telecom.communicationPurpose}) " toggleTitle="Expand/Collapse" toggleable="true" 
                         collapsed="#{viewRegUserManager.collapsed}">
                    <h:panelGrid columns="2" cellpadding="2">
                        <h:outputLabel value="Telecom Type:"/><h:outputText value="#{telecom.typeCode} - #{telecom.type}"/>
                        <h:outputLabel value="Telecom Purpose:"/><h:outputText value="#{telecom.communicationPurposeCode} - #{telecom.communicationPurpose}"/>
                        <h:outputLabel value="Telecom Area Code:"/><h:outputText value="#{telecom.areaCode}"/>
                        <h:outputLabel value="Telecom Number:"/><h:outputText value="#{telecom.number}"/>
                        <h:outputLabel value="Telecom Ext:"/><h:outputText value="#{telecom.extension}"/>
                        <h:outputLabel value="Effective Start Date:"/><h:outputText value="#{jsfUtils.formatDate(telecom.effectiveStartDate)}"/>
                        <h:outputLabel value="Effective End Date:"/><h:outputText value="#{jsfUtils.formatDate(telecom.effectiveEndDate)}"/>
                        
                        <h:outputLabel value="End Reason:"/><h:outputText value="#{telecom.endReasonCode}"/>
                        <h:outputLabel value="Data Source:"/><h:outputText value="#{telecom.userChid}"/>
                        <h:outputLabel value="DB Created:"/><h:outputText value="#{jsfUtils.formatDate(telecom.createdDate)}"/>
                        <h:outputLabel value="DB Expired:"/><h:outputText value="#{jsfUtils.formatDate(telecom.invalidatedDate)}"/>
                        <h:outputLabel value="Data Owner Code:"/><h:outputText value="#{telecom.dataOwnerCode}"/>
                    </h:panelGrid>
                    <f:facet name="actions" >
                        <h:panelGroup styleClass="rightAlign">
                            <custom:activeIcon rendered="#{telecom.displayActive}" />
                            <p:commandLink  id="updateTelecomLink" rendered="#{telecom.updatable}" oncomplete="PF('maintainTelecomModal').show()" update=":maintainTelecomDialog">
                                <custom:updateIcon title="Update #{telecom.type}" />
                                <f:setPropertyActionListener value="#{telecom}" target="#{maintainTelephoneManager.telephoneDto}" />
                                <f:setPropertyActionListener value="#{viewRegUserManager.registryUserDetails.ruId}" target="#{maintainTelephoneManager.ruId}" />
                                <f:setPropertyActionListener value="#{viewRegUserManager.registryUserDetails.telecommunication}" target="#{maintainTelephoneManager.telephones}" />
                                <p:resetInput target=":maintainTelecomForm" />
                            </p:commandLink>
                        </h:panelGroup>
                    </f:facet>
                </p:panel>
            </ui:repeat>
        </h:panelGrid>   
        <f:facet name="actions" >
            <p:commandLink process="@this" actionListener="#{maintainTelephoneManager.init}" update=":maintainTelecomDialog" oncomplete="PF('maintainTelecomModal').show()">
                <custom:addIcon title="Add a new Telecommunication" />
                <f:setPropertyActionListener value="#{viewRegUserManager.registryUserDetails.ruId}" target="#{maintainTelephoneManager.ruId}" />
                <f:setPropertyActionListener value="#{viewRegUserManager.registryUserDetails.telecommunication}" target="#{maintainTelephoneManager.telephones}" />
                <f:setPropertyActionListener value=":telecommunicationsPanel" target="#{maintainTelephoneManager.panelToUpdate}" /> 
                <p:resetInput target=":maintainTelecomForm" />
            </p:commandLink>
        </f:facet>
    </p:panel>                
</ui:composition>