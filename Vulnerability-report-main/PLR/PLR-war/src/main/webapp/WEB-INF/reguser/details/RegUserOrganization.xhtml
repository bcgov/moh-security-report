<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:custom="http://java.sun.com/jsf/composite/custom"
    >
    <p:panel id="partyPanel" header="Organization">
        <h:panelGrid styleClass="recordDetailsPanels">
            <h:outputText styleClass="ui-norecords-found" rendered="#{empty viewRegUserManager.registryUserDetails.parties}" value="There are no names to display."/>
            <ui:repeat var="party" value="#{viewRegUserManager.registryUserDetails.parties}">
                <p:panel id="orgNamePanel" header="#{party.regUserId}" toggleTitle="Expand/Collapse" 
                         toggleable="true" collapsed="#{viewRegUserManager.collapsed}" styleClass="ui-subpanel" >
                    <h:panelGrid columns="2" cellpadding="2">
                        <h:outputLabel value="Registry User ID:"/><h:outputText value="#{party.regUserId}"/>
                        <h:outputLabel value="Contact Details:"/><h:outputText value="#{party.partyDetailsDto.contactDetails}"/>
                        <h:outputLabel value="Agreement ID:"/><h:outputText value="#{party.partyDetailsDto.agreement}"/>
                        <h:outputLabel value="Default Data Set:"/><h:outputText value="#{party.defaultDataSetCode} - #{party.defaultDataSetText}"/>
                        <h:outputLabel value="Effective Start Date:"/><h:outputText value="#{jsfUtils.formatDate(party.partyDetailsDto.effectiveStartDate)}"/>
                        <h:outputLabel value="Effective End Date:"/><h:outputText value="#{jsfUtils.formatDate(party.partyDetailsDto.effectiveEndDate)}"/>
                        <h:outputLabel value="End Reason:"/><h:outputText value="#{party.endReasonCode}"/>
                        <h:outputLabel value="Data Source:"/><h:outputText value="#{party.userChid}"/>
                        <h:outputLabel value="DB Created:"/><h:outputText value="#{jsfUtils.formatDate(party.createdDate)}"/>
                        <h:outputLabel value="DB Expired:"/><h:outputText value="#{jsfUtils.formatDate(party.invalidatedDate)}"/>
                    </h:panelGrid>
                    <f:facet name="actions" >
                        <h:panelGroup styleClass="rightAlign">
                            <custom:activeIcon rendered="#{party.displayActive}" />
                            <p:commandLink id="updateNameLink" 
                                           rendered="#{party.updatable}" 
                                           oncomplete="PF('maintainPartyModal').show()" 
                                           update=":maintainPartyDialog" 
                                           styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default">
                                <custom:updateIcon title="Update #{party.regUserId}" />
                                <f:setPropertyActionListener value="#{viewRegUserManager.registryUserDetails}" target="#{maintainPartyManager.registryUserDetails}" />
                                <f:setPropertyActionListener value="#{party}" target="#{maintainPartyManager.dto}" />
                                <p:resetInput target=":maintainPartyForm" />
                            </p:commandLink>
                        </h:panelGroup>
                    </f:facet>
                </p:panel>            
            </ui:repeat>
        </h:panelGrid>
    </p:panel>
</ui:composition>