<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:custom="http://java.sun.com/jsf/composite/custom">
    <p:panel id="distributionPanel" header="Distribution" >
        <h:panelGrid styleClass="recordDetailsPanels">
            <h:outputText styleClass="ui-norecords-found" rendered="#{empty viewRegUserManager.registryUserDetails.distributions}" 
                          value="There are no distributions to display."/>
            <ui:repeat var="dist" value="#{viewRegUserManager.registryUserDetails.distributions}">
                <p:panel id="distPanel" header="#{dist.name}" toggleTitle="Expand/Collapse" toggleable="true"
                         collapsed="#{viewRegUserManager.collapsed}">
                    <h:panelGrid columns="2" cellpadding="2">
                        <h:outputLabel value="Profile Type:"/><h:outputText value="#{dist.profileTypeCode} (#{dist.profileType})"/>
                        <h:outputLabel value="Profile Name:"/><h:outputText value="#{dist.name}"/>
                        <h:outputLabel value="Destination Address:"/><h:outputText value="#{dist.destAddress}"/>
                        <h:outputLabel value="Uppercase Only:"/><h:outputText value="#{dist.upperCase ? 'TRUE' : 'FALSE'}"/>
                        <h:outputLabel value="Future Updates:"/><h:outputText value="#{dist.futureUpdates ? 'TRUE' : 'FALSE'}"/>
                        <h:outputLabel value="Direct Or Through HIAL:"/><h:outputText value="#{dist.isHial ? 'HIAL':'Direct'}"/>
                        <h:outputLabel value="Distribution Hold Flag:"/><h:outputText value="#{dist.hold ? 'TRUE' : 'FALSE'}"/>
                        <h:outputLabel value="Data Option:"/><h:outputText value="#{dist.optionCode}"/>
                        <h:outputLabel value="Distribute Create Code:"/><h:outputText value="#{dist.createCode}"/>
                        <h:outputLabel value="Distribute Updates Code:"/><h:outputText value="#{dist.updateCode}"/>
                        <h:outputLabel value="Distribute Own Code:"/><h:outputText value="#{dist.ownCode}"/>

                        
                        <h:outputLabel value="End Reason:"/><h:outputText value="#{dist.endReasonCode}"/>
                        <h:outputLabel value="Data Source:"/><h:outputText value="#{dist.userChid}"/>
                        <h:outputLabel value="DB Created:"/><h:outputText value="#{jsfUtils.formatDate(dist.createdDate)}"/>
                        <h:outputLabel value="DB Expired:"/><h:outputText value="#{jsfUtils.formatDate(dist.invalidatedDate)}"/>
                        
                    </h:panelGrid>
                    <f:facet name="actions" >
                        <h:panelGroup styleClass="rightAlign">
                            <custom:activeIcon rendered="#{dist.displayActive}" />
                            <p:commandLink  id="updateDistLink" rendered="#{dist.updatable}"  oncomplete="PF('maintainDistModal').show()" update=":maintainDistDialog">
                                <custom:updateIcon title="Update" />                                
                                <f:setPropertyActionListener value="#{viewRegUserManager.registryUserDetails.ruId}" target="#{maintainDistributionManager.ruId}" />
                                <f:setPropertyActionListener value="#{dist}" target="#{maintainDistributionManager.distDto}" />
                                <f:setPropertyActionListener value="#{viewRegUserManager.registryUserDetails.distributions}" target="#{maintainDistributionManager.distributions}" />
                                <f:setPropertyActionListener value=":distributionPanel" target="#{maintainDistributionManager.panelToUpdate}" /> 
                                <p:resetInput target=":maintainDistForm" />
                            </p:commandLink>
                        </h:panelGroup>
                    </f:facet>
                </p:panel>
            </ui:repeat>
        </h:panelGrid>
        <f:facet name="actions" >
            <p:commandLink process="@this" actionListener="#{maintainDistributionManager.init}" update=":maintainDistDialog" oncomplete="PF('maintainDistModal').show();">
                <custom:addIcon title="Add a new Distribution" />
                <f:setPropertyActionListener value="#{viewRegUserManager.registryUserDetails.ruId}" target="#{maintainDistributionManager.ruId}" />
                <f:setPropertyActionListener value="#{viewRegUserManager.registryUserDetails.distributions}" target="#{maintainDistributionManager.distributions}" />
                <f:setPropertyActionListener value=":distributionPanel" target="#{maintainDistributionManager.panelToUpdate}" /> 
                <p:resetInput target=":maintainDistForm" />
            </p:commandLink>
        </f:facet>
    </p:panel>              

</ui:composition>