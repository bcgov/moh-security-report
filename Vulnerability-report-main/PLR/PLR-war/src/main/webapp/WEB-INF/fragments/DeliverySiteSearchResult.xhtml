<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:richext="http://java.sun.com/jsf/composite/richext">

    <p:outputPanel id="resultContainer">
        <richext:spacer height="30"/>
        <h2>
            #{msg['SearchAndMerge.result.title']}

            <p:outputPanel rendered="#{action eq 'mainSearch'}" style="float: right">
                <h:commandLink id="pdfExport" action="#{PrsWorkLocationBean.exportAsPdf('searchForm:resultTable')}" rendered="#{PrsWorkLocationBean.searchResult.size() gt 0}">
                    <h:graphicImage library="images" name="pdf.png"/>                  
                </h:commandLink>
                <p:tooltip id="pdfTt" for="pdfExport">
                    <span style="white-space: nowrap">Export as PDF</span>
                </p:tooltip>
                #{' '} 
                <h:commandLink id="excelExport" action="#{PrsWorkLocationBean.exportAsXls('searchForm:resultTable')}"  rendered="#{PrsWorkLocationBean.searchResult.size() gt 0}">
                    <h:graphicImage library="images" name="excel.png"/>                   
                </h:commandLink>
                <p:tooltip id="excelTt" for="excelExport">
                    <span style="white-space: nowrap">Export as Excel</span>
                </p:tooltip>
                #{' '} 
                <h:commandLink id="csvExport" action="#{PrsWorkLocationBean.exportAsCsv('searchForm:resultTable')}"  rendered="#{PrsWorkLocationBean.searchResult.size() gt 0}">
                    <h:graphicImage library="images" name="csv.png"/>                    
                </h:commandLink>
                <p:tooltip id="csvTt" for="csvExport">
                    <span style="white-space: nowrap">Export as CSV</span>
                </p:tooltip>
            </p:outputPanel>
        </h2>
        <hr/>

        <richext:spacer height="10"/>
        <style>
            .headerLink {
                color: white;
                cursor: pointer
            }
        </style>
        <h:inputHidden id="resultSize" value="#{PrsWorkLocationBean.searchSuccess}"  />
        <p:panel>
            <p:dataTable id="resultTable" value="#{PrsWorkLocationBean.searchResult}" var="var" rows="10" paginator="true" paginatorPosition="bottom" paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" rowsPerPageTemplate="5,10,15" >
                <p:column sortBy="#{var.primaryId.identifierNo}" styleClass="wrap">
                    <f:facet name="header"><h:outputLabel value="DS ID" styleClass="headerLink"/></f:facet>
                    <h:outputText value="#{var.primaryId.identifierNo}" rendered="#{action == 'mainSearch' and var.statusId.ctlDescTxt ne 'Merged'}"/>
                    <p:commandLink value="#{var.primaryId.identifierNo}" rendered="#{action == 'mergeSearch' and DsrMergeSitesBean.idType == 'surviving' and var.statusId.ctlDescTxt ne 'Merged'}" onclick="PF('searchPopupForm').hide();" update=":mergeForm:surviving :mergeForm:survivingSiteNameBlock :mergeForm:mergeButton">
                        <!--update="surviving survivingSiteNameBlock"-->
                        <f:setPropertyActionListener value="#{var}" target="#{DsrMergeSitesBean.survivingSite}" />
                    </p:commandLink>
                    <p:commandLink value="#{var.primaryId.identifierNo}" rendered="#{action == 'mergeSearch' and DsrMergeSitesBean.idType == 'non-surviving' and var.statusId.ctlDescTxt ne 'Merged'}" onclick="PF('searchPopupForm').hide();" update=":mergeForm:nonSurviving :mergeForm:nonSurvivingSiteNameBlock :mergeForm:mergeButton">   
                        <!--update="nonSurviving nonSurvivingSiteNameBlock"-->
                        <f:setPropertyActionListener value="#{var}" target="#{DsrMergeSitesBean.nonSurvivingSite}" />
                    </p:commandLink>
                </p:column>
                <p:column style="width: 10%" sortBy="#{var.statusId.ctlDescTxt}" styleClass="wrap">
                    <f:facet name="header"><h:outputLabel value="Status" onclick="sortByStatus();" styleClass="headerLink"/></f:facet>
                    <h:outputText value="#{var.statusId.ctlDescTxt}"/>
                </p:column>
                <p:column style="width: 20%" sortBy="#{var.prsWorkLocationDetailsList[0].workLocationNameTxt}" styleClass="wrap">
                    <f:facet name="header"><h:outputLabel value="Site Name" onclick="sortBySiteName();" styleClass="headerLink"/></f:facet>
                    <h:commandLink action="#{PrsWorkLocationBean.viewSiteWithId(var.wlId, 'existingRequest')}" rendered="#{action == 'mainSearch'}">
                        <h:outputText value="#{var.prsWorkLocationDetailsList[0].workLocationNameTxt}"/>
                    </h:commandLink>
                    <h:outputText value="#{var.prsWorkLocationDetailsList[0].workLocationNameTxt}" rendered="#{action == 'mergeSearch'}"/>
                </p:column>
                <p:column style="width: 30%" sortBy="#{var.grsAddressesList[0].fullAddress}" styleClass="wrap">
                    <f:facet name="header"><h:outputLabel value="Address" onclick="sortByAddress();" styleClass="headerLink"/></f:facet>
                    <h:outputText value="#{var.grsAddressesList[0].fullAddress}" escape="false"/>
                </p:column>
                <p:column sortBy="#{var.prsWorkLocationDetailsList[0].dsrSiteProgramCategoriesList[0].programCategoryCd.programAreaCd.programAreaDsc}" styleClass="wrap">
                    <f:facet name="header"><h:outputLabel value="Program Area" onclick="sortByProgramArea();" styleClass="headerLink"/></f:facet>
                    <h:outputText value="#{var.prsWorkLocationDetailsList[0].dsrSiteProgramCategoriesList[0].programCategoryCd.programAreaCd.programAreaDsc}"/>
                </p:column>
                <p:column style="width: 15%" sortBy="#{var.pauthPauthId.grsOrgNamesList[0].orgnztnLongNameTxt}" styleClass="wrap">
                    <f:facet name="header"><h:outputLabel value="Health Authority" onclick="sortByProgramArea();" styleClass="headerLink"/></f:facet>
                    <h:outputText value="#{var.pauthPauthId.grsOrgNamesList[0].orgnztnLongNameTxt}"/>
                </p:column>                
            </p:dataTable>
        </p:panel>
    </p:outputPanel>
</ui:composition>