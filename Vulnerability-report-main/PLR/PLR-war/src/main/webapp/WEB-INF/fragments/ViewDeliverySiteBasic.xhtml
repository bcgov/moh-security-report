<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:richext="http://java.sun.com/jsf/composite/richext">
    <h:form id="viewDeliverySiteFormBasic"> 
        
        <p:messages id="messages" showDetail="false" closable="true" >
			<p:autoUpdate disabled="false"/>
		</p:messages>
        
        <p:outputPanel rendered="#{DsrWorkLocationsStagingBean.isView}">
            <div style="text-align: right">
                <!-- Display only for Basic user -->
                <p:commandButton id="updateRequest" value="#{msg['ViewDeliverySite.button.updateInfo']}"  process="@this" action="#{DsrWorkLocationsStagingBean.enableEditing}"  rendered="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.statusId.ctlDescTxt ne 'Merged'}" update="@form" ajax="false"/>

            </div>
            <h2>
                <h:outputText value="#{msg['ViewDeliverySite.title']} #{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.deliverySiteNameTxt}" rendered="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.identifierNo eq null}"/>
                <h:outputText value="#{msg['ViewDeliverySite.title']} #{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.identifierNo} - #{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.deliverySiteNameTxt}" rendered="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.identifierNo ne null}"/>

                <p:outputPanel style="float: right">
                    <h:commandLink id="pdfExport" action="#{DsrWorkLocationsStagingBean.exportAsPdf('viewDeliverySiteFormBasic:resultTable')}">
                        <h:graphicImage library="images" name="pdf.png"/>                        
                    </h:commandLink>
                    <p:tooltip id="pdfTt" for="pdfExport">
                        <span style="white-space: nowrap">Export as PDF</span>
                    </p:tooltip>
                    #{' '} 
                    <h:commandLink id="excelExport" action="#{DsrWorkLocationsStagingBean.exportAsXls('viewDeliverySiteFormBasic:resultTable')}">
                        <h:graphicImage library="images" name="excel.png"/>                        
                    </h:commandLink>
                    <p:tooltip id="excelTt" for="excelExport">
                        <span style="white-space: nowrap">Export as Excel</span>
                    </p:tooltip>
                    #{' '} 
                    <h:commandLink id="csvExport" action="#{DsrWorkLocationsStagingBean.exportAsCsv('viewDeliverySiteFormBasic:resultTable')}" >
                        <h:graphicImage library="images" name="csv.png"/>                        
                    </h:commandLink>
                    <p:tooltip id="csvTt" for="csvExport">
                        <span style="white-space: nowrap">Export as CSV</span>
                    </p:tooltip>
                </p:outputPanel>
            </h2>
            <hr/>
            <richext:spacer height="10"/>

            <p:panel>
                <f:facet name="header">
                    <h:outputText value="#{msg['AddDeliverySite.site.location']}"/>
                </f:facet> 
                <table cellpadding="2" cellspacing="0">
                    <tr>
                        <td>
                            <h:outputText value="#{msg['UpdateDeliverySite.site.location.ds.id']}" rendered="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.wlId ne null}"/>
                        </td>
                        <td>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.identifierNo}" rendered="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.wlId ne null}"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h:outputText value="#{msg['UpdateDeliverySite.site.location.status']}" rendered="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.wlId ne null}"/>
                        </td>
                        <td>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.statusId.ctlDescTxt}" rendered="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.wlId ne null}"/>
                        </td>  
                    </tr>
                    <tr>
                        <td>
                            <h:outputText value="#{msg['AddDeliverySite.site.location.name']}"/>
                        </td>
                        <td colspan="4">
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.deliverySiteNameTxt}" />
                        </td>
                    </tr>
                    <tr>
                        <!-- Address -->
                        <td>
                            <h:outputText value="#{msg['ViewDeliverySite.site.location.address']}"/>
                        </td>
                        <td colspan="4">
                            <div style="text-align: left">
                                <h:panelGroup rendered="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.addressLine1Txt ne null and DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.addressLine1Txt ne ''}">
                                    <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.addressLine1Txt}"/><br/><br/>
                                </h:panelGroup>
                                <h:panelGroup rendered="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.addressLine2Txt ne null and DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.addressLine2Txt ne ''}">
                                    <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.addressLine2Txt}"/><br/><br/>
                                </h:panelGroup>
                                <h:panelGroup rendered="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.addressLine3Txt ne null and DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.addressLine3Txt ne ''}">
                                    <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.addressLine3Txt}"/><br/><br/>
                                </h:panelGroup>
                                <h:panelGroup rendered="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.addressLine4Txt ne null and DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.addressLine4Txt ne ''}">
                                    <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.addressLine4Txt}"/><br/><br/>
                                </h:panelGroup>

                                <h:panelGroup>
                                    <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.cityTxt}" />
                                    <richext:spacer width="8"/>
                                    <h:outputText value=" #{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.provinceId.ctlDescTxt}" />
                                    <richext:spacer width="8"/>
                                    <h:outputText value=" #{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.countryId.ctlDescTxt}" />
                                </h:panelGroup><br/><br/>
                                <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.postalCodeOrZipTxt}"  />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h:outputText value="#{msg['AddDeliverySite.site.location.contact.name']}"/>
                        </td>
                        <td colspan="4">
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.contactName}" />
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h:outputText value="#{msg['AddDeliverySite.site.location.telephone']}"/>
                        </td>
                        <td>
                            <h:outputText value="(#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.phoneAreaCodeNum})" />
                            <richext:spacer width="5"/>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.phoneTelecommNmbrNum}" />
                            <richext:spacer width="5"/>
                            <h:outputText value="#{msg['AddDeliverySite.site.location.telephone.ext']}"/>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.phoneExtensionNum}" rendered="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.phoneExtensionNum ne null}"/>
                        </td>
                        <td><richext:spacer width="20"/></td>
                        <td >
                            <h:outputText value="#{msg['AddDeliverySite.site.location.fax']}"/>
                        </td>
                        <td>
                            <!-- If we have more than one telephone numbers, then the second one must be fax number -->
                            <h:outputText value="(#{DsrWorkLocationsStagingBean.faxAreaCode})" rendered="#{DsrWorkLocationsStagingBean.faxAreaCode ne null and DsrWorkLocationsStagingBean.faxAreaCode.length() gt 0}"/>
                            <richext:spacer width="5"/>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.faxNumber}"  rendered="#{DsrWorkLocationsStagingBean.faxNumber ne null and DsrWorkLocationsStagingBean.faxNumber.length() gt 0}"/>
                            <richext:spacer width="5"/>
                            <h:outputText value="#{msg['AddDeliverySite.site.location.fax.ext']}"  rendered="#{DsrWorkLocationsStagingBean.faxNumber ne null and DsrWorkLocationsStagingBean.faxNumber.length() gt 0}"/>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.faxExtensionNumber}"  rendered="#{DsrWorkLocationsStagingBean.faxExtensionNumber ne null and DsrWorkLocationsStagingBean.faxExtensionNumber.trim().length() > 0}"/>
                        </td>
                    </tr>
                    <tr>
                        <td >
                            <h:outputText value="#{msg['AddDeliverySite.site.location.email']}"/>
                        </td>
                        <td colspan="4">
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.electronicAddressTxt}"  />
                        </td>
                    </tr>
                    <tr>
                        <td >
                            <h:outputText value="#{msg['AddDeliverySite.site.location.startdate']}"/>
                        </td>
                        <td>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.effectiveStartDate}">
                                <f:convertDateTime type="date" dateStyle="medium" />
                            </h:outputText>
                        </td>
                        <td><richext:spacer width="20"/></td>
                        <td >
                            <h:outputText value="#{msg['AddDeliverySite.site.location.enddate']}"/>
                        </td>
                        <td>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.effectiveEndDate}"> 
                                <f:convertDateTime type="date" dateStyle="medium" />
                            </h:outputText>
                        </td>
                    </tr>
                </table>
            </p:panel>
            <br/>
            <p:panel> <!-- rendered="{PrsWorkLocationBean.action == 'existingRequest'}" -->
                <f:facet name="header">
                    <h:outputText value="#{msg['AddDeliverySite.site.alternateId']}"/>
                </f:facet>
                <table border="0">
                    <th>Source</th>
                    <th>Identifier</th>
                    <tbody>   
                        <ui:repeat value="#{DsrWorkLocationsStagingBean.siteIdentifierWrapperList}" var="var" >
                            <tr>
                                <td><h:outputText value="#{var.dsId.sourceSystemCd.sourceSystemCd}" rendered="#{var.displayable}"/></td>
                                <td style="text-align: right"><h:outputText value="#{var.dsId.identifierNo}" rendered="#{var.displayable}"/></td>
                            </tr>
                        </ui:repeat>
                    </tbody>
                </table>
            </p:panel>
            <br/>
            <p:panel>
                <f:facet name="header">
                    <h:outputText value="#{msg['AddDeliverySite.ownership.information']}"/>
                </f:facet>
                <table cellpadding="2" cellspacing="0">
                    <tr>
                        <td >
                            <h:outputText value="#{msg['AddDeliverySite.ownership.information.legal.owner']}"/>
                        </td>
                        <td>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.ownerNameTxt}"  />
                        </td>
                    </tr>
                    <tr>
                        <td >
                            <h:outputText value="#{msg['AddDeliverySite.ownership.information.legal.owner.type']}"/>
                        </td>
                        <td>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.ownerTypeId.ctlDescTxt}"  />
                        </td>
                    </tr>
                    <tr>
                        <td >
                            <h:outputText value="#{msg['AddDeliverySite.ownership.information.legal.operator']}"/>
                        </td>
                        <td>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.operatorNameTxt}"  />
                        </td>
                    </tr>
                    <tr>
                        <td >
                            <h:outputText value="#{msg['AddDeliverySite.ownership.information.legal.operator.type']}"/>
                        </td>
                        <td>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.operatorTypeId.ctlDescTxt}"  />
                        </td>
                    </tr>
                </table>
            </p:panel>
            <br/>
            <p:panel>
                <f:facet name="header">
                    <h:outputText value="#{msg['AddDeliverySite.additional.information']}"/>
                </f:facet>
                <table cellpadding="2" cellspacing="0">
                    <tr>
                        <td >
                            <h:outputText value="#{msg['AddDeliverySite.additional.information.program.area']}"/>
                        </td>
                        <td>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.dsrProgramCategoryStagingList[0].programCategoryCd.programAreaCd.programAreaDsc}" />
                        </td>
                    </tr>
                    <tr>
                        <td >
                            <h:outputText value="#{msg['AddDeliverySite.additional.information.program.category']}"/>
                        </td>
                        <td>
                            <div style="text-align: left">
                                <ui:repeat value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.dsrProgramCategoryStagingList}" var="var">
                                    #{var.programCategoryCd.programCategoryCd}
                                    #{' - '}
                                    #{var.programCategoryCd.programCategoryDsc}
                                    <br/><br/>
                                </ui:repeat>
                            </div>
                        </td>

                    </tr>
                    <tr>
                        <td>
                            <h:outputText value="#{msg['AddDeliverySite.additional.information.program.campus']}"/>
                        </td>
                        <td>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.campusOfCareTxt}"/>
                        </td>
                    </tr>
                    <tr>
                        <td >
                            <h:outputText value="#{msg['AddDeliverySite.additional.information.lha']}"/>
                        </td>
                        <td>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.localHealthAreaCd.localHealthAreaCd}"/>
                            #{' - '}
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.localHealthAreaCd.localHealthAreaDsc}"  />
                        </td>
                    </tr>
                    <tr>
                        <td >
                            <h:outputText value="#{msg['AddDeliverySite.additional.information.hsda']}"/>
                        </td>
                        <td>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.serviceDeliveryAreaCd.serviceDeliveryAreaCd}"/>
                            #{' - '}
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.serviceDeliveryAreaCd.serviceDeliveryAreaDsc}"  />
                        </td>
                    </tr>
                    <tr>
                        <td >
                            <h:outputText value="#{msg['AddDeliverySite.additional.information.provider.organization']}"/>
                        </td>
                        <td>
                            <h:outputText value="#{DsrWorkLocationsStagingBean.dsrWorkLocationsStaging.healthAuthorityId.grsOrgNamesList[0].orgnztnLongNameTxt}"  />
                        </td>                       
                    </tr>
                </table>
            </p:panel>
            <br/>
            <p:dataTable id="resultTable" value="#{DsrWorkLocationsStagingBean.viewExport}" var="var" style="display: none">
                <p:column>
                    <f:facet name="header">Label</f:facet>
                    <h:outputText value="#{var[0]}"/>
                </p:column>
                <p:column>
                    <f:facet name="header">Value</f:facet>
                    <h:outputText value="#{var[1]}"/>
                </p:column>
            </p:dataTable>
        </p:outputPanel>  

        <!-- Update site section-->
        <p:outputPanel id="updateSiteContainer" rendered="#{not DsrWorkLocationsStagingBean.isView}">
            <h2><h:outputText value="#{msg['UpdateDeliverySite.title']}"/></h2>
            <hr/>
            <richext:spacer height="10"/>

            <p:outputPanel id="updateSiteStaging"> 
                <ui:include src="/WEB-INF/fragments/DeliverySiteStaging.xhtml">
                    <ui:param name="action" value="update"/>
                </ui:include>
            </p:outputPanel>

        </p:outputPanel>

        <p:dialog id="requesterUpdateNotifier" styleClass="no-mandatory-text" widgetVar="requesterUpdateNotifier" modal="true" resizable="false" visible="true" rendered="#{DsrWorkLocationsStagingBean.success}">
            <f:facet name="header">
                <h:outputText value="Notification" />
            </f:facet>

            <richext:spacer height="3"/>
            <h:outputText value="Update site request submitted successfully"/>
            <richext:spacer height="15"/>
            <div style="text-align: center">
                <p:commandButton value="OK" action="SearchAndUpdate" onclick="requesterUpdateNotifier.hide();" ajax="false"/>
            </div>

        </p:dialog>
    </h:form>


</ui:composition>