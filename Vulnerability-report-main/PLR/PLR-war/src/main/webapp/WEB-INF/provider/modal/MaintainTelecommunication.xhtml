<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    >

    <p:dialog id="maintainTelecomDialog" 
              header="#{maintainTelephoneManager.telephoneDto.new ? 'Add' : 'Update'} Telecommunication" 
              widgetVar="maintainTelecomModal" modal="true" draggable="false" 
              closeOnEscape="true" resizable="false" fitViewport="true" width="245" height="525">
        <h:form id="maintainTelecomForm">
		
			<p:messages id="messages" showDetail="false" closable="true" >
				<p:autoUpdate disabled="false"/>
			</p:messages>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Type"/>
                <ui:param name="for" value="telecomType"/>
            </ui:include>
            <!-- Note: Template not used at telecom type location for the dynamic dropdown lists; 
            customized component for dropdown selections used to allow ajax calls -->
            <p:selectOneMenu id="telecomType" rendered="#{maintainTelephoneManager.telephoneDto.new}" value="#{maintainTelephoneManager.telephoneDto.typeId}" required="true" >
                <f:selectItems value="#{Droplists.prsCtTelecomNumberTypes}" />
                <p:ajax listener="#{maintainTelephoneManager.telecomTypeCodeChanged(maintainTelephoneManager.telephoneDto.typeId)}" update="telecomPurpose, telecomPurposeFiltered"/>
            </p:selectOneMenu>
            <h:outputText rendered="#{!maintainTelephoneManager.telephoneDto.new}" value="#{selectValueFinder.getLabel(Droplists.prsCtTelecomNumberTypes, maintainTelephoneManager.telephoneDto.typeId)}" style="font-weight: bold;"/>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Purpose"/>
                <ui:param name="for" value="telecomPurpose" id="forTelecomPurpose" rendered="#{not maintainTelephoneManager.isWorkLocTelecom}"/>
                <ui:param name="for" value="telecomPurposeFiltered" id="forTelecomPurposeFiltered" rendered="#{maintainTelephoneManager.isWorkLocTelecom}"/>
            </ui:include>
            <!-- Note: Template not used at this location for the dynamic dropdown lists; 
            customized component for dropdown selections used to allow ajax calls -->
            <p:selectOneMenu rendered="#{(maintainTelephoneManager.telephoneDto.new and not maintainTelephoneManager.isWorkLocTelecom) and (maintainTelephoneManager.providerDetails.providerType != 'ORGANIZATION')}" id="telecomPurpose" value="#{maintainTelephoneManager.telephoneDto.communicationPurposeId}" required="true" >
                <f:selectItems value="#{maintainTelephoneManager.prsCtTelecomPurposeCdByTelecomTypeSelectItems}" />
            </p:selectOneMenu>
            <p:selectOneMenu rendered="#{(maintainTelephoneManager.telephoneDto.new and maintainTelephoneManager.providerDetails.providerType == 'ORGANIZATION') or (maintainTelephoneManager.telephoneDto.new and maintainTelephoneManager.isWorkLocTelecom)}" id="telecomPurposeFiltered" value="#{maintainTelephoneManager.telephoneDto.communicationPurposeId}" required="true" >
                <f:selectItems value="#{Droplists.prsCtCommunPurposeTypesFilterByEc}"/>
            </p:selectOneMenu>
            <h:outputText rendered="#{!maintainTelephoneManager.telephoneDto.new}" value="#{selectValueFinder.getLabel(Droplists.prsCtCommunPurposeTypes, maintainTelephoneManager.telephoneDto.communicationPurposeId)}" style="font-weight: bold;"/>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Area Code"/>
                <ui:param name="for" value="AreaCode"/>
                <ui:param name="tip" value="Area Code must only contain spaces, -, and numbers."/>
            </ui:include>
            <p:inputText id="AreaCode" value="#{maintainTelephoneManager.telephoneDto.areaCode}" size="5" required="true" styleClass="zeroMargin"/>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Phone Number"/>
                <ui:param name="for" value="Phone_Number"/>
                <ui:param name="tip" value="Phone Number must only contain spaces, -, and numbers."/>
            </ui:include>
            <p:inputText id="Phone_Number" value="#{maintainTelephoneManager.telephoneDto.number}" required="true" styleClass="zeroMargin"/>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Extension"/>
                <ui:param name="for" value="extension"/>
                <ui:param name="tip" value="Extension Code must only contain spaces, -, and numbers."/>
            </ui:include>
            <p:inputText id="extension" value="#{maintainTelephoneManager.telephoneDto.extension}" styleClass="zeroMargin"/>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="End Reason"/>
                <ui:param name="for" value="EndReasonType"/>
                <ui:param name="rendered" value="#{!maintainTelephoneManager.telephoneDto.new}"/>
            </ui:include>
            <p:selectOneMenu id="EndReasonType" rendered="#{!maintainTelephoneManager.telephoneDto.new}" value="#{maintainTelephoneManager.telephoneDto.endReasonCodeId}" required="true" >
                <f:selectItems value="#{Droplists.grsCtEndReasonTypes}" />
            </p:selectOneMenu>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Effective From"/>
                <ui:param name="for" value="effectiveFromDate"/>
            </ui:include>
            <p:calendar id="effectiveFromDate" value="#{maintainTelephoneManager.telephoneDto.effectiveStartDate}" required="true" showOn="button" navigator="true" size="11" pattern="dd-MMM-yyyy" />
            <p:watermark value="1980-06-30" for="effectiveFromDate"/>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Effective To"/>
                <ui:param name="for" value="effectiveToDate"/>
            </ui:include>
            <p:calendar id="effectiveToDate" value="#{maintainTelephoneManager.telephoneDto.effectiveEndDate}" required="false" showOn="button" navigator="true" size="11" pattern="dd-MMM-yyyy" />
            <p:watermark value="1980-06-30" for="effectiveToDate"/>


            <div class="formControls">
                <p:commandButton id="idTeleSubmitButton" value="#{maintainTelephoneManager.telephoneDto.new ? 'Create' : 'Update'}" actionListener="#{maintainTelephoneManager.save(true)}" oncomplete="if (args &amp;&amp; !args.validationFailed) PF('maintainTelecomModal').hide();return false;" update=":maintainTelecomForm,  #{maintainTelephoneManager.panelToUpdate}" />
                <p:ajaxStatus style="display:inline-block">
                    <f:facet name="start"><h:graphicImage value="/resources/Spinner.gif"/></f:facet>
                    <f:facet name="complete"><h:outputText value="" /></f:facet>                     
                </p:ajaxStatus>    
                <a href="#" onclick="PF('maintainTelecomModal').hide();
                        return false;">Cancel</a>
            </div>
        </h:form>
    </p:dialog>
</ui:composition>