<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    >

    <p:dialog id="maintainCredentialDialog" 
              header="#{maintainCredentialsManager.credentialsDto.new ? 'Add' : 'Update'} Credential" 
              widgetVar="maintainCredentialModal" modal="true" draggable="false"
              closeOnEscape="true" resizable="true" fitViewport="true" height="745">
        <h:form id="maintainCredentialForm">
		
			<p:messages id="messages" showDetail="false" closable="true" >
				<p:autoUpdate disabled="false"/>
			</p:messages>
            
            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Credential Type"/>
                <ui:param name="for" value="credentialType"/>
            </ui:include>
            <ui:include src="/WEB-INF/fragments/type.xhtml">
                <ui:param name="isNew" value="#{maintainCredentialsManager.credentialsDto.new}"/>
                <ui:param name="id" value="credentialType"/>
                <ui:param name="value" value="#{maintainCredentialsManager.credentialsDto.typeId}"/>
                <ui:param name="selectValues" value="#{maintainCredentialsManager.credentialTypeSelectItems}"/>
            </ui:include> 
            
            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Designation"/>
                <ui:param name="for" value="designation"/>
                <ui:param name="tip" value="A text description of the degree or educational rank that the credential specifies, e.g., BSc, MD, BScN"/>
            </ui:include>
            <p:inputText id="designation" value="#{maintainCredentialsManager.credentialsDto.designation}" required="true" size="35" styleClass="zeroMargin"/>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Registration Number"/>
                <ui:param name="for" value="regNo"/>
                <ui:param name="tip" value="A number identifying the credential."/>
            </ui:include>
            <p:inputText id="regNo" value="#{maintainCredentialsManager.credentialsDto.registrationNumber}" size="35" styleClass="zeroMargin"/>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Institution"/>
                <ui:param name="for" value="institution"/>
            </ui:include>
            <p:autoComplete id="institution" value="#{maintainCredentialsManager.credentialsDto.grantingInstitution}" completeMethod="#{maintainCredentialsManager.suggestCredentialInstitutionName}" effect="fade" />

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="City"/>
                <ui:param name="for" value="cityCred"/>
            </ui:include>
            <p:autoComplete id="cityCred" value="#{maintainCredentialsManager.credentialsDto.institutionCity}" completeMethod="#{maintainCredentialsManager.suggestCredentialCityName}" effect="fade" />

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Country"/>
                <ui:param name="for" value="countryCred"/>
            </ui:include>
            <p:selectOneMenu id="countryCred" value="#{maintainCredentialsManager.credentialsDto.institutionCountryId}">
                <f:selectItem itemLabel="Select One" itemValue=""/>
                <f:selectItems value="#{addressSupportManager.countrySelectItemsOrderedByName}"/>
                <p:ajax listener="#{maintainCredentialsManager.countryChanged()}" update="provinceCred"/>
                <p:ajax listener="#{addressSupportManager.countryChangedGroup1(maintainCredentialsManager.credentialsDto.institutionCountryId)}" update="provinceCred"/>
            </p:selectOneMenu>
            
            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Province / State"/>
                <ui:param name="for" value="provinceCred"/>
            </ui:include>
            <p:selectOneMenu id="provinceCred" value="#{maintainCredentialsManager.credentialsDto.institutionProvStateId}" disabled="#{empty addressSupportManager.provinceSelectItemsGroup1}">
                <f:selectItem itemLabel="Select One" itemValue=""/>
                <f:selectItems value="#{addressSupportManager.provinceSelectItemsGroup1}"/>
                <p:ajax listener="#{maintainCredentialsManager.provinceChanged()}" />
            </p:selectOneMenu>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Equivalency"/>
                <ui:param name="for" value="equivalencyFlag"/>
                <ui:param name="tip" value="Select to indicate that a credential was granted based on equivalency rather than by an officially recognized institution (i.e. as a result of experience)."/>
            </ui:include>
            <p:selectBooleanCheckbox id="equivalencyFlag" value="#{maintainCredentialsManager.credentialsDto.equivalencyFlag}"/>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Year"/>
                <ui:param name="for" value="yearIssued"/>
                <ui:param name="tip" value="The year the credential was conferred."/>
            </ui:include>
            <p:inputText id="yearIssued" value="#{maintainCredentialsManager.credentialsDto.yearIssued}" styleClass="zeroMargin"/>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="End Reason"/>
                <ui:param name="for" value="endReasonCode"/>
                <ui:param name="rendered" value="#{!maintainCredentialsManager.credentialsDto.new}"/>
            </ui:include>
            <p:selectOneMenu id="endReasonCode" rendered ="#{!maintainCredentialsManager.credentialsDto.new}" value="#{maintainCredentialsManager.credentialsDto.endReasonCodeId}" required="true">
                <f:selectItems value="#{Droplists.grsCtEndReasonTypes}" />
            </p:selectOneMenu>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Effective From"/>
                <ui:param name="for" value="effectiveStartDateCred"/>
            </ui:include>
            <p:calendar id="effectiveStartDateCred" value="#{maintainCredentialsManager.credentialsDto.effectiveStartDate}"
                        required="true" showOn="button" navigator="true" size="11"/>
            <p:watermark value="1980-06-30" for="effectiveStartDateCred"/>
            
            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Effective To"/>
                <ui:param name="for" value="effectiveEndDate"/>
            </ui:include>
            <p:calendar id="effectiveEndDate" value="#{maintainCredentialsManager.credentialsDto.effectiveEndDate}"
                        showOn="button" navigator="true" size="11"/>
            <p:watermark value="1980-06-30" for="effectiveEndDate"/>

            <div class="formControls">
                <p:commandButton id="idCredentialSubmitButton" value="#{maintainCredentialsManager.credentialsDto.new ? 'Create' : 'Update'}" actionListener="#{maintainCredentialsManager.save(true)}" oncomplete="if (args &amp;&amp; !args.validationFailed) PF('maintainCredentialModal').hide()" update=":maintainCredentialForm, :credentialsPanel, :modalMessages" />
                <p:ajaxStatus style="display:inline-block">
                    <f:facet name="start"><h:graphicImage value="/resources/Spinner.gif"/></f:facet>
                    <f:facet name="complete"><h:outputText value="" /></f:facet>                     
                </p:ajaxStatus>    
                <a href="#" onclick="PF('maintainCredentialModal').hide();
                        return false;">Cancel</a>
            </div>
        </h:form>
    </p:dialog> 

</ui:composition>