<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:custom="http://java.sun.com/jsf/composite/custom">

    <p:panel id="informationRoutesPanel" header="Communication Preference" >
        <h:panelGrid styleClass="recordDetailsPanels">
            <ui:include src="/WEB-INF/fragments/noresult.xhtml">
                <ui:param name="text" value="communication preference"/>
                <ui:param name="field" value="informationRoutes"/>
                <ui:param name="records" value="#{viewProviderManager.providerDetails.informationRoutes}"/>
                <ui:param name="result" value="#{viewProviderManager.providerDetails}"/>
            </ui:include>

            <ui:repeat var="informationRoute" value="#{viewProviderManager.providerDetails.informationRoutes}">
                <p:panel id="informationRoutePanel" header="(#{informationRoute.documentTypeCode}) (#{informationRoute.dataOwnerCode})" toggleTitle="Expand/Collapse" toggleable="true" collapsed="#{viewProviderManager.collapsed}">
                    <h:panelGrid columns="2" cellpadding="2">
                        <h:outputLabel value="Work Location Identifier:"/><h:outputText value="#{informationRoute.workLocationIdentifier}"/>
                        <h:outputLabel value="Content Type:"/><h:outputText value="#{informationRoute.documentType} (#{informationRoute.documentTypeCode})"/>
                        <h:outputLabel value="Address Type:"/><h:outputText value="#{informationRoute.addressDto.type} (#{informationRoute.addressDto.typeCode})"/>
                        <h:outputLabel value="Telecommunication Number Type:"/><h:outputText value="#{informationRoute.telecommunicationDto.type} (#{informationRoute.telecommunicationDto.typeCode})"/>
                        <h:outputLabel value="Electronic Address Type:"/><h:outputText value="#{informationRoute.electronicAddressDto.type} (#{informationRoute.electronicAddressDto.typeCode})"/>
                        <h:outputLabel value="Communication Purpose:"/><h:outputText value="#{informationRoute.communicationPurpose} (#{informationRoute.communicationPurposeCode})"/>
                        <h:outputLabel value="Communication Data Owner Code:"/><h:outputText value="#{informationRoute.communicationDataOwnerCode}"/>
                        <h:outputLabel value="Effective From:"/><h:outputText value="#{jsfUtils.formatDate(informationRoute.effectiveStartDate)}"/>
                        <h:outputLabel value="Effective To:"/><h:outputText value="#{jsfUtils.formatDate(informationRoute.effectiveEndDate)}"/>
                        <h:outputLabel value="End Reason:"/><h:outputText value="#{informationRoute.endReasonCode}"/>
                        <h:outputLabel value="Data Source:"/><h:outputText value="#{informationRoute.userChid}"/>
                        <h:outputLabel value="DB Created:"/><h:outputText value="#{jsfUtils.formatDate(informationRoute.createdDate)}"/>
                        <h:outputLabel value="DB Expired:"/><h:outputText value="#{jsfUtils.formatDate(informationRoute.invalidatedDate)}"/>
                        <h:outputLabel value="Data Owner Code:"/><h:outputText value="#{informationRoute.dataOwnerCode}"/>
                    </h:panelGrid>

                    <f:facet name="actions" >
                        <h:panelGroup styleClass="rightAlign">
                            <custom:activeIcon rendered="#{informationRoute.displayActive}" />
                            <p:commandLink  id="updateInformationRouteLink" rendered="#{informationRoute.updatable and not viewProviderManager.userRoleService.consumer}" oncomplete="PF('maintainInfoRouteModal').show()" update=":maintainInfoRouteDialog">
                                <custom:updateIcon title="Update #{informationRoute.type}" />
                                <f:setPropertyActionListener value="#{informationRoute}" target="#{maintainInformationRouteManager.dto}" />
                                <f:setPropertyActionListener value="#{viewProviderManager.providerDetailsCopy}" target="#{maintainInformationRouteManager.providerDetails}"/>
                                <f:setPropertyActionListener value=":informationRoutesPanel" target="#{maintainInformationRouteManager.panelToUpdate}" /> 
                                <p:resetInput target=":maintainInfoRouteForm" />
                            </p:commandLink>
                        </h:panelGroup>
                    </f:facet>
                </p:panel>
            </ui:repeat>
        </h:panelGrid>        
        <f:facet name="actions" >
            <p:commandLink id="irAdd" process="@this" actionListener="#{maintainInformationRouteManager.resetDto()}" update=":maintainInfoRouteDialog" oncomplete="PF('maintainInfoRouteModal').show()" rendered="#{not viewProviderManager.userRoleService.consumer}">
                <custom:addIcon title="Add a new Communication Preference" />
                <f:setPropertyActionListener value="#{viewProviderManager.providerDetailsCopy}" target="#{maintainInformationRouteManager.providerDetails}"/>
                <f:setPropertyActionListener value=":informationRoutesPanel" target="#{maintainInformationRouteManager.panelToUpdate}" /> 
                <p:resetInput target=":maintainInfoRouteForm" />
            </p:commandLink>
        </f:facet>
    </p:panel>   


</ui:composition>