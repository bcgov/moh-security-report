<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    >
    <p:dialog id="maintainInfoRouteDialog" 
              header="#{maintainInformationRouteManager.dto.new ? 'Add' : 'Update'} Communication Preference" 
              widgetVar="maintainInfoRouteModal" modal="true" draggable="false" 
              closeOnEscape="true" resizable="false" fitViewport="true" height="450">
        <h:form id="maintainInfoRouteForm">
		
			<p:messages id="messages" showDetail="false" closable="true" >
				<p:autoUpdate disabled="false"/>
			</p:messages>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Content Type"/>
                <ui:param name="for" value="infoRDocType"/>
            </ui:include>
            <ui:include src="/WEB-INF/fragments/type.xhtml">
                <ui:param name="isNew" value="#{maintainInformationRouteManager.dto.new}"/>
                <ui:param name="id" value="infoRDocType"/>
                <ui:param name="value" value="#{maintainInformationRouteManager.dto.documentTypeId}"/>
                <ui:param name="selectValues" value="#{Droplists.grsCtDocumentTypes}"/>
            </ui:include> 
            
            <ui:fragment rendered="#{maintainInformationRouteManager.dto.new}">
                
                <ui:include src="/WEB-INF/fragments/label.xhtml">
                    <ui:param name="text" value="Mechanism Type"/>
                    <ui:param name="for" value="infoRMechanism"/>
                </ui:include>
            
                <p:selectOneMenu id="infoRMechanism" value="#{maintainInformationRouteManager.dto.mechanismTypeId}" required="true"
                                 rendered="#{maintainInformationRouteManager.dto.new}">
                    <f:selectItems value="#{Droplists.grsCtMechanisms}" />
                    <p:ajax update="infoRMechanismFragment, infoRWorkLocation" listener="#{maintainInformationRouteManager.handleMechanismChange}"/>
                </p:selectOneMenu>
                <h:outputText rendered="#{!maintainInformationRouteManager.dto.new}" style="font-weight: bold;"
                              value="#{selectValueFinder.getLabel(Droplists.grsCtMechanisms, maintainInformationRouteManager.dto.mechanismTypeId)}"/>

                <p:outputPanel id="infoRMechanismFragment">

                    <ui:fragment rendered="#{maintainInformationRouteManager.dto.mechanismTypeCode == 'COURIER'}">
                        <ui:include src="/WEB-INF/fragments/label.xhtml">
                            <ui:param name="text" value="Address"/>
                            <ui:param name="for" value="infoRAddress"/>
                        </ui:include>
                        <p:selectOneMenu id="infoRAddress" value="#{maintainInformationRouteManager.dto.addressDto.id}" required="true" >
                            <f:selectItem itemLabel="Select One" itemValue=""/>
                            <f:selectItems value="#{maintainInformationRouteManager.addressSelectItems}" />
                            <p:ajax update="infoRWorkLocation" listener="#{maintainInformationRouteManager.handleAddressChange()}"/>
                        </p:selectOneMenu>
                    </ui:fragment>

                    <ui:fragment rendered="#{maintainInformationRouteManager.dto.mechanismTypeCode == 'FAX'}">
                        <ui:include src="/WEB-INF/fragments/label.xhtml">
                            <ui:param name="text" value="Telecommunication"/>
                            <ui:param name="for" value="infoRTelecommunication"/>
                        </ui:include>
                        <p:selectOneMenu id="infoRTelecommunication" value="#{maintainInformationRouteManager.dto.telecommunicationDto.id}" required="true">
                            <f:selectItem itemLabel="Select One" itemValue=""/>
                            <f:selectItems value="#{maintainInformationRouteManager.telecommunicationSelectItems}" />
                            <p:ajax update="infoRWorkLocation" listener="#{maintainInformationRouteManager.handleTelecommunicationChange()}"/>
                        </p:selectOneMenu> 
                    </ui:fragment>

                    <ui:fragment rendered="#{maintainInformationRouteManager.dto.mechanismTypeCode == 'FILE'}">
                        <ui:include src="/WEB-INF/fragments/label.xhtml">
                            <ui:param name="text" value="Electronic Address"/>
                            <ui:param name="for" value="infoRElectronicAddress"/>
                        </ui:include>
                        <p:selectOneMenu id="infoRElectronicAddress" value="#{maintainInformationRouteManager.dto.electronicAddressDto.id}" required="true">
                            <f:selectItem itemLabel="Select One" itemValue=""/>
                            <f:selectItems value="#{maintainInformationRouteManager.electronicAddressSelectItems}" />
                            <p:ajax update="infoRWorkLocation" listener="#{maintainInformationRouteManager.handleElectronicAddressChange()}"/>
                        </p:selectOneMenu>
                    </ui:fragment>
                </p:outputPanel>        
            </ui:fragment>
            
            <ui:fragment rendered="#{!maintainInformationRouteManager.dto.new}">
                <p:outputPanel id="infoRMechanismFragmentForUpdate">

                    <ui:fragment rendered="#{maintainInformationRouteManager.dto.addressDto.id!=null}">
                        <ui:include src="/WEB-INF/fragments/label.xhtml">
                            <ui:param name="text" value="Address"/>
                            <ui:param name="for" value="infoRAddressForUpdate"/>
                        </ui:include>
                        <p:selectOneMenu id="infoRAddressForUpdate" value="#{maintainInformationRouteManager.dto.addressDto.id}" required="true" >
                            <f:selectItem itemLabel="Select One" itemValue=""/>
                            <f:selectItems value="#{maintainInformationRouteManager.addressSelectItems}" />
                            <p:ajax update="infoRWorkLocation" listener="#{maintainInformationRouteManager.handleAddressChange()}"/>
                        </p:selectOneMenu>
                    </ui:fragment>

                    <ui:fragment rendered="#{maintainInformationRouteManager.dto.telecommunicationDto.id!=null}">
                        <ui:include src="/WEB-INF/fragments/label.xhtml">
                            <ui:param name="text" value="Telecommunication"/>
                            <ui:param name="for" value="infoRTelecommunicationForUpdate"/>
                        </ui:include>
                        <p:selectOneMenu id="infoRTelecommunicationForUpdate" value="#{maintainInformationRouteManager.dto.telecommunicationDto.id}" required="true">
                            <f:selectItem itemLabel="Select One" itemValue=""/>
                            <f:selectItems value="#{maintainInformationRouteManager.telecommunicationSelectItems}" />
                            <p:ajax update="infoRWorkLocation" listener="#{maintainInformationRouteManager.handleTelecommunicationChange()}"/>
                        </p:selectOneMenu> 
                    </ui:fragment>

                    <ui:fragment rendered="#{maintainInformationRouteManager.dto.electronicAddressDto.id!=null}">
                        <ui:include src="/WEB-INF/fragments/label.xhtml">
                            <ui:param name="text" value="Electronic Address"/>
                            <ui:param name="for" value="infoRElectronicAddressForUpdate"/>
                        </ui:include>
                        <p:selectOneMenu id="infoRElectronicAddressForUpdate" value="#{maintainInformationRouteManager.dto.electronicAddressDto.id}" required="true">
                            <f:selectItem itemLabel="Select One" itemValue=""/>
                            <f:selectItems value="#{maintainInformationRouteManager.electronicAddressSelectItems}" />
                            <p:ajax update="infoRWorkLocation" listener="#{maintainInformationRouteManager.handleElectronicAddressChange()}"/>
                        </p:selectOneMenu>
                    </ui:fragment>
                </p:outputPanel>   
            </ui:fragment>
            

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Work Location"/>
                <ui:param name="for" value="infoRWorkLocation"/>
            </ui:include>
            <h:outputText id="infoRWorkLocation" value="#{maintainInformationRouteManager.dto.workLocationIdentifier != null ? maintainInformationRouteManager.dto.workLocationIdentifier : 'N/A'}"/>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="End Reason"/>
                <ui:param name="for" value="EndReasonType"/>
                <ui:param name="rendered" value="#{!maintainInformationRouteManager.dto.new}"/>
            </ui:include>
            <p:selectOneMenu id="EndReasonType" rendered="#{!maintainInformationRouteManager.dto.new}" value="#{maintainInformationRouteManager.dto.endReasonCodeId}" required="true" >
                <f:selectItems value="#{Droplists.grsCtEndReasonTypes}" />
            </p:selectOneMenu>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Effective From"/>
                <ui:param name="for" value="effectiveFromDate"/>
            </ui:include>
            <p:calendar id="effectiveFromDate" value="#{maintainInformationRouteManager.dto.effectiveStartDate}" required="true" showOn="button" navigator="true" size="11" pattern="dd-MMM-yyyy" />
            <p:watermark value="1980-06-30" for="effectiveFromDate"/>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Effective To"/>
                <ui:param name="for" value="effectiveToDate"/>
            </ui:include>
            <p:calendar id="effectiveToDate" value="#{maintainInformationRouteManager.dto.effectiveEndDate}" required="false" showOn="button" navigator="true" size="11" pattern="dd-MMM-yyyy" />
            <p:watermark value="1980-06-30" for="effectiveToDate"/>

            <div class="formControls">
                <p:commandButton id="idInfoRouteSubmitButton" 
                                 value="#{maintainInformationRouteManager.dto.new ? 'Create' : 'Update'}" 
                                 actionListener="#{maintainInformationRouteManager.save()}" 
                                 oncomplete="if (args &amp;&amp; !args.validationFailed) PF('maintainInfoRouteModal').hide();return false;" 
                                 update=":maintainInfoRouteForm, #{maintainInformationRouteManager.panelToUpdate}" />
                <p:ajaxStatus style="display:inline-block">
                    <f:facet name="start"><h:graphicImage value="/resources/Spinner.gif"/></f:facet>
                    <f:facet name="complete"><h:outputText value="" /></f:facet>                     
                </p:ajaxStatus>
                <a href="#" onclick="PF('maintainInfoRouteModal').hide();
                        return false;">Cancel</a>
            </div>
        </h:form>
    </p:dialog>
</ui:composition>