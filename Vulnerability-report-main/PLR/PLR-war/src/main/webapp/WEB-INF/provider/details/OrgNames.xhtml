<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:custom="http://java.sun.com/jsf/composite/custom"
    >
    <p:panel id="nameOrgPanel" header="Names" >
        <h:panelGrid styleClass="recordDetailsPanels">
            <ui:include src="/WEB-INF/fragments/noresult.xhtml">
                <ui:param name="text" value="names"/>
                <ui:param name="field" value="orgNames"/>
                <ui:param name="records" value="#{viewProviderManager.providerDetails.orgNames}"/>
                <ui:param name="result" value="#{viewProviderManager.providerDetails}"/>
            </ui:include>

            <ui:repeat var="name" value="#{viewProviderManager.providerDetails.orgNames}">
                <p:panel id="orgNamePanel" header="#{name.name} (#{name.typeCode}) (#{name.dataOwnerCode})" toggleTitle="Expand/Collapse" toggleable="true" collapsed="#{viewProviderManager.collapsed}" styleClass="ui-subpanel" >
                    <h:panelGrid columns="2" cellpadding="2">
                        <h:outputLabel value="Name Type:"/><h:outputText value="#{name.type} (#{name.typeCode})" rendered="#{!viewProviderManager.providerDetails.confidential}"/><h:outputText value=" " rendered="#{viewProviderManager.providerDetails.confidential}"/>
                        <h:outputLabel value="Preferred:"/><h:outputText value="#{name.preferred ? 'Yes' : 'No'}"/>
                        <h:outputLabel value="Name:"/><h:outputText value="#{name.name}" style="white-space: pre-wrap;word-break: break-all"/>
                        <h:outputLabel value="Description:"/><h:outputText value="#{name.longName}" style="white-space: pre-wrap;word-break: break-all"/>
                        <h:outputLabel value="Effective From:"/><h:outputText value="#{jsfUtils.formatDate(name.effectiveStartDate)}"/>
                        <h:outputLabel value="Effective To:"/><h:outputText value="#{jsfUtils.formatDate(name.effectiveEndDate)}"/>
                        <h:outputLabel value="End Reason:"/><h:outputText value="#{name.endReasonCode}"/>
                        <h:outputLabel value="Data Source:"/><h:outputText value="#{name.userChid}"/>
                        <h:outputLabel value="DB Created:"/><h:outputText value="#{jsfUtils.formatDate(name.createdDate)}"/>
                        <h:outputLabel value="DB Expired:"/><h:outputText value="#{jsfUtils.formatDate(name.invalidatedDate)}"/>
                        <h:outputLabel value="Data Owner Code:"/><h:outputText value="#{name.dataOwnerCode}"/>
                    </h:panelGrid>

                    <f:facet name="actions" >
                        <h:panelGroup styleClass="rightAlign">
                            <custom:activeIcon rendered="#{name.displayActive}" />
                            <p:commandLink id="updateNameLink" 
                                           rendered="#{name.updatable and not viewProviderManager.userRoleService.consumer}" 
                                           oncomplete="PF('maintainOrgNameModal').show()" 
                                           update=":maintainOrgNameDialog" 
                                           styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default">
                                <custom:updateIcon title="Update #{name.name}" />
                                <f:setPropertyActionListener value="#{viewProviderManager.providerDetailsCopy}" target="#{maintainOrgNameManager.providerDetails}" />
                                <f:setPropertyActionListener value="#{name}" target="#{maintainOrgNameManager.dto}" />
                                <p:resetInput target=":maintainOrgNameForm" />
                            </p:commandLink>
                        </h:panelGroup>
                    </f:facet>
                </p:panel>
            </ui:repeat>
        </h:panelGrid>

        <f:facet name="actions" >
            <p:commandLink  process="@this" 
                            actionListener="#{maintainOrgNameManager.resetDto()}" 
                            update=":maintainOrgNameDialog" 
                            oncomplete="PF('maintainOrgNameModal').show()"
                            styleClass="ui-action"
                            rendered="#{not viewProviderManager.userRoleService.consumer}">
                <custom:addIcon title="Add a new Organizational Name" />
                <f:setPropertyActionListener value="#{viewProviderManager.providerDetailsCopy}" target="#{maintainOrgNameManager.providerDetails}" />
                <p:resetInput target=":maintainOrgNameForm" />
            </p:commandLink>
        </f:facet>
    </p:panel>
</ui:composition>