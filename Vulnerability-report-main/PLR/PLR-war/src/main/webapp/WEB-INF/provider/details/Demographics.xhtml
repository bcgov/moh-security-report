<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:custom="http://java.sun.com/jsf/composite/custom">
    <p:panel id="demographicDetailsPanel" header="Demographics" >
        <h:panelGrid styleClass="recordDetailsPanels">
            <ui:include src="/WEB-INF/fragments/noresult.xhtml">
                <ui:param name="text" value="demographic details"/>
                <ui:param name="field" value="demographicDetails"/>
                <ui:param name="records" value="#{viewProviderManager.providerDetails.demographicDetails}"/>
                <ui:param name="result" value="#{viewProviderManager.providerDetails}"/>
            </ui:include>
            <ui:repeat var="demographic" value="#{viewProviderManager.providerDetails.demographicDetails}">
                <p:panel id="demographicPanel" header="#{viewProviderManager.getDemographicHeader(demographic)} (#{demographic.dataOwnerCode})" toggleTitle="Expand/Collapse" toggleable="true" collapsed="#{viewProviderManager.collapsed}">
                    <h:panelGrid columns="2" cellpadding="2">

                        <h:outputLabel value="Birth Date:"/>
                        <ui:include src="/WEB-INF/fragments/value.xhtml">
                            <ui:param name="text" value="#{jsfUtils.formatDate(demographic.birthDate)}"/>
                            <ui:param name="field" value="birthDate"/>
                            <ui:param name="dataObject" value="#{demographic}"/>
                        </ui:include>

                        <h:outputLabel value="Death Date:"/>
                        <ui:include src="/WEB-INF/fragments/value.xhtml">
                            <ui:param name="text" value="#{jsfUtils.formatDate(demographic.deathDate)}"/>
                            <ui:param name="field" value="deathDate"/>
                            <ui:param name="dataObject" value="#{demographic}"/>
                        </ui:include>

                        <h:outputLabel value="Birth Country:"/>
                        <ui:include src="/WEB-INF/fragments/value.xhtml">
                            <ui:param name="text" value="#{demographic.birthCountry} (#{demographic.birthCountryCode})"/>
                            <ui:param name="field" value="birthCountry"/>
                            <ui:param name="dataObject" value="#{demographic}"/>
                        </ui:include>

                        <h:outputLabel value="Birth Prov/State:"/>
                        <ui:include src="/WEB-INF/fragments/value.xhtml">
                            <ui:param name="text" value="#{demographic.birthProvStateForDemographicsDisplay}" />
                            <ui:param name="field" value="birthProvState"/>
                            <ui:param name="dataObject" value="#{demographic}"/>
                        </ui:include>

                        <h:outputLabel value="Gender:"/>
                        <ui:include src="/WEB-INF/fragments/value.xhtml">
                            <ui:param name="text" value="#{demographic.gender} (#{demographic.genderCode})"/>
                            <ui:param name="field" value="gender"/>
                            <ui:param name="dataObject" value="#{demographic}"/>
                        </ui:include>
                        
                        <h:outputLabel value="Effective From:"/><h:outputText value="#{jsfUtils.formatDate(demographic.effectiveStartDate)}"/>
                        <h:outputLabel value="Effective To:"/><h:outputText value="#{jsfUtils.formatDate(demographic.effectiveEndDate)}"/>
                        <h:outputLabel value="End Reason:"/><h:outputText value="#{demographic.endReasonCode}"/>
                        <h:outputLabel value="Data Source:"/><h:outputText value="#{demographic.userChid}"/>
                        <h:outputLabel value="DB Created:"/><h:outputText value="#{jsfUtils.formatDate(demographic.createdDate)}"/>
                        <h:outputLabel value="DB Expired:"/><h:outputText value="#{jsfUtils.formatDate(demographic.invalidatedDate)}"/>
                        <h:outputLabel value="Data Owner Code:"/><h:outputText value="#{demographic.dataOwnerCode}"/>
                    </h:panelGrid>

                    <f:facet name="actions" >
                        <h:panelGroup styleClass="rightAlign">
                            <custom:activeIcon rendered="#{demographic.displayActive}" />
                            <p:commandLink id="updateDemogaphicsLink" rendered="#{demographic.updatable and not viewProviderManager.userRoleService.consumer}" oncomplete="PF('maintainDemographicDetailsModal').show()" update=":maintainDemographicDetailsDialog">
                                <custom:updateIcon title="Update Demographics" />
                                <f:setPropertyActionListener value="#{viewProviderManager.providerDetails.pauthId}" target="#{maintainDemographicDetailsManager.pauthId}" />
                                <f:setPropertyActionListener value="#{demographic}" target="#{maintainDemographicDetailsManager.demographicDetailsDto}" />
                                <f:setPropertyActionListener value="#{viewProviderManager.providerDetailsCopy.demographicDetails}" target="#{maintainDemographicDetailsManager.demographicDetails}" />
                                <p:resetInput target=":maintainDemographicDetailsForm" />
                            </p:commandLink>
                        </h:panelGroup>
                    </f:facet>                    

                </p:panel>
            </ui:repeat>
        </h:panelGrid>

        <f:facet name="actions" >
            <p:commandLink process="@this" actionListener="#{maintainDemographicDetailsManager.init}" update=":maintainDemographicDetailsDialog" oncomplete="PF('maintainDemographicDetailsModal').show()" rendered="#{not viewProviderManager.userRoleService.consumer}">
                <custom:addIcon title="Add a new Demographic Details" />
                <p:resetInput target=":maintainDemographicDetailsForm" />
                <f:setPropertyActionListener value="#{viewProviderManager.providerDetails.pauthId}" target="#{maintainDemographicDetailsManager.pauthId}" />
                <f:setPropertyActionListener value="#{viewProviderManager.providerDetailsCopy.demographicDetails}" target="#{maintainDemographicDetailsManager.demographicDetails}" />
            </p:commandLink>
        </f:facet>
    </p:panel>        

</ui:composition>