<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    >

    <p:dialog id="maintainStatusDialog" 
              header="#{maintainStatusManager.dto.new ? 'Add' : 'Update'} Status" 
              widgetVar="maintainStatusModal" modal="true" draggable="false" 
              closeOnEscape="true" resizable="false" fitViewport="true" width="375" height="410">
        <h:form id="maintainStatusForm">
		
			<p:messages id="messages" showDetail="false" closable="true" >
				<p:autoUpdate disabled="false"/>
			</p:messages>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Status Class Code"/>
                <ui:param name="for" value="statusClassCode"/>
            </ui:include>
            
            <h:outputText rendered="#{maintainStatusManager.dto.accessRestrictionData.unreadables.contains('classCode')}" value="No Permissions"/>
            <ui:include src="/WEB-INF/fragments/type.xhtml" 
                        rendered="#{!maintainStatusManager.dto.accessRestrictionData.unreadables.contains('classCode')}">
                <ui:param name="isNew" value="#{maintainStatusManager.dto.new}"/>
                <ui:param name="id" value="statusClassCode"/>
                <ui:param name="value" value="#{maintainStatusManager.dto.classCodeId}"/>
                <ui:param name="selectValues" value="#{Droplists.prsCtStatusClassCodes}"/>
            </ui:include> 
            
            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Status Code"/>
                <ui:param name="for" value="statusCode"/>
            </ui:include>
            <h:outputText rendered="#{maintainStatusManager.dto.accessRestrictionData.unreadables.contains('typeCode')}" value="No Permissions"/>
            <p:selectOneMenu id="statusCode" value="#{maintainStatusManager.dto.typeId}" required="true"
                             rendered="#{!maintainStatusManager.dto.accessRestrictionData.unreadables.contains('typeCode')}">
                <p:ajax listener="#{maintainStatusManager.statusCodeChanged}" update="statusReasonCode"/>
                <f:selectItems value="#{Droplists.prsCtStatusCodes}"/>
            </p:selectOneMenu>


            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Status Reason Code"/>
                <ui:param name="for" value="statusReasonCode"/>
            </ui:include>
            <h:outputText rendered="#{maintainStatusManager.dto.accessRestrictionData.unreadables.contains('reasonCode')}" value="No Permissions"/>
            <p:selectOneMenu id="statusReasonCode" value="#{maintainStatusManager.dto.reasonCodeId}" required="true"
                             rendered="#{!maintainStatusManager.dto.accessRestrictionData.unreadables.contains('reasonCode')}">
                <f:selectItems value="#{maintainStatusManager.statusReasonCodeSelectItems}"/>
            </p:selectOneMenu>

             <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="End Reason"/>
                <ui:param name="for" value="endReasonCode"/>
                <ui:param name="rendered" value="#{!maintainStatusManager.dto.new}"/>
            </ui:include>
            <p:selectOneMenu id="endReasonCode" rendered ="#{!maintainStatusManager.dto.new}" value="#{maintainStatusManager.dto.endReasonCodeId}" required="true">
                <f:selectItems value="#{maintainStatusManager.endReasonCodeSelectItems}" />
            </p:selectOneMenu>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Effective From"/>
                <ui:param name="for" value="effectiveFromDate"/>
            </ui:include>
            <p:calendar id="effectiveFromDate" value="#{maintainStatusManager.dto.effectiveStartDate}" required="true" showOn="button" navigator="true" size="11"/>
            <p:watermark value="1980-06-30" for="effectiveFromDate"/>

            <ui:include src="/WEB-INF/fragments/label.xhtml">
                <ui:param name="text" value="Effective To"/>
                <ui:param name="for" value="effectiveToDate"/>
            </ui:include>
            <p:calendar id="effectiveToDate" value="#{maintainStatusManager.dto.effectiveEndDate}" showOn="button" navigator="true" size="11"/>
            <p:watermark value="1980-06-30" for="effectiveToDate"/>

            <div class="formControls">
                <p:commandButton id="idStatusSubmitButton" value="#{maintainStatusManager.dto.new ? 'Create' : 'Update'}" actionListener="#{maintainStatusManager.save}" oncomplete="if (args &amp;&amp; !args.validationFailed) PF('maintainStatusModal').hide()" update=":maintainStatusForm, :statusesPanel, :modalMessages, :headerGroup" />
                <p:ajaxStatus style="display:inline-block">
                    <f:facet name="start"><h:graphicImage value="/resources/Spinner.gif"/></f:facet>
                    <f:facet name="complete"><h:outputText value="" /></f:facet>                     
                </p:ajaxStatus>    
                <a href="#" onclick="PF('maintainStatusModal').hide();
                        return false;">Cancel</a>
            </div>
        </h:form>
    </p:dialog>          

</ui:composition>