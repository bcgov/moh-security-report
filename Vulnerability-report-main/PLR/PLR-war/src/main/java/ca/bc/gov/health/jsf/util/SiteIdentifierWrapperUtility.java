/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.health.jsf.util;

import ca.bc.gov.health.plr.ejb.entity.DsrDeliverySiteIdentifiers;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.List;

/**
 *
 * @author adebiyi.kuseju
 */
public class SiteIdentifierWrapperUtility {
    
    // Wrap all the DsrDeliverySiteIdentifier in the list excluding the main active identifer
    public static List<SiteIdentifierWrapper> createDsIdWrapperList(List<DsrDeliverySiteIdentifiers> dsIdList) {
        List<SiteIdentifierWrapper> wrappers = new ArrayList<>(dsIdList.size());
        List<String> identifier =  new ArrayList<String>(); 
        for (int i = 0; i < dsIdList.size(); i++) {
            if (
                   (dsIdList.get(i).getSourceSystemCd().getSourceSystemCd().equals("DSR") || dsIdList.get(i).getActiveYn().equals("Y")) 
                    && !identifier.contains(dsIdList.get(i).getIdentifierNo())
                ) {
                identifier.add( dsIdList.get(i).getIdentifierNo());
                wrappers.add(createDsIdWrapper(dsIdList.get(i), wrappers.size()));
            }
        }
        Collections.sort(dsIdList, new Comparator<DsrDeliverySiteIdentifiers>(){

            @Override
            public int compare(DsrDeliverySiteIdentifiers o1, DsrDeliverySiteIdentifiers o2) {
                int result = 0;
                try{
                result = o1.getSourceSystemCd().getSourceSystemCd().compareTo(o2.getSourceSystemCd().getSourceSystemCd());
                if (result == 0){
                    result = o1.getIdentifierNo().compareTo(o2.getIdentifierNo());
                }
                }catch(Exception e){
                    //ignore, return 0
                }
                return result;
            }
            
        });
        return wrappers;
    }

    private static SiteIdentifierWrapper createDsIdWrapper(DsrDeliverySiteIdentifiers dsId, int pos) {

        return new SiteIdentifierWrapper(dsId, pos, SiteIdentifierWrapper.Status.READ);
    }
}
