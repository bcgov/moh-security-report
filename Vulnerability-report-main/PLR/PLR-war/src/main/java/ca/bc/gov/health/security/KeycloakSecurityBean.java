package ca.bc.gov.health.security;

import fish.payara.security.connectors.annotations.ClaimsDefinition;
import fish.payara.security.connectors.annotations.OpenIdAuthenticationDefinition;

@OpenIdAuthenticationDefinition(
        providerURI = "#{oidcConfig.providerUri}",
        clientId = "#{oidcConfig.clientId}",
        clientSecret = "#{oidcConfig.clientSecret}",
        redirectURI = "#{oidcConfig.redirectUri}",
        scope = "#{oidcConfig.scope}",
        claimsDefinition = @ClaimsDefinition(callerNameClaim = "#{oidcConfig.callerNameClaim}", callerGroupsClaim = "#{oidcConfig.callerGroupsClaim}"),
        /* Default jwksReadTimeout values can trigger com.nimbusds.jose.RemoteKeySourceException: Couldn't retrieve remote JWK set: Read timed out */
        jwksReadTimeout = 5000,
        /* extraParameters cannot reference CDI bean property unlike the other options above */
        extraParameters = {
            /* Comma separated list of which identity providers show up on the login page. By default all are shown. */
            "idps_to_show=idir,phsa"
        }
)
public class KeycloakSecurityBean {

}
