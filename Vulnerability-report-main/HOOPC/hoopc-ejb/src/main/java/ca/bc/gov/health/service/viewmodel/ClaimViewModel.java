package ca.bc.gov.health.service.viewmodel;

import ca.bc.gov.health.constants.GlobalConstants;
import static ca.bc.gov.health.constants.GlobalConstants.CLAIM_SOURCE_MANUAL;
import ca.bc.gov.health.database.entity.AdjustmentReasons;
import ca.bc.gov.health.database.entity.ClaimAdjustments;
import ca.bc.gov.health.database.entity.ClaimTypes;
import ca.bc.gov.health.database.entity.ResidencyTypes;
import java.io.Serializable;
import java.math.BigDecimal;
import java.time.LocalDate;
import java.util.ArrayList;
import java.util.List;
import org.apache.commons.lang3.StringUtils;

/** The Class ClaimViewModel. */
public class ClaimViewModel implements Serializable {

  private static final long serialVersionUID = 2028322158437167384L;

  private Long claimId;

  private LocalDate submissionDate;
  private LocalDate submissionDateFrom;
  private LocalDate submissionDateTo;

  private LocalDate processedDate;
  private LocalDate processedDateFrom;
  private LocalDate processedDateTo;

  private LocalDate serviceDate;

  // TODO: enum
  private ResidencyTypes residencyType;
  // TODO: enum
  private ClaimTypes claimType;
  private String statusCode;
  private String claimSource = CLAIM_SOURCE_MANUAL;

  // Claim fields
  private String treatingProvince;
  private String hospitalNumberAndName;
  private String hospitalClaimNumber;
  private String receivingProvince;
  private String provincialClaimId;
  private String reasonInBC;

  private PatientsViewModel patient;

  private String serviceCodeValue;
  private AdmissionsViewModel admission;
  private BigDecimal totalAmountClaimed;

  private String icdCodingScheme;

  private String accidentCode;
  private String accidentIndicator;

  private String[] diagnosisCodes = new String[] {"", "", ""};

  private String[] procedureCodes = new String[] {"", "", ""};

  private HighcostViewModel[] highCostProcedures =
      new HighcostViewModel[] {
        new HighcostViewModel(), new HighcostViewModel(), new HighcostViewModel()
      };

  private String hospitalNotes;
  private String reviewNotes;
  private String reviewFlag;

  private ClaimAdjustments claimAdjustmentsRequest =
      new ClaimAdjustments(GlobalConstants.CLAIM_ADJ_REQ_TYPE);
  private AdjustmentReasons[] adjRequestReasons =
      new AdjustmentReasons[] {
        new AdjustmentReasons(null, 1, null, null), new AdjustmentReasons(null, 2, null, null)
      };

  private ClaimAdjustments claimAdjustmentsDecision =
      new ClaimAdjustments(GlobalConstants.CLAIM_ADJ_DEC_TYPE);
  private AdjustmentReasons[] adjDecisionReasons =
      new AdjustmentReasons[] {
        new AdjustmentReasons(null, 1, null, null), new AdjustmentReasons(null, 2, null, null)
      };
  private List<String> validationErrors = new ArrayList<>();

  private ClaimOverridesViewModel claimOverride;

  private String billingPeriod;

  // to be able to run monthend staging we need those
  private String importFileName;
  private int importRowNum;
  private String userId;

  /** Instantiates a new claim view model. */
  public ClaimViewModel() {
    // Do nothing because nothing to construct
  }

  public Long getClaimId() {
    return claimId;
  }

  public void setClaimId(Long claimId) {
    this.claimId = claimId;
  }

  public LocalDate getSubmissionDate() {
    return submissionDate;
  }

  public void setSubmissionDate(LocalDate submissionDate) {
    this.submissionDate = submissionDate;
  }

  public LocalDate getSubmissionDateFrom() {
    return submissionDateFrom;
  }

  public void setSubmissionDateFrom(LocalDate submissionDateFrom) {
    this.submissionDateFrom = submissionDateFrom;
  }

  public LocalDate getSubmissionDateTo() {
    return submissionDateTo;
  }

  public void setSubmissionDateTo(LocalDate submissionDateTo) {
    this.submissionDateTo = submissionDateTo;
  }

  public LocalDate getProcessedDate() {
    return processedDate;
  }

  public void setProcessedDate(LocalDate processedDate) {
    this.processedDate = processedDate;
  }

  public LocalDate getProcessedDateFrom() {
    return processedDateFrom;
  }

  public void setProcessedDateFrom(LocalDate processedDateFrom) {
    this.processedDateFrom = processedDateFrom;
  }

  public LocalDate getProcessedDateTo() {
    return processedDateTo;
  }

  public void setProcessedDateTo(LocalDate processedDateTo) {
    this.processedDateTo = processedDateTo;
  }

  public LocalDate getServiceDate() {
    return serviceDate;
  }

  public void setServiceDate(LocalDate serviceDate) {
    this.serviceDate = serviceDate;
  }

  public ClaimOverridesViewModel getClaimOverride() {
    return claimOverride;
  }

  public void setClaimOverride(ClaimOverridesViewModel claimOverride) {
    this.claimOverride = claimOverride;
  }

  public ResidencyTypes getResidencyType() {
    return residencyType;
  }

  public void setResidencyType(ResidencyTypes residencyType) {
    this.residencyType = residencyType;
  }

  public ClaimTypes getClaimType() {
    return claimType;
  }

  public void setClaimType(ClaimTypes claimType) {
    this.claimType = claimType;
  }

  public String getStatusCode() {
    return statusCode;
  }

  public void setStatusCode(String claimStatusCode) {
    this.statusCode = claimStatusCode;
  }

  public String getClaimSource() {
    return claimSource;
  }

  public void setClaimSource(String claimSource) {
    this.claimSource = claimSource;
  }

  public String getProvincialClaimId() {
    return provincialClaimId;
  }

  public void setProvincialClaimId(String provincialClaimId) {
    this.provincialClaimId = provincialClaimId;
  }

  public String getHospitalClaimNumber() {
    return hospitalClaimNumber;
  }

  public void setHospitalClaimNumber(String hospitalClaimNumber) {
    this.hospitalClaimNumber = hospitalClaimNumber;
  }

  public String getReceivingProvince() {
    return receivingProvince;
  }

  public void setReceivingProvince(String receivingProvince) {
    this.receivingProvince = receivingProvince;
  }

  public PatientsViewModel getPatient() {
    return patient;
  }

  public void setPatient(PatientsViewModel patient) {
    this.patient = patient;
  }

  public String getServiceCodeValue() {
    return serviceCodeValue;
  }

  public void setServiceCodeValue(String serviceCodeValue) {
    this.serviceCodeValue = serviceCodeValue;
  }

  public AdmissionsViewModel getAdmission() {
    return admission;
  }

  public void setAdmission(AdmissionsViewModel admission) {
    this.admission = admission;
  }

  public BigDecimal getTotalAmountClaimed() {
    return totalAmountClaimed;
  }

  public void setTotalAmountClaimed(BigDecimal totalAmountClaimed) {
    this.totalAmountClaimed = totalAmountClaimed;
  }

  public String getIcdCodingScheme() {
    return icdCodingScheme;
  }

  public void setIcdCodingScheme(String icdCodingScheme) {
    this.icdCodingScheme = icdCodingScheme;
  }

  public String getAccidentCode() {
    return accidentCode;
  }

  // TODO: temp patch before codes refactoring.
  public String getAccidentCodeOnly() {
    if (!StringUtils.isBlank(accidentCode)) {
      return accidentCode.split("-")[0];
    }
    ;
    return accidentCode;
  }

  public void setAccidentCode(String accidentCode) {
    this.accidentCode = accidentCode;
  }

  public String getAccidentIndicator() {
    return accidentIndicator;
  }

  public void setAccidentIndicator(String accidentIndicator) {
    this.accidentIndicator = accidentIndicator;
  }

  public String[] getDiagnosisCodes() {
    return diagnosisCodes;
  }

  public void setDiagnosisCodes(String[] diagnosisCodes) {
    this.diagnosisCodes = diagnosisCodes;
  }

  public String[] getProcedureCodes() {
    return procedureCodes;
  }

  public void setProcedureCodes(String[] procedureCodes) {
    this.procedureCodes = procedureCodes;
  }

  public HighcostViewModel[] getHighCostProcedures() {
    return highCostProcedures;
  }

  public void setHighCostProcedures(HighcostViewModel[] highCostProcedures) {
    this.highCostProcedures = highCostProcedures;
  }

  public String getHospitalNotes() {
    return hospitalNotes;
  }

  public void setHospitalNotes(String hospitalNotes) {
    this.hospitalNotes = hospitalNotes;
  }

  public String getReviewNotes() {
    return reviewNotes;
  }

  public void setReviewNotes(String reviewNotes) {
    this.reviewNotes = reviewNotes;
  }

  public String getReviewFlag() {
    return reviewFlag;
  }

  public void setReviewFlag(String reviewFlag) {
    this.reviewFlag = reviewFlag;
  }

  public ClaimAdjustments getClaimAdjustmentsRequest() {
    return claimAdjustmentsRequest;
  }

  public void setClaimAdjustmentsRequest(ClaimAdjustments claimAdjustmentsRequest) {
    this.claimAdjustmentsRequest = claimAdjustmentsRequest;
  }

  public AdjustmentReasons[] getAdjRequestReasons() {
    return adjRequestReasons;
  }

  public void setAdjRequestReasons(AdjustmentReasons[] adjRequestReasons) {
    this.adjRequestReasons = adjRequestReasons;
  }

  public ClaimAdjustments getClaimAdjustmentsDecision() {
    return claimAdjustmentsDecision;
  }

  public void setClaimAdjustmentsDecision(ClaimAdjustments claimAdjustmentsDecision) {
    this.claimAdjustmentsDecision = claimAdjustmentsDecision;
  }

  public AdjustmentReasons[] getAdjDecisionReasons() {
    return adjDecisionReasons;
  }

  public void setAdjDecisionReasons(AdjustmentReasons[] adjDecisionReasons) {
    this.adjDecisionReasons = adjDecisionReasons;
  }

  public List<String> getValidationErrors() {
    return validationErrors;
  }

  public void setValidationErrors(List<String> validationErrors) {
    this.validationErrors = validationErrors;
  }

  public String getTreatingProvince() {
    return treatingProvince;
  }

  public void setTreatingProvince(String treatingProvince) {
    this.treatingProvince = treatingProvince;
  }

  public String getHospitalNumberAndName() {
    return hospitalNumberAndName;
  }

  public String getHospitalNumber() {
    if (!StringUtils.isBlank(hospitalNumberAndName)) {
      String[] split = hospitalNumberAndName.split("-", 2);
      if (split.length > 0) {
        return split[0];
      }
    }
    return null;
  }

  public String getHospitalName() {
    if (!StringUtils.isBlank(hospitalNumberAndName)) {
      String[] split = hospitalNumberAndName.split("-", 2);
      if (split.length > 1) {
        return split[1];
      }
    }
    return null;
  }

  public void setHospitalNumberAndName(String hospitalNumber) {
    this.hospitalNumberAndName = hospitalNumber;
  }

  /**
   * Sets the hospital number and name.
   *
   * @param hospitalNumber the hospital number
   * @param hospitalName the hospital name
   */
  public void setHospitalNumberAndName(String hospitalNumber, String hospitalName) {
    hospitalNumberAndName = hospitalNumber + "-" + hospitalName;
  }

  /**
   * Utility function used to get diagnosticCode1 if provided.
   *
   * @return null if any object in path is null
   */
  public String getMainDiagnosisCode() {
    try {
      return diagnosisCodes[0];
    } catch (NullPointerException | ArrayIndexOutOfBoundsException e) {
      // May be NullPointerException or ArrayIndexOutOfBoundsException
      return null;
    } catch (Exception e) {
      throw e;
    }
  }

  public String getReasonInBC() {
    return reasonInBC;
  }

  public void setReasonInBC(String reasonInBC) {
    this.reasonInBC = reasonInBC;
  }

  public String getBillingPeriod() {
    return billingPeriod;
  }

  public void setBillingPeriod(String billingPeriod) {
    this.billingPeriod = billingPeriod;
  }

  public String getImportFileName() {
    return importFileName;
  }

  public void setImportFileName(String importFileName) {
    this.importFileName = importFileName;
  }

  public int getImportRowNum() {
    return importRowNum;
  }

  public void setImportRowNum(int importRowNum) {
    this.importRowNum = importRowNum;
  }

  public String getUserId() {
    return userId;
  }

  public void setUserId(String userId) {
    this.userId = userId;
  }
}
