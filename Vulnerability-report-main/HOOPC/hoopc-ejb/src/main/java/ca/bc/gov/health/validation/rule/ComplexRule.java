package ca.bc.gov.health.validation.rule;

import ca.bc.gov.health.validation.ValidationError;
import java.util.function.Function;

/**
 * The Class ComplexRule.
 *
 * @param <T> the generic type
 */
public class ComplexRule<T> extends ValidationRule<T> {
  private Function<T, ValidationError> validatorFunction;

  /**
   * Instantiates a new complex rule.
   *
   * @param fieldName the field name
   * @param validatorFunction the validator function
   */
  public ComplexRule(String fieldName, Function<T, ValidationError> validatorFunction) {
    super(ValidationRuleType.COMPLEX, fieldName);
    this.validatorFunction = validatorFunction;
  }

  /* (non-Javadoc)
   * @see ca.bc.gov.health.validation.rule.ValidationRule#validate(java.lang.Object)
   */
  @Override
  public ValidationError validate(T object) {
    // Run the validator
    ValidationError error = validatorFunction.apply(object);
    if (error != null) {
      error.setRule(this); // TODO: refactor this
    }
    return error;
  }
}
