/*
 * To change this license header, choose License Headers in Project Properties. To change this
 * template file, choose Tools | Templates and open the template in the editor.
 */
package ca.bc.gov.health.database.ejb;

import ca.bc.gov.health.database.entity.ProvincesTerritories;
import ca.bc.gov.health.exception.HoopcException;
import jakarta.ejb.Stateless;
import jakarta.persistence.EntityManager;
import jakarta.persistence.PersistenceContext;
import jakarta.persistence.Query;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/**
 * The Class ProvincesTerritoriesFacade.
 *
 * @author je.tremblay
 */
@Stateless
public class ProvincesTerritoriesFacade extends AbstractFacade<ProvincesTerritories>
    implements ProvincesTerritoriesFacadeLocal {

  private static final Logger log = LoggerFactory.getLogger(AbstractFacade.class.getName());

  @PersistenceContext(unitName = "hoopc-ejb_pu")
  private EntityManager em;

  @Override
  protected EntityManager getEntityManager() {
    return em;
  }

  /** Instantiates a new provinces territories facade. */
  public ProvincesTerritoriesFacade() {
    super(ProvincesTerritories.class);
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * ca.bc.gov.health.database.ejb.ProvincesTerritoriesFacadeLocal#findByProvinceCode(java.lang.
   * String)
   */
  @Override
  public ProvincesTerritories findByProvinceCode(String provinceCode) throws HoopcException {
    try {
      Query query = em.createNamedQuery("ProvincesTerritories.findByProvinceCode");
      query.setParameter("provinceCode", provinceCode);

      return (ProvincesTerritories) query.getSingleResult();
    } catch (RuntimeException e) {
      HoopcException exception = new HoopcException("Error in AbstractFacade.remove()", e);
      log.error("Error in AbstractFacade.remove({})", exception);
      throw exception;
    }
  }
}
