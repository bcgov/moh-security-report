package ca.bc.gov.health.validation.codes;

import ca.bc.gov.health.database.entity.MainEntity;
import ca.bc.gov.health.service.HoopcAppService;
import ca.bc.gov.health.validation.ValidatorBase;
import ca.bc.gov.health.validation.rule.NotInRangeRule;
import ca.bc.gov.health.validation.rule.ValidationRule;
import jakarta.annotation.PostConstruct;
import jakarta.inject.Inject;
import jakarta.inject.Named;
import java.time.chrono.ChronoLocalDate;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import org.apache.commons.lang3.Range;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/** The Class RangeValidator. */
@Named("RangeValidator")
public class RangeValidator extends ValidatorBase<MainEntity> {

  private static Logger log = LoggerFactory.getLogger(RangeValidator.class);

  @Inject private HoopcAppService appService;

  /** Post construct. */
  @PostConstruct
  private void postConstruct() {
    log.info("RangeValidator");
  }

  /* (non-Javadoc)
   * @see ca.bc.gov.health.validation.ValidatorBase#getRules(java.lang.Object)
   */
  @Override
  public List<ValidationRule<MainEntity>> getRules(MainEntity entity) {
    List<ValidationRule<MainEntity>> rules = new ArrayList<>();

    rules.add(
        new NotInRangeRule<MainEntity, Set<Range<ChronoLocalDate>>>("Rates", entity.getRanges()));

    return rules;
  }

  public HoopcAppService getAppService() {
    return appService;
  }

  public void setAppService(HoopcAppService appService) {
    this.appService = appService;
  }
}
