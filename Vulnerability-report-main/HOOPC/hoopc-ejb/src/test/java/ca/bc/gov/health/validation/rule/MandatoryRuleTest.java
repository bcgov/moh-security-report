package ca.bc.gov.health.validation.rule;

import ca.bc.gov.health.validation.ValidationError;
import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertNull;
import org.junit.jupiter.api.Test;

public class MandatoryRuleTest {
  private static String FIELD_NAME = "FieldName";

  @Test
  public void mandatory_OK() {
    TestObject obj =
        new TestObject() {
          {
            setStringValue("OK");
          }
        };

    ValidationRule<TestObject> rule =
        new MandatoryRule<TestObject, String>(FIELD_NAME, o -> o.getStringValue());

    ValidationError error = rule.validate(obj);

    assertNull(error);
  }

  @Test
  public void mandatory_Error() {
    TestObject obj = new TestObject();

    ValidationRule<TestObject> rule =
        new MandatoryRule<TestObject, String>(FIELD_NAME, o -> o.getStringValue());

    ValidationError error = rule.validate(obj);

    assertNotNull(error);
    assertEquals(ValidationRuleType.MANDATORY_VALUE, error.getRule().getType());
    assertEquals(FIELD_NAME, error.getRule().getRuleIdentifier());
    assertNotNull(error.getMessage());
    assertEquals("Missing FieldName", error.getMessage());
  }
}
