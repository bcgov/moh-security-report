package moh.hpc.month.end.resident.processors;

import ca.bc.gov.health.report.model.MEBalRptProcessorViewModel;
import java.math.BigDecimal;
import java.nio.file.Files;
import java.nio.file.Path;
import java.util.Arrays;
import java.util.Date;
import static org.junit.jupiter.api.Assertions.*;
import org.junit.jupiter.api.Test;

public class MEBalRptProcessorTest {

  /**
   * Test of createPdfReport method, of class MEBalRptProcessor.
   *
   * <p>This is just a smoke test that ensures Jasper, the report template, and the model conversion
   * are working.
   */
  @Test
  public void testCreateReport() throws Exception {
    MEBalRptProcessorViewModel balanceInvoiceClaims = new MEBalRptProcessorViewModel();
    balanceInvoiceClaims.setClaimIn(BigDecimal.valueOf(400));
    balanceInvoiceClaims.setClaimOut(BigDecimal.valueOf(200));
    balanceInvoiceClaims.setInvIn(BigDecimal.valueOf(1000));
    balanceInvoiceClaims.setInvOut(BigDecimal.valueOf(2000));
    balanceInvoiceClaims.setProvince("UNITTEST");
    balanceInvoiceClaims.setStartDate(new Date());
    balanceInvoiceClaims.setEndDate(new Date());

    MEBalRptProcessor instance = new MEBalRptProcessor();
    byte[] pdfData = instance.createPdfReport(Arrays.asList(balanceInvoiceClaims));

    assertTrue(new String(pdfData).contains("PDF"));

//    Path path = Files.createTempFile("report3", ".pdf");
//    Files.write(path, pdfData);
//    Process p = Runtime.getRuntime().exec("rundll32 url.dll,FileProtocolHandler " + path);
//    p.waitFor();
  }
}
