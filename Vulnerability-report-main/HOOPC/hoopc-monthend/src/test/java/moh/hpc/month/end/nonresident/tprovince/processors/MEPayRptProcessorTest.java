package moh.hpc.month.end.nonresident.tprovince.processors;

import ca.bc.gov.health.report.model.PayReqReportViewModel;
import java.math.BigDecimal;
import java.nio.file.Files;
import java.nio.file.Path;
import java.util.ArrayList;
import java.util.List;
import static org.junit.jupiter.api.Assertions.assertTrue;
import org.junit.jupiter.api.Test;

/** @author trevor.schiavone */
public class MEPayRptProcessorTest {

  PayReqReportViewModel fha = new PayReqReportViewModel();
  PayReqReportViewModel fhaout = new PayReqReportViewModel();
  PayReqReportViewModel nha = new PayReqReportViewModel();
  PayReqReportViewModel nhaout = new PayReqReportViewModel();
  PayReqReportViewModel vihaout = new PayReqReportViewModel();
  PayReqReportViewModel viha = new PayReqReportViewModel();
  PayReqReportViewModel iha = new PayReqReportViewModel();
  PayReqReportViewModel ihaout = new PayReqReportViewModel();
  PayReqReportViewModel vcha = new PayReqReportViewModel();
  PayReqReportViewModel vchaout = new PayReqReportViewModel();
  PayReqReportViewModel phsa = new PayReqReportViewModel();
  PayReqReportViewModel phsaout = new PayReqReportViewModel();

  @Test
  public void testReport() throws Exception {

    List<PayReqReportViewModel> queryList = new ArrayList<>();

    fha.setRepTitle("Health Authority");
    fha.setProvinceHaName("Fraser Health Authority");
    fha.setDocControl("Y000343");
    fha.setPayeeSupp("200434-001");
    fha.setDistribSupp("123456");
    fha.setMinistry("26");
    fha.setResp("66797");
    fha.setServiceLine("45462");
    fha.setStob("8097");
    fha.setClaimAmount(new BigDecimal("2000"));
    fha.setCheqStubInfo("Inpatient for testmonth 2019");

    fhaout.setRepTitle("Health Authority");
    fhaout.setProvinceHaName("Fraser Health Authority");
    fhaout.setDocControl("Y000343");
    fhaout.setPayeeSupp("200434-001");
    fhaout.setDistribSupp("123456");
    fhaout.setMinistry("26");
    fhaout.setResp("66797");
    fhaout.setServiceLine("45462");
    fhaout.setStob("8097");
    fhaout.setClaimAmount(new BigDecimal("2000"));
    fhaout.setCheqStubInfo("Inpatient for testmonth 2019");

    setupHa();

    queryList.add(fha);
    queryList.add(fhaout);
    queryList.add(nha);
    queryList.add(nhaout);
    queryList.add(vihaout);
    queryList.add(viha);
    queryList.add(ihaout);
    queryList.add(iha);
    queryList.add(vchaout);
    queryList.add(vcha);
    queryList.add(phsa);
    queryList.add(phsaout);

    MEPayRptProcessor payRptProcessor = new MEPayRptProcessor();
    payRptProcessor.setProcessMonth("201911");
    byte[] pdfData = payRptProcessor.createPdfReport(queryList);
    assertTrue(new String(pdfData).contains("PDF"));

//    Path path = Files.createTempFile("testReport", ".pdf");
//    Files.write(path, pdfData);
//    Process p = Runtime.getRuntime().exec("rundll32 url.dll,FileProtocolHandler " + path);
//    p.waitFor();
  }

  private void setupHa() {
    nha.setRepTitle("Health Authority");
    nha.setProvinceHaName("Northern Health Authority");
    nha.setDocControl("Y000343");
    nha.setPayeeSupp("200434-001");
    nha.setDistribSupp("123456");
    nha.setMinistry("26");
    nha.setResp("66797");
    nha.setServiceLine("45462");
    nha.setStob("8097");
    nha.setClaimAmount(new BigDecimal("2000"));
    nha.setCheqStubInfo("Inpatient for testmonth 2019");

    nhaout.setRepTitle("Health Authority");
    nhaout.setProvinceHaName("Northern Health Authority");
    nhaout.setDocControl("Y000343");
    nhaout.setPayeeSupp("200434-001");
    nhaout.setDistribSupp("123456");
    nhaout.setMinistry("26");
    nhaout.setResp("66797");
    nhaout.setServiceLine("45462");
    nhaout.setStob("8097");
    nhaout.setClaimAmount(new BigDecimal("2000"));
    nhaout.setCheqStubInfo("Inpatient for testmonth 2019");

    viha.setRepTitle("Health Authority");
    viha.setProvinceHaName("Vancouver Island Health Authority");
    viha.setDocControl("Y000343");
    viha.setPayeeSupp("200434-001");
    viha.setDistribSupp("123456");
    viha.setMinistry("26");
    viha.setResp("66797");
    viha.setServiceLine("45462");
    viha.setStob("8097");
    viha.setClaimAmount(new BigDecimal("2000"));
    viha.setCheqStubInfo("Inpatient for testmonth 2019");

    vihaout.setRepTitle("Health Authority");
    vihaout.setProvinceHaName("Vancouver Island Health Authority");
    vihaout.setDocControl("Y000343");
    vihaout.setPayeeSupp("200434-001");
    vihaout.setDistribSupp("123456");
    vihaout.setMinistry("26");
    vihaout.setResp("66797");
    vihaout.setServiceLine("45462");
    vihaout.setStob("8097");
    vihaout.setClaimAmount(new BigDecimal("2000"));
    vihaout.setCheqStubInfo("Inpatient for testmonth 2019");

    iha.setRepTitle("Health Authority");
    iha.setProvinceHaName("Interior Health Authority");
    iha.setDocControl("Y000343");
    iha.setPayeeSupp("200434-001");
    iha.setDistribSupp("123456");
    iha.setMinistry("26");
    iha.setResp("66797");
    iha.setServiceLine("45462");
    iha.setStob("8097");
    iha.setClaimAmount(new BigDecimal("2000"));
    iha.setCheqStubInfo("Inpatient for testmonth 2019");

    ihaout.setRepTitle("Health Authority");
    ihaout.setProvinceHaName("Interior Health Authority");
    ihaout.setDocControl("Y000343");
    ihaout.setPayeeSupp("200434-001");
    ihaout.setDistribSupp("123456");
    ihaout.setMinistry("26");
    ihaout.setResp("66797");
    ihaout.setServiceLine("45462");
    ihaout.setStob("8097");
    ihaout.setClaimAmount(new BigDecimal("2000"));
    ihaout.setCheqStubInfo("Inpatient for testmonth 2019");

    vcha.setRepTitle("Health Authority");
    vcha.setProvinceHaName("Vancouver Coastal Health Authority");
    vcha.setDocControl("Y000343");
    vcha.setPayeeSupp("200434-001");
    vcha.setDistribSupp("123456");
    vcha.setMinistry("26");
    vcha.setResp("66797");
    vcha.setServiceLine("45462");
    vcha.setStob("8097");
    vcha.setClaimAmount(new BigDecimal("2000"));
    vcha.setCheqStubInfo("Inpatient for testmonth 2019");

    vchaout.setRepTitle("Health Authority");
    vchaout.setProvinceHaName("Vancouver Coastal Health Authority");
    vchaout.setDocControl("Y000343");
    vchaout.setPayeeSupp("200434-001");
    vchaout.setDistribSupp("123456");
    vchaout.setMinistry("26");
    vchaout.setResp("66797");
    vchaout.setServiceLine("45462");
    vchaout.setStob("8097");
    vchaout.setClaimAmount(new BigDecimal("2000"));
    vchaout.setCheqStubInfo("Inpatient for testmonth 2019");

    phsa.setRepTitle("Health Authority");
    phsa.setProvinceHaName("Provincial Health Services Authority");
    phsa.setDocControl("Y000343");
    phsa.setPayeeSupp("200434-001");
    phsa.setDistribSupp("123456");
    phsa.setMinistry("26");
    phsa.setResp("66797");
    phsa.setServiceLine("45462");
    phsa.setStob("8097");
    phsa.setClaimAmount(new BigDecimal("2000"));
    phsa.setCheqStubInfo("Inpatient for testmonth 2019");

    phsaout.setRepTitle("Health Authority");
    phsaout.setProvinceHaName("Provincial Health Services Authority");
    phsaout.setDocControl("Y000343");
    phsaout.setPayeeSupp("200434-001");
    phsaout.setDistribSupp("123456");
    phsaout.setMinistry("26");
    phsaout.setResp("66797");
    phsaout.setServiceLine("45462");
    phsaout.setStob("8097");
    phsaout.setClaimAmount(new BigDecimal("2000"));
    phsaout.setCheqStubInfo("Inpatient for testmonth 2019");
  }
}
