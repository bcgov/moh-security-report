package ca.bc.gov.health.beans.claim.edit;

import ca.bc.gov.health.database.entity.ResidencyTypes;
import ca.bc.gov.health.service.viewmodel.ClaimViewModel;
import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertNull;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

public class EditClaimTest {

  private EditRIClaim editClaimBean;

  @BeforeEach
  public void setup() {
    editClaimBean = new EditRIClaim();
  }

  @Test
  public void residentAdjRequestWrongStatus() {
    // GIVEN
    ClaimViewModel claim = new ClaimViewModel();
    claim.setResidencyType(new ResidencyTypes());
    claim.getResidencyType().setTypeCode("RES");
    claim.getResidencyType().setTypeDesc("Resident");
    claim.setStatusCode("POTATOE STATE");
    String adjType = "REQUEST";

    // WHEN
    String errorMsg = editClaimBean.checkClaimStatus(adjType, claim);

    // THEN
    assertNotNull(errorMsg);
    assertEquals(
        "Invalid claim status POTATOE STATE. For resident adjustment "
            + "request, status must be one of PENDING,PROCESSED,ADJUST REQ,ADJUST APP.",
        errorMsg);
  }

  @Test
  public void residentAdjRequestGoodStatus() {
    // GIVEN
    ClaimViewModel claim = new ClaimViewModel();
    claim.setResidencyType(new ResidencyTypes());
    claim.getResidencyType().setTypeCode("RES");
    claim.getResidencyType().setTypeDesc("Resident");
    claim.setStatusCode("PENDING");
    String adjType = "REQUEST";

    // WHEN
    String errorMsg = editClaimBean.checkClaimStatus(adjType, claim);

    // THEN
    assertNull(errorMsg);
  }

  @Test
  public void residentAdjDecisionWrongStatus() {
    // GIVEN
    ClaimViewModel claim = new ClaimViewModel();
    claim.setResidencyType(new ResidencyTypes());
    claim.getResidencyType().setTypeCode("RES");
    claim.getResidencyType().setTypeDesc("Resident");
    claim.setStatusCode("POTATOE STATE");
    String adjType = "DECISION";

    // WHEN
    String errorMsg = editClaimBean.checkClaimStatus(adjType, claim);

    // THEN
    assertNotNull(errorMsg);
    assertEquals(
        "Invalid claim status POTATOE STATE. For resident adjustment "
            + "decision, status must be one of PROCESSED,ADJUST REQ,ADJUST APP.",
        errorMsg);
  }

  @Test
  public void residentAdjDecisionGoodStatus() {
    // GIVEN
    ClaimViewModel claim = new ClaimViewModel();
    claim.setResidencyType(new ResidencyTypes());
    claim.getResidencyType().setTypeCode("RES");
    claim.getResidencyType().setTypeDesc("Resident");
    claim.setStatusCode("PROCESSED");
    String adjType = "DECISION";

    // WHEN
    String errorMsg = editClaimBean.checkClaimStatus(adjType, claim);

    // THEN
    assertNull(errorMsg);
  }

  @Test
  public void nonResidentAdjRequestWrongStatus() {
    // GIVEN
    ClaimViewModel claim = new ClaimViewModel();
    claim.setResidencyType(new ResidencyTypes());
    claim.getResidencyType().setTypeCode("NRES");
    claim.getResidencyType().setTypeDesc("Non-Resident");
    claim.setStatusCode("POTATOE STATE");
    String adjType = "REQUEST";

    // WHEN
    String errorMsg = editClaimBean.checkClaimStatus(adjType, claim);

    // THEN
    assertNotNull(errorMsg);
    assertEquals(
        "Invalid claim status POTATOE STATE. For non-resident "
            + "adjustment request, status must be one of PROCESSED,ADJUST REQ,ADJUST APP.",
        errorMsg);
  }

  @Test
  public void nonResidentAdjRequestGoodStatus() {
    // GIVEN
    ClaimViewModel claim = new ClaimViewModel();
    claim.setResidencyType(new ResidencyTypes());
    claim.getResidencyType().setTypeCode("NRES");
    claim.getResidencyType().setTypeDesc("Non-Resident");
    claim.setStatusCode("PROCESSED");
    String adjType = "REQUEST";

    // WHEN
    String errorMsg = editClaimBean.checkClaimStatus(adjType, claim);

    // THEN
    assertNull(errorMsg);
  }

  @Test
  public void nonResidentAdjDecisionWrongStatus() {
    // GIVEN
    ClaimViewModel claim = new ClaimViewModel();
    claim.setResidencyType(new ResidencyTypes());
    claim.getResidencyType().setTypeCode("NRES");
    claim.getResidencyType().setTypeDesc("Non-Resident");
    claim.setStatusCode("POTATOE STATE");
    String adjType = "DECISION";

    // WHEN
    String errorMsg = editClaimBean.checkClaimStatus(adjType, claim);

    // THEN
    assertNotNull(errorMsg);
    assertEquals(
        "Invalid claim status POTATOE STATE. For non-resident "
            + "adjustment decision, status must be one of PROCESSED,ADJUST REQ,ADJUST APP.",
        errorMsg);
  }

  @Test
  public void nonResidentAdjDecisionGoodStatus() {
    // GIVEN
    ClaimViewModel claim = new ClaimViewModel();
    claim.setResidencyType(new ResidencyTypes());
    claim.getResidencyType().setTypeCode("NRES");
    claim.getResidencyType().setTypeDesc("Non-Resident");
    claim.setStatusCode("ADJUST REQ");
    String adjType = "DECISION";

    // WHEN
    String errorMsg = editClaimBean.checkClaimStatus(adjType, claim);

    // THEN
    assertNull(errorMsg);
  }
}
