package ca.bc.gov.health.beans.claim.edit;

import ca.bc.gov.health.constants.GlobalConstants;
import ca.bc.gov.health.service.viewmodel.ClaimViewModel;
import jakarta.annotation.PostConstruct;
import jakarta.faces.application.FacesMessage;
import jakarta.faces.view.ViewScoped;
import jakarta.inject.Named;

/** The Class EditNROClaim. */
@ViewScoped
@Named("EditNROClaim")
public class EditNROClaim extends EditClaim {
  private static final long serialVersionUID = 765486616075693240L;

  // @TODO Inject config properties
  private static final String EDIT_RETURN_URL =
      "editClaimNonResidentOutpatient?faces-redirect=true&claimId=";
  private static final String DELETE_RETURN_URL =
      "searchNonResidentOutpatient.xhtml?faces-redirect=true";
  private static final String CLAIM_TYPE = "Non-Resident Outpatient";

  @PostConstruct
  @Override
  public void postInit() {
    super.postInit();
    if (claim.getClaimId() != null
        && (!claim.getClaimType().getClaimType().equals(GlobalConstants.OUTPATIENT_CLAIM_TYPE)
            || !claim
                .getResidencyType()
                .getTypeCode()
                .equals(GlobalConstants.NRES_RESIDENCY_TYPE))) {
      addMessage(
          FacesMessage.SEVERITY_ERROR,
          formatClaimPageAndTypeMismatchMessage(claim.getClaimId().toString(), CLAIM_TYPE),
          false);

      claim = new ClaimViewModel();
    }
  }

  @Override
  public String getEditRedirectUrl(Long claimid) {
    return "editClaimNonResidentOutpatient.xhtml?claimId=" + claimid;
  }

  @Override
  protected String getEditReturnUrl() {
    return EDIT_RETURN_URL;
  }

  @Override
  protected String getDeleteReturnUrl() {
    return DELETE_RETURN_URL;
  }
}
