<!DOCTYPE html>
<ui:composition template="/WEB-INF/templates/gov30Template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core"           
                xmlns:cc="http://xmlns.jcp.org/jsf/composite/composites">

    <ui:define name="title">Reprint Non Resident Month End Reports</ui:define>

    <ui:define name="content">
        <h:form id="reprintNonResReportForm">
            <ui:include src="/WEB-INF/fragments/navTabs/monthendTabs.xhtml" />
            <p:messages id="messages" closable="true"/>

            <h1 class="reportMonthEnd">Reprint Non Resident Month End Reports</h1>

            <p:outputPanel id="healthAuthorityPanel" class="form-group" style="margin-top: 0px">
                <h2>HEALTH AUTHORITY</h2>

                <div class="ui-g">
                    <div class="ui-g-3">
                        <p:outputLabel for="haProcessingMonth" value="Billing Period" />
                        <span class="date-pattern">(YYYYMM)</span>
                        <p:selectOneMenu id="haProcessingMonth" editable="true" maxlength="6"
                                         style="width: 100%" required="true"
                                         value="#{ReprintNonResMonthEnd.haProcessMonth}"
                                         validator="YearMonthValidator">
                            <f:selectItems value="#{ReprintNonResMonthEnd.months}" />
                            <p:ajax event="itemSelect" update="@this" global="false" immediate="true"/>
                        </p:selectOneMenu>
                    </div>
                    <div class="ui-g-12">
                        <cc:selectManyCheckboxAll id="haReports" value="#{ReprintNonResMonthEnd.selectedHaReports}" required="true" 
                                                   layout="grid" columns="1" allValue="#{ReprintNonResMonthEnd.selectAllHaReports}" allLabel="Select All Reports">           
                                <!--BCMOHAD-10398-17Mar22: adding Balance report to health authority-->
                                <f:selectItem itemLabel="Balance Report" itemValue="HOOPCR0010"/>
                        	<f:selectItem itemLabel="Reimbursement Summary" itemValue="HOOPCR0009"/>
                        	<f:selectItem itemLabel="Payment Requisition" itemValue="HOOPCR0004"/>
                        </cc:selectManyCheckboxAll>
                    </div>
                    <div class="ui-g-12 submit-buttons" >
                        <p:commandButton id="haPDFValidation" value="Generate PDF" style="margin-bottom: 0px" 
                                         update="@form" process="healthAuthorityPanel" 
                                         styleClass="submit-button" action="#{ReprintNonResMonthEnd.retrieveHaReports}" 
                                         oncomplete="window.scrollTo(0,0); if (args &amp;&amp; !args.validationFailed) { handlePDFValidationSuccessful() }">
                            <p:resetInput target=":reprintNonResReportForm" />
                        </p:commandButton>  
                    </div>
                 </div>
            </p:outputPanel>

            <p:outputPanel id="hospitalPanel" class="form-group">
                <h2>HOSPITAL</h2>

                <div class="ui-g">
                    <div class="ui-g-3" >
                        <p:outputLabel for="hospProcessingMonth" value="Billing Period" />
                        <span class="date-pattern">(YYYYMM)</span>
                        <p:selectOneMenu id="hospProcessingMonth" editable="true" maxlength="6"
                                         style="width: 100%" required="true"
                                         value="#{ReprintNonResMonthEnd.hospProcessMonth}"
                                         validator="YearMonthValidator">
                            <f:selectItems value="#{ReprintNonResMonthEnd.months}" />
                            <p:ajax event="itemSelect" update="@this" global="false"/>
                        </p:selectOneMenu>
                    </div>
                    <div class="ui-g-12">
                        <p:outputLabel for="hospReports" value="PDF Reports" style="margin-bottom: 10px"/>
                        <cc:selectManyCheckboxAll id="hospReports" value="#{ReprintNonResMonthEnd.selectedHospReports}" required="true" 
                                                   layout="grid" columns="1" allValue="#{ReprintNonResMonthEnd.selectAllHospReports}" allLabel="Select All Reports">           
                            <f:selectItem itemLabel="Detailed Inpatient Claims Listing" itemValue="HOOPCR0006"/>
                            <f:selectItem itemLabel="Detailed Outpatient Claims Listing" itemValue="HOOPCR0007"/>          
                        </cc:selectManyCheckboxAll>
                    </div>
                    <div class="ui-g-12 submit-buttons" >
                        <p:commandButton id="hospPDFValidation" value="Generate PDF" style="margin-bottom: 0px"
                                         styleClass="submit-button" action="#{ReprintNonResMonthEnd.retrieveHospReports}"
                                         update="@form" process="hospitalPanel"
                                         oncomplete="window.scrollTo(0,0); if (args &amp;&amp; !args.validationFailed) { handlePDFValidationSuccessful() }">
                            <p:resetInput target=":reprintNonResReportForm" />
                        </p:commandButton>                     
                    </div>                    
                </div>
            </p:outputPanel>

            <p:outputPanel id="provincePanel" class="form-group">
                <h2>PROVINCE</h2>

                <div class="ui-g">
                    <div class="ui-g-12">
                        <p:outputLabel value="STEP 1: SELECT PROVINCES" for="provinces"
                                       style="margin-bottom: 10px"/>
                        <cc:selectManyCheckboxAll id="provinces" value="#{ReprintNonResMonthEnd.selectedProvinces}" layout="grid" columns="2"
                                                   required="true" allValue="#{ReprintNonResMonthEnd.selectAllProvinces}" allLabel="Select All Provinces">
                            <f:selectItem itemLabel="Alberta" itemValue="AB"/>
                            <f:selectItem itemLabel="British Columbia" itemValue="BC"/>
                            <f:selectItem itemLabel="Nunavut" itemValue="NU"/>
                            <f:selectItem itemLabel="Manitoba" itemValue="MB"/>
                            <f:selectItem itemLabel="Ontario" itemValue="ON"/>
                            <f:selectItem itemLabel="New Brunswick" itemValue="NB"/>
                            <f:selectItem itemLabel="Prince Edward Island" itemValue="PE"/>
                            <f:selectItem itemLabel="Newfoundland/Labrador" itemValue="NL"/>
                            <f:selectItem itemLabel="Quebec" itemValue="QC"/>
                            <f:selectItem itemLabel="Northwest Territories" itemValue="NT"/>
                            <f:selectItem itemLabel="Saskatchewan" itemValue="SK"/>
                            <f:selectItem itemLabel="Nova Scotia" itemValue="NS"/>
                            <f:selectItem itemLabel="Yukon Territory" itemValue="YT"/>
                        </cc:selectManyCheckboxAll>
                    </div>
                    
                    <div class="ui-g-8" style="margin-top: 10px;">
                        <p:outputLabel for="provProcessingMonth" value="STEP 2: SELECT PROCESSING MONTH" 
                                       style="margin-bottom: 10px; display: block"/>
                        <p:outputLabel value="Billing Period" />
                        <span class="date-pattern">(YYYYMM)</span><br/>
                        <p:selectOneMenu id="provProcessingMonth" editable="true" maxlength="6"
                                         style="width: 36%" required="true" 
                                         value="#{ReprintNonResMonthEnd.provProcessMonth}"
                                         validator="YearMonthValidator">
                            <f:selectItems value="#{ReprintNonResMonthEnd.months}" />
                            <p:ajax event="itemSelect" update="@this" global="false" immediate="true"/>
                        </p:selectOneMenu>
                    </div>
                    
                    <div class="ui-g-5" style="margin-top: 10px;">
                        <p:outputLabel id="nresPdfReports" value="PDF REPORTS" 
                                       for="provPDFReports" style="margin: 0px 5px 10px 0px"/>*
                        <cc:selectManyCheckboxAll id="provPDFReports" value="#{ReprintNonResMonthEnd.selectedProvReports}"
                                                   required="#{not empty param[provPDFValidation.clientId]}"
                                                   layout="grid" columns="1" allValue="#{ReprintNonResMonthEnd.selectAllProvReports}" allLabel="Select All Reports">           
                            <!--BCMOHAD-10398-17Mar22: Removing Balance report from province-->
                            <f:selectItem itemLabel="Provincial Invoice Letter" itemValue="HOOPCR0005"/>
                            <f:selectItem itemLabel="Detailed Inpatient Claims Listing" itemValue="HOOPCR0006"/>
                            <f:selectItem itemLabel="Detailed Outpatient Claims Listing" itemValue="HOOPCR0007"/>          
                            <f:selectItem itemLabel="Summary of Outpatient Claims by Service Code" itemValue="HOOPCR0008"/>          
                        </cc:selectManyCheckboxAll>
                        <div class="submit-buttons" style="display: block" >
                            <p:commandButton id="provPDFValidation" value="Generate PDF" style="margin-bottom: 0px"
                                             styleClass="submit-button" action="#{ReprintNonResMonthEnd.retrieveProvReports}" 
                                             update="@form" process="provincePanel" binding="#{provPDFValidation}"
                                             oncomplete="window.scrollTo(0,0); if (args &amp;&amp; !args.validationFailed) { handlePDFValidationSuccessful() }"/>                    
                        </div>                          
                    </div>
                    
          <div class="ui-g-5" style="margin-top: 10px; width: 27%;"> <!--//BCMOHAD-9617 Allow reprint of TXT file for MonthEnd Report -->
                        <p:outputLabel id="nresCsvReports" value="CSV REPORTS" 
                                       for="csvReports" style="margin: 0px 5px 10px 0px"/>*
                        <cc:selectManyCheckboxAll id="csvReports" value="#{ReprintNonResMonthEnd.selectedCsvReports}" 
                                                   required="#{not empty param[csvValidation.clientId]}"
                                                   layout="grid" columns="1" allValue="#{ReprintNonResMonthEnd.selectAllCsvReports}" allLabel="Select All Reports">           
                            <f:selectItem itemLabel="Inpatient Claims File" itemValue="HOOPCR0015I"/>
                            <f:selectItem itemLabel="Outpatient Claims File" itemValue="HOOPCR0015O"/>
                        </cc:selectManyCheckboxAll>
                        <div class="submit-buttons" style="display: block" >
                            <p:commandButton id="csvValidation" value="Generate CSV" style="margin-bottom: 0px"
                                             styleClass="submit-button" binding="#{csvValidation}"
                                             update="@form" process="provincePanel"
                                             action="#{ReprintNonResMonthEnd.retrieveClaimsFiles}"
                                             oncomplete="window.scrollTo(0,0); if (args &amp;&amp; !args.validationFailed) { handleCSVValidationSuccessful() }" >
                            </p:commandButton>                 
                        </div>                          
                    </div>

          <!--//Start BCMOHAD-9617 Allow reprint of TXT file for MonthEnd Report -->
          <div class="ui-g-5" style="margin-top: 10px; width: 20%;">
            <p:outputLabel id="nresTxtReports" value="TXT REPORTS" 
                           for="txtReports" style="margin: 0px 5px 10px 0px"/>*
            <p:selectManyCheckbox id="txtReports" value="#{ReprintNonResMonthEnd.selectedTxtReports}" widgetVar="blub" 
                                  layout="grid" columns="1" >
              <f:selectItem itemLabel="Inpatient Claims File" itemValue="HOOPCR0015I"/>
              <f:selectItem itemLabel="Outpatient Claims File" itemValue="HOOPCR0015O"/>
            </p:selectManyCheckbox>

            <div class="submit-buttons" style="display: block" >
              <p:commandButton id="txtValidation" value="Generate TXT" style="margin-bottom: 0px"
                               styleClass="submit-button" binding="#{txtValidation}"
                               update="@form" process="provincePanel"
                               action="#{ReprintNonResMonthEnd.retrieveClaimsFilesTxt}"
                               oncomplete="window.scrollTo(0,0); if (args &amp;&amp; !args.validationFailed) { handleTXTValidationSuccessful() }" >
              </p:commandButton>                 
            </div>                          
                </div>

                </div>
        <!--//End BCMOHAD-9617 Allow reprint of TXT file for MonthEnd Report -->
            </p:outputPanel>            

            <p:commandButton id="generatePDF" value="Generate PDF"
                             style="display: none;" onclick="target = '_blank';" immediate="true"
                             update="@form" ajax="false" oncomplete="window.scrollTo(0,0);" >
                <p:fileDownload value="#{ReprintNonResMonthEnd.generatePDF()}" contentDisposition="inline"/>                  
            </p:commandButton>
            <p:commandButton id="generateCSV" value="Generate CSV"
                             style="display: none;" immediate="true"
                             update="@form" ajax="false" oncomplete="window.scrollTo(0,0);" >
                <p:fileDownload value="#{ReprintNonResMonthEnd.generateCSV()}" contentDisposition="inline"/>                  
            </p:commandButton>
      <!--//Start BCMOHAD-9617 Allow reprint of TXT file for MonthEnd Report -->
      <p:commandButton id="generateTXT" value="Generate TXT"
                       style="display: none;" immediate="true"
                       update="@form" ajax="false" oncomplete="window.scrollTo(0,0);" >
        <p:fileDownload value="#{ReprintNonResMonthEnd.generateTXT()}" contentDisposition="inline"/>                  
      </p:commandButton>
      <!--//End BCMOHAD-9617 Allow reprint of TXT file for MonthEnd Report -->
            <script>
                function handlePDFValidationSuccessful() {
                    document.getElementById('reprintNonResReportForm:generatePDF').click();
                }
                function handleCSVValidationSuccessful() {
                    document.getElementById('reprintNonResReportForm:generateCSV').click();
                }
        <!--//Start BCMOHAD-9617 Allow reprint of TXT file for MonthEnd Report -->
        function handleTXTValidationSuccessful() {
          document.getElementById('reprintNonResReportForm:generateTXT').click();
        }
        <!--//End BCMOHAD-9617 Allow reprint of TXT file for MonthEnd Report -->
            </script>
        </h:form>
    </ui:define>
</ui:composition>
