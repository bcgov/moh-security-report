/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.hlth.swt.session;

import ca.bc.gov.hlth.mail.MailService;
import jakarta.ejb.EJB;
import jakarta.ejb.Stateless;
import jakarta.mail.MessagingException;

/**
 * Session bean for sending mail
 *
 * @author greg.perkins
 */
@Stateless
public class MailBean implements MailBeanLocal {

    /**
     * Service class to delegate to
     */
    private MailService mailService;

    /**
     * Facade for looking up constants
     */
    @EJB
    private SystemConstantFacadeLocal scFacade;

    /**
     * Sets up the Mail Service
     */
    private void initMailService() {
        mailService = new MailService();
        mailService.setSmtpServer(scFacade.find("SMTP_HOST").getConstantValueTxt());
    }

    /**
     * Sends an email
     *
     * @param to
     * @param fromAddr
     * @param fromName
     * @param subject
     * @param text
     * @throws jakarta.mail.MessagingException
     */
    @Override
    public void sendMessage(String to, String fromAddr, String fromName, String subject, String text) throws MessagingException {
        if (mailService == null) {
            initMailService();
        }
        mailService.sendMessage(to, fromAddr, fromName, subject, text);
    }

}
