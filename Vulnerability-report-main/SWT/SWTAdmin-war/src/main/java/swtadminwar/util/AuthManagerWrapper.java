/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package swtadminwar.util;

import ca.bc.gov.health.auth.util.AuthorizationManager;
import ca.bc.gov.health.auth.util.AuthorizationManagerFactory;
import ca.bc.gov.health.login.RoleHelper;
import jakarta.enterprise.context.ApplicationScoped;
import jakarta.faces.context.FacesContext;
import jakarta.inject.Named;
import jakarta.servlet.http.HttpServletRequest;
import java.util.List;

/**
 *
 * @author adebiyi.kuseju
 */
@ApplicationScoped
@Named
public class AuthManagerWrapper {

    public boolean attemptAuthorization(String resourcePath) {
        AuthorizationManager authManager = AuthorizationManagerFactory.getInstance();
        List roles = RoleHelper.getUserRoles((HttpServletRequest) FacesContext.getCurrentInstance().getExternalContext().getRequest());
        return authManager.attemptAuthorization(resourcePath, roles);
    }

}
