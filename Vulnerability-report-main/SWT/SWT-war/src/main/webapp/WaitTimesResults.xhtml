<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">

    <ui:composition template="/WEB-INF/templates/gov30Template.xhtml">
        <ui:define name="swtMetaData">
            <meta name="Description" content="Displays the wait times for this surgery, grouped by health authorities, hospitals and surgeons."/>
            <meta property="og:site_name" content="Surgical Wait times"/>
            <meta property="og:type" content="website"/>
            <meta property="og:url" content="https://swt.hlth.gov.bc.ca"/>
            <meta property="og:title" content="Results page"/>
            <meta property="og:description" content="Displays the wait times for this surgery, grouped by health authorities, hospitals and surgeons."/>
            <meta property="og:image" content="https://swt.hlth.gov.bc.ca/jakarta.faces.resource/images/steps-to-surgery.jpg.xhtml"/>
        </ui:define>

        <ui:define name="title">Wait Times Result</ui:define>

        <ui:define name="searchBar">
            <ui:include src="WEB-INF/fragments/searchBar.xhtml" />
        </ui:define>

        <ui:define name="content">
            <script language='javascript'>
                document.styleSheets[0].insertRule('.datatable-overflow-wrapper:before { height: 0px }', 0);
                window.onpageshow = function (event) {
                    if (event.persisted) {
                        window.location.reload();
                    }
                };
            </script>
            <p:ajaxStatus onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()" />

            <p:dialog styleClass="spinner-box" widgetVar="statusDialog" modal="false" 
                      draggable="false" closable="false" resizable="false" showHeader="false" >
                <h:graphicImage name="images/loader.png" styleClass="spinning-loader"/>
                <br/>
                <h:outputText value="Loading" />
            </p:dialog>

            <div class="row" style="margin-bottom: 10px">
                <div class="col-xs-48 col-sm-36">
                    <a href="Home.xhtml">Home</a> / <a href="ProceduresAToZ.xhtml">Procedures A-Z</a> / Wait Times Results
                </div>

                <ui:include src="WEB-INF/fragments/emailPrintShare.xhtml" />

            </div>
            <h1>
                Surgery Wait Times for "<h:outputText value="#{Search.adult== 'Y' ? 'Adult' : 'Pediatric'}"/>
                <h:outputText value=" - "/>
                <h:outputText value="#{Search.procedureNm}"/>"
            </h1>                                                  
            <p> 
                <h:outputText value="Definition: #{Search.procedureNm}" style="font-weight: 600"/> -
                <h:outputText value="#{Search.procedureDs}"/>
            </p>
            <hr/>

            <h:form id="form1">                
                <p:dialog id="findProvinces" widgetVar="findProvinces" resizable="false"
                          draggable="false" width="490px" modal="true" styleClass="disable-scroll find-provinces-dialog">
                    <f:facet name="header" >            
                        <h:outputText value="Health Authorities" />
                    </f:facet>
                    <p:outputPanel id="dialogPanel">
                        <h:outputText value="Select a health authority from the list to filter 
                                      the wait times results." style="font-size: 13px;"/>
                        <br/>
                        <div style="float:left; display:inline; margin-right: -80px;">
                            <h:graphicImage name="images/ProvincesMap.jpg" width="322"/>
                        </div>
                        <div style="display:inline; float:left;">
                            <br/>                                
                            <h:column>
                                <div style="line-height: 160%">
                                    <h:outputText style="background:#3498DB; width:10px; height:10px;display:inline-block;"/>
                                    <div style="display:inline-block">                                            
                                        <p:commandLink action="#{Search.changeHealthAuthority()}" value="#{Search.haMap['5']}"  
                                                       update=":form1" onclick="PF('findProvinces').hide();" style="text-transform: none; text-decoration: none;font-size:13px; color: #000000; font-weight: 400;"
                                                       process="@this" immediate="true">
                                            <p:ajax listener="#{Search.clearHealthAuthorityFilter()}"/>
                                            <f:setPropertyActionListener target="#{Search.haFromMap}" value="5"/>
                                        </p:commandLink>
                                    </div>
                                    <br/>
                                </div>
                                <div style="line-height: 160%">
                                    <h:outputText style="background:#104E8B; width:10px; height:10px;display:inline-block"/>
                                    <div style="display:inline-block">
                                        <p:commandLink action="#{Search.changeHealthAuthority()}" value="#{Search.haMap['1']}"  
                                                       update=":form1" onclick="PF('findProvinces').hide();" style="text-transform: none; text-decoration: none;font-size:13px; color: #000000; font-weight: 400;"
                                                       process="@this" immediate="true">
                                            <p:ajax listener="#{Search.clearHealthAuthorityFilter()}"/>
                                            <f:setPropertyActionListener target="#{Search.haFromMap}" value="1"/>                                                    
                                        </p:commandLink>
                                    </div>
                                    <br/>
                                </div>
                                <div style="line-height: 160%">
                                    <h:outputText style="background:#BCED91; width:10px; height:10px;display:inline-block;"/>
                                    <div style="display:inline-block">
                                        <p:commandLink action="#{Search.changeHealthAuthority()}" value="#{Search.haMap['3']}"  
                                                       update=":form1" onclick="PF('findProvinces').hide();" style="text-transform: none; text-decoration: none;font-size:13px; color: #000000; font-weight: 400;"
                                                       process="@this" immediate="true">
                                            <p:ajax listener="#{Search.clearHealthAuthorityFilter()}"/>
                                            <f:setPropertyActionListener target="#{Search.haFromMap}" value="3"/>                                                    
                                        </p:commandLink>
                                    </div>                                    
                                    <br/>
                                </div>
                                <div style="line-height: 160%">
                                    <h:outputText style="background:#12B2B2; width:10px; height:10px;display:inline-block"/>
                                    <div style="display:inline-block">
                                        <p:commandLink action="#{Search.changeHealthAuthority()}" value="#{Search.haMap['4']}"  
                                                       update=":form1" onclick="PF('findProvinces').hide();" style="text-transform: none; text-decoration: none;font-size:13px; color: #000000;font-weight: 400;"
                                                       process="@this" immediate="true">
                                            <p:ajax listener="#{Search.clearHealthAuthorityFilter()}"/>
                                            <f:setPropertyActionListener target="#{Search.haFromMap}" value="4"/>                                                    
                                        </p:commandLink>
                                    </div>
                                    <br/>
                                </div>
                                <div style="line-height: 160%">
                                    <h:outputText style="background:#FFA500; width:10px; height:10px;display:inline-block"/>
                                    <div style="display:inline-block">
                                        <p:commandLink action="#{Search.changeHealthAuthority()}" value="#{Search.haMap['2']}"  
                                                       update=":form1" onclick="PF('findProvinces').hide();" style="text-transform: none; text-decoration: none;font-size:13px; color: #000000;font-weight: 400;"
                                                       process="@this" immediate="true">
                                            <p:ajax listener="#{Search.clearHealthAuthorityFilter()}"/>
                                            <f:setPropertyActionListener target="#{Search.haFromMap}" value="2"/>                                                    
                                        </p:commandLink>
                                    </div>
                                    <br/>
                                </div>
                                <div style="line-height: 160%">
                                    <h:outputText style="background:#000000; width:10px; height:10px;display:inline-block"/>
                                    <div style="display:inline-block">
                                        <p:commandLink action="#{Search.changeHealthAuthority()}" value="#{Search.haMap['6']}"  
                                                       update=":form1" onclick="PF('findProvinces').hide();" 
                                                       style="text-transform: none; text-decoration: none;font-size:13px; color: #000000;font-weight: 400;"
                                                       process="@this" immediate="true">
                                            <p:ajax listener="#{Search.clearHealthAuthorityFilter()}"/>
                                            <f:setPropertyActionListener target="#{Search.haFromMap}" value="6"/>                                                    
                                        </p:commandLink>
                                    </div>
                                </div>
                            </h:column>
                        </div>
                    </p:outputPanel>     
                </p:dialog>

                <!--Filter Bars-->
                <div class="row" style="padding-bottom: 25px">
                    <div class="col-lg-10 col-md-13 col-sm-25 col-xs-25 " style="padding-bottom: 10px">
                        <p:outputLabel value="Health Authority" for="healthAuthorityFilter" styleClass="dropdown-label"/>
                        <div id="selectOnMap" style="display:inline-block;">
                            <p:commandLink oncomplete="PF('findProvinces').show();" value="Select on Map" 
                                           style="text-transform: none; font-weight: 400" update="findProvinces"/>
                        </div>
                        <h:selectOneMenu id="healthAuthorityFilter" value="#{Search.healthAuthorityFilter}" styleClass="health-authority-filter">
                            <f:selectItem itemValue="" itemLabel="All Health Authorities"/>
                            <f:selectItems value="#{Search.healthAuthorities}" /> 
                            <p:ajax event="change" update="form1" listener="#{Search.changeHealthAuthority}" />  
                        </h:selectOneMenu>
                    </div>
                    <div class="col-lg-16 col-md-16 col-sm-25 col-xs-25 " style="padding-bottom: 10px">
                        <p:outputLabel value="Cities/Hospitals" styleClass="dropdown-label"/>
                        <p:selectCheckboxMenu id="facilityFilter" styleClass="facility-filter"
                                              value="#{Search.facilityFilter}" 
                                              label="City or Hospital Name"
                                              filter="true"
                                              filterMatchMode="contains">                                                                                                                                            
                            <f:selectItems value="#{Search.facilities}"/>                                                  
                            <p:ajax event="change" update="form1" listener="#{Search.changeFacility}" /> 
                            <p:ajax event="toggleSelect" update="form1" listener="#{Search.changeFacility}"/>
                        </p:selectCheckboxMenu>
                        <h:selectManyListbox id="facilityFilterMobile" styleClass="facility-filter-mobile"
                                             value="#{Search.facilityFilter}" 
                                             label="City or Hospital Name" size="1"> 
                            <f:selectItems value="#{Search.facilities}"/> 
                            <p:ajax event="change" update="form1" listener="#{Search.changeFacility}"/> 
                        </h:selectManyListbox>
                    </div>
                    <div class="col-lg-16 col-md-13 col-sm-25 col-xs-25" style="padding-bottom: 10px">
                        <p:outputLabel value="Specialist" styleClass="dropdown-label"/>
                        <h:selectOneMenu  id="specialistFilter" value="#{Search.specialistFilter}" styleClass="specialist-filter">
                            <f:selectItem itemValue="" itemLabel="All Specialists"/>
                            <f:selectItems value="#{Search.surgeons}" />
                            <p:ajax event="change" update="form1" listener="#{Search.changeSpecialist}" />
                        </h:selectOneMenu>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-10 col-xs-25 reset-link">
                        <p:commandLink id="resetLink" update="form1" style="font-weight: 400" actionListener="#{Search.clear}">
                            <h:outputText value="Reset Filters" style="text-transform: none;"/>
                        </p:commandLink>
                    </div>
                </div>

                <div id="dataTableOverflowWrapper" class="datatable-overflow-wrapper">

                    <!-- Sticky Header -->
                    <p:toolbar id="columnGroup" >
                        <f:facet name="left">
                            <p:dataTable value="" style="margin-top: 0px">
                                <p:columnGroup type="header">
                                    <p:row>
                                        <p:column rowspan="2" styleClass="resultpanel-topleft" style="width:45%"
                                                  headerText="Procedure"/>
                                        <p:column rowspan="2" styleClass="resultpanel-center">    
                                            <f:facet name="header">
                                                <h:outputText value="Cases waiting "/>
                                                <h:outputText id="casesW" value="?" styleClass="question-circle1"/>
                                                <p:tooltip id="toolTip1" for="casesW" value="Cases Waiting: The number of patients waiting for surgery 
                                                           on the last day of the reporting period." position="top"/>
                                                <br/>
                                                <c:if test="#{empty Search.nonSprResults}">
                                                    <h:outputText value="as of #{Search.endDt}" style="color: #a7c0c6;"/>  
                                                </c:if>
                                                <c:if test="#{not empty Search.nonSprResults}">
                                                    <c:forEach items="#{Search.nonSprResults}" var="nonSprResult" varStatus="r" end="0">
                                                        <h:outputText value="as of #{Search.getNonSprAsOfDt(nonSprResult.rollupProcedureGroupId)}" style="color: #a7c0c6;"/>
                                                    </c:forEach>
                                                </c:if>
                                            </f:facet>
                                        </p:column>
                                        <c:if test="#{empty Search.nonSprResults}">
                                            <p:column colspan="2" styleClass="resultpanel-topright date" 
                                                      headerText="Between #{ShowAdultSiteStatistics.startDt} and #{ShowAdultSiteStatistics.endDt}"/>
                                        </c:if>
                                        <c:if test="#{not empty Search.nonSprResults}">
                                            <c:forEach items="#{Search.nonSprResults}" var="nonSprResult" varStatus="r" end="0" >
                                                <p:column colspan="2" styleClass="resultpanel-topright date" 
                                                          headerText="Between #{Search.getNonSprStartDt(nonSprResult.rollupProcedureGroupId)} and #{Search.getNonSprEndDt(nonSprResult.rollupProcedureGroupId)}"/>
                                            </c:forEach>
                                        </c:if>
                                    </p:row>
                                    <p:row>
                                        <p:column styleClass="resultpanel-topright fifty-percent">
                                            <f:facet name="header">
                                                <h:outputText value="50% of cases "/>
                                                <h:outputText id="cases50" value="?" styleClass="question-circle2"/>
                                                <br/>
                                                <p:tooltip id="toolTip2" for="cases50" value="50th percentile wait time (median wait time): 50% of all scheduled surgeries completed during the 
                                                           three month reporting period waited less than this wait time." position="top"/>
                                                <h:outputText value="completed within"/>
                                            </f:facet>
                                        </p:column>
                                        <p:column styleClass="resultpanel-topright ninety-percent">
                                            <f:facet name="header">
                                                <h:outputText value="90% of cases "/>
                                                <h:outputText id="cases90" value="?" styleClass="question-circle2"/>
                                                <br/>
                                                <p:tooltip id="toolTip3" for="cases90" value="90th percentile wait time: 90% of all scheduled surgeries completed during the 
                                                           three month reporting period waited less than this wait time." position="top"/>
                                                <h:outputText value="completed within"/>
                                            </f:facet>    
                                        </p:column>
                                    </p:row>
                                </p:columnGroup>
                            </p:dataTable>
                        </f:facet>
                    </p:toolbar>
                    <p:sticky target="columnGroup"/>

                    <p:dataTable id="resultsTable" var="result" value="#{Search.results}" rowIndexVar="rowIndex" style="margin-top: 0px"                             
                                 rendered="#{not empty Search.results}"
                                 rowExpandMode="Single">
                        <p:column colspan="4" style="padding: 0px !important; border-width:0px; border-image-width: 0px;">
                            <p:panelGrid>
                                <!--Procedure -->                          
                                <p:row  styleClass="resultpanel-header resultpanel-proc"  
                                        rendered="#{result.rollupProcedureGroupId ne Search.results[rowIndex - 1].rollupProcedureGroupId}">
                                    <p:column style="width:45%; padding: 4px 10px !important;" >
                                        <h:outputText value="#{result.procedureGroupNm}" style="font-weight:bold"/>
                                    </p:column> 
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText id="lt1" value="#{result.rollup3PatientsWaitingNbr lt 5 ? 'Less than 5' : result.rollup3PatientsWaitingNbr}" style="font-weight:bold">
                                            <f:convertNumber pattern="###,###" />
                                        </h:outputText>
                                        <p:tooltip id="toolTip7" for="lt1" rendered="#{not empty result.rollup3PatientsWaitingNbr and result.rollup3PatientsWaitingNbr lt 5}"
                                                   value="For the purposes of ensuring patient confidentiality, all 
                                                   cases waiting fields shown on the Surgery Wait Times website with values less than five are shown as
                                                   Less than 5" position="top"/>
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText id="na1" rendered="#{not Search.shouldDisplayProcedureResult(result)}" value="N/A" />
                                        <p:tooltip id="toolTip8" for="na1"
                                                   value="N/A: Not applicable (when there are no cases completed
                                                   during the reporting period, it is not applicable to report wait times information)" position="top"/>      
                                        <ui:fragment rendered="#{Search.shouldDisplayProcedureResult(result)}">
                                            <h:outputText value="#{result.rollup3FiftyPctWeeksNbrForWaitTwo} " style="font-weight:bold"/>
                                            <h:outputText value="weeks" style="font-weight:bold"/>
                                        </ui:fragment>
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText id="na2" rendered="#{not Search.shouldDisplayProcedureResult(result)}" value="N/A" />
                                        <p:tooltip id="toolTip9" for="na2"
                                                   value="N/A: Not applicable (when there are no cases completed
                                                   during the reporting period, it is not applicable to report wait times information)" position="top"/>      
                                        <ui:fragment rendered="#{Search.shouldDisplayProcedureResult(result)}">
                                            <h:outputText value="#{result.rollup3NinetyPctWeeksNbrForWaitTwo} " style="font-weight:bold"/>
                                            <h:outputText value="weeks" style="font-weight:bold"/>
                                        </ui:fragment>
                                    </p:column>
                                </p:row>

                                <!--HA -->
                                <p:row styleClass="resultpanel-header resultpanel-ha"
                                       rendered="#{result.healthAuthorityNm.concat(result.rollupProcedureGroupId) ne Search.results[rowIndex - 1].healthAuthorityNm.concat(Search.results[rowIndex - 1].rollupProcedureGroupId)}">
                                    <p:column style="width:45%; padding: 4px 10px !important;" >
                                        <h:outputText value="#{result.healthAuthorityNm}"  style="font-weight:bold;"/>                                       
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText id="lt2" value="#{result.rollup2PatientsWaitingNbr lt 5 ? 'Less than 5' : result.rollup2PatientsWaitingNbr}" style="font-weight:bold">
                                            <f:convertNumber pattern="###,###" />
                                        </h:outputText>
                                        <p:tooltip id="toolTip10" for="lt2" rendered="#{not empty result.rollup2PatientsWaitingNbr and result.rollup2PatientsWaitingNbr lt 5}"
                                                   value="For the purposes of ensuring patient confidentiality, all 
                                                   cases waiting fields shown on the Surgery Wait Times website with values less than five are shown as
                                                   Less than 5" position="top"/>
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText id="na3" rendered="#{not Search.shouldDisplayHAResult(result)}" value="N/A" style="font-weight:bold"/>
                                        <p:tooltip id="toolTip11" for="na3"
                                                   value="N/A: Not applicable (when there are no cases completed
                                                   during the reporting period, it is not applicable to report wait times information)" position="top"/>      
                                        <ui:fragment rendered="#{Search.shouldDisplayHAResult(result)}">
                                            <h:outputText value="#{result.rollup2FiftyPctWeeksNbrForWaitTwo} " style="font-weight:bold" />
                                            <h:outputText value="weeks" style="font-weight:bold"/>
                                        </ui:fragment>
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn ">
                                        <h:outputText id="na4" rendered="#{not Search.shouldDisplayHAResult(result)}" value="N/A" style="font-weight:bold"/>
                                        <p:tooltip id="toolTip12" for="na4"
                                                   value="N/A: Not applicable (when there are no cases completed
                                                   during the reporting period, it is not applicable to report wait times information)" position="top"/>      
                                        <ui:fragment rendered="#{Search.shouldDisplayHAResult(result)}">
                                            <h:outputText value="#{result.rollup2NinetyPctWeeksNbrForWaitTwo} " style="font-weight:bold"/>
                                            <h:outputText value="weeks" style="font-weight:bold"/>
                                        </ui:fragment>                                      
                                    </p:column>
                                </p:row>

                                <!--Facility -->
                                <p:row styleClass="resultpanel-facility"
                                       rendered="#{result.facilityNm.concat(result.rollupProcedureGroupId) ne Search.results[rowIndex - 1].facilityNm.concat(Search.results[rowIndex - 1].rollupProcedureGroupId)}" >
                                    <p:column style="width:45%; padding: 4px 10px !important;" >
                                        <h:outputText value="#{result.facilityNm}" style="font-weight:bold"/>
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText id="lt3" value="#{result.rollup1PatientsWaitingNbr lt 5 ? 'Less than 5' : result.rollup1PatientsWaitingNbr}" style="font-weight:bold" >
                                            <f:convertNumber pattern="###,###" />
                                        </h:outputText>
                                        <p:tooltip id="toolTip13" for="lt3" rendered="#{not empty result.rollup1PatientsWaitingNbr and result.rollup1PatientsWaitingNbr lt 5}"
                                                   value="For the purposes of ensuring patient confidentiality, all 
                                                   cases waiting fields shown on the Surgery Wait Times website with values less than five are shown as
                                                   Less than 5" position="top"/>
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText id="na5" rendered="#{not Search.shouldDisplayFacilityResult(result)}" value="N/A" style="font-weight:bold"/>
                                        <p:tooltip id="toolTip14" for="na5"
                                                   value="N/A: Not applicable (when there are no cases completed
                                                   during the reporting period, it is not applicable to report wait times information)" position="top"/>      
                                        <ui:fragment rendered="#{Search.shouldDisplayFacilityResult(result)}">
                                            <h:outputText value="#{result.rollup1FiftyPctWeeksNbrForWaitTwo} " style="font-weight:bold"/>
                                            <h:outputText value="weeks" style="font-weight:bold"/>
                                        </ui:fragment>                                                              
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn ">
                                        <h:outputText id="na6" rendered="#{not Search.shouldDisplayFacilityResult(result)}" value="N/A" style="font-weight:bold"/>
                                        <p:tooltip id="toolTip15" for="na6"
                                                   value="N/A: Not applicable (when there are no cases completed
                                                   during the reporting period, it is not applicable to report wait times information)" position="top"/>      
                                        <ui:fragment rendered="#{Search.shouldDisplayFacilityResult(result)}">
                                            <h:outputText value="#{result.rollup1NinetyPctWeeksNbrForWaitTwo} " style="font-weight:bold" />
                                            <h:outputText value="weeks" style="font-weight:bold"/>
                                        </ui:fragment>                                                                    
                                    </p:column>
                                </p:row>

                                <p:row styleClass="resultpanel-specialist">
                                    <p:column style="width:45%; padding: 4px 10px !important;">
                                        <h:link value="#{result.surgeonNm}" outcome="SpecialistProfile" onclick="PF('statusDialog').show();">
                                            <f:param name="rollupSurgeonId" value="#{result.rollupSurgeonId}"/>
                                            <f:param name="surgeonNm" value="#{result.surgeonNm}"/>
                                            <h:panelGroup rendered="#{ApplicationBean1.isCentralIntakeSurgeon(result.surgeonNm)}">                
                                                <h:outputText id="CentralIntake" value="?" styleClass="question-circle2" style="margin-left: 5px" />                    
                                                <p:tooltip id="toolTipCI" for="CentralIntake" 
                                                        value="Central Intake is a process used by some hospitals and specialists to support shorter wait times where patients are assigned to the first available specialist, rather than a specific specialist. A Generic Provider is named temporarily, until a specialist is assigned." 
                                                        position="top" />
                                            </h:panelGroup>
                                        </h:link>
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText id="lt4" value="#{result.patientsWaitingNbr lt 5 ? 'Less than 5' : result.patientsWaitingNbr}">                                        
                                            <f:convertNumber pattern="###,###" />
                                        </h:outputText>
                                        <p:tooltip id="toolTip16" for="lt4" rendered="#{not empty result.patientsWaitingNbr and result.patientsWaitingNbr lt 5}"
                                                   value="For the purposes of ensuring patient confidentiality, all 
                                                   cases waiting fields shown on the Surgery Wait Times website with values less than five are shown as
                                                   Less than 5" position="top"/>
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText id="na7" rendered="#{ not Search.shouldDisplayResult(result)}" value="N/A" />
                                        <p:tooltip id="toolTip17" for="na7"
                                                   value="N/A: Not applicable (when there are no cases completed
                                                   during the reporting period, it is not applicable to report wait times information)" position="top"/>      
                                        <ui:fragment rendered="#{Search.shouldDisplayResult(result)}">
                                            <h:outputText value="#{result.fiftyPctWeeksNbrForWaitTwo} " />
                                            <h:outputText value="weeks" />
                                        </ui:fragment>
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn ">
                                        <h:outputText id="na8" rendered="#{not Search.shouldDisplayResult(result)}" value="N/A" />
                                        <p:tooltip id="toolTip18" for="na8"
                                                   value="N/A: Not applicable (when there are no cases completed
                                                   during the reporting period, it is not applicable to report wait times information)" position="top"/>      
                                        <ui:fragment rendered="#{Search.shouldDisplayResult(result)}">
                                            <h:outputText value="#{result.ninetyPctWeeksNbrForWaitTwo} " />
                                            <h:outputText value="weeks" />
                                        </ui:fragment>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                        </p:column>
                    </p:dataTable>

                    <!--Non SPR results-->
                    <p:dataTable id="nonSprResultsTable" var="nonSprResult" value="#{Search.nonSprResults}" rowIndexVar="rowIndex" style="margin-top: 0px"                             
                                 rendered="#{not empty Search.nonSprResults}"
                                 rowExpandMode="Single">
                        <p:column colspan="4" style="padding: 0px !important; border-width:0px; border-image-width: 0px;">
                            <p:panelGrid>
                                <!--Procedure -->                          
                                <p:row  styleClass="resultpanel-header resultpanel-proc" 
                                        rendered="#{nonSprResult.rollupProcedureGroupId ne Search.nonSprResults[rowIndex - 1].rollupProcedureGroupId}">
                                    <p:column style="width:45%; padding: 4px 10px !important;" >
                                        <h:outputText value="#{nonSprResult.procedureGroupNm}" style="font-weight:bold"/>
                                    </p:column> 
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText value="#{empty nonSprResult.healthAuthorityNm and nonSprResult.patientsWaitingNbr lt 5 ? 'Less than 5': nonSprResult.patientsWaitingNbr}">
                                            <f:convertNumber pattern="###,###" />
                                        </h:outputText>
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText value="#{empty nonSprResult.healthAuthorityNm ? nonSprResult.fiftyPctWeeksNbrForWaitTwo :''}" rendered="#{Search.shouldDisplayResult(nonSprResult)}" style="font-weight:bold"/>
                                        <h:outputText value="#{empty nonSprResult.healthAuthorityNm and Search.shouldDisplayResult(nonSprResult) ? ' weeks' : 'N/A'}"/>
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn ">
                                        <h:outputText value="#{empty nonSprResult.healthAuthorityNm ? nonSprResult.ninetyPctWeeksNbrForWaitTwo : ''}" rendered="#{Search.shouldDisplayResult(nonSprResult)}" style="font-weight:bold"/>
                                        <h:outputText value="#{empty nonSprResult.healthAuthorityNm and Search.shouldDisplayResult(nonSprResult) ? ' weeks' : 'N/A'}" />
                                    </p:column>
                                </p:row>                            

                                <!--HA -->                            
                                <p:row styleClass="resultpanel-header resultpanel-ha"
                                       rendered="#{nonSprResult.healthAuthorityNm ne Search.nonSprResults[rowIndex - 1].healthAuthorityNm}">
                                    <p:column style="width:45%; padding: 4px 10px !important;" >
                                        <h:outputText value="#{nonSprResult.healthAuthorityNm}"  style="font-weight:bold;" />
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn"/>
                                    <p:column styleClass="resultpanel-casesColumn"/>
                                    <p:column styleClass="resultpanel-casesColumn"/>                                
                                </p:row>                                                        

                                <!--Facility -->
                                <p:row styleClass="resultpanel-facility"
                                       rendered="#{nonSprResult.facilityNm ne Search.nonSprResults[rowIndex - 1].facilityNm}" >
                                    <p:column style="width:45%; padding: 4px 10px !important;" >
                                        <h:outputText value="#{nonSprResult.facilityNm}" />
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText id="lt5" value="#{nonSprResult.patientsWaitingNbr lt 5 ? 'Less than 5' : nonSprResult.patientsWaitingNbr}" >
                                            <f:convertNumber pattern="###,###" />
                                        </h:outputText>
                                        <p:tooltip id="toolTip19" for="lt5" rendered="#{nonSprResult.fiftyPctWeeksNbrForWaitTwo lt 5}"
                                                   value="For the purposes of ensuring patient confidentiality, all 
                                                   cases waiting fields shown on the Surgery Wait Times website with values less than five are shown as
                                                   Less than 5" position="top"/>
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText value="#{nonSprResult.fiftyPctWeeksNbrForWaitTwo} " rendered="#{Search.shouldDisplayResult(nonSprResult)}" style="font-weight:bold"/>
                                        <h:outputText id="na9" value="#{Search.shouldDisplayResult(nonSprResult) ? 'weeks' : 'N/A'}"/>
                                        <p:tooltip id="toolTip20" for="na9" rendered="#{!Search.shouldDisplayResult(nonSprResult)}"
                                                   value="N/A: Not applicable (when there are no cases completed
                                                   during the reporting period, it is not applicable to report wait times information)" position="top"/>                                                                        
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn ">
                                        <h:outputText value="#{nonSprResult.ninetyPctWeeksNbrForWaitTwo} " rendered="#{Search.shouldDisplayResult(nonSprResult)}" style="font-weight:bold"/>
                                        <h:outputText id="na10" value="#{Search.shouldDisplayResult(nonSprResult) ? 'weeks' : 'N/A'}"/>
                                        <p:tooltip id="toolTip21" for="na10" rendered="#{!Search.shouldDisplayResult(nonSprResult)}"
                                                   value="N/A: Not applicable (when there are no cases completed
                                                   during the reporting period, it is not applicable to report wait times information)" position="top"/>                                   
                                    </p:column>
                                </p:row>

                                <!--Specialist-->
                                <p:row styleClass="resultpanel-specialist" rendered="#{not empty nonSprResult.surgeonNm and not empty nonSprResult.healthAuthorityNm}">
                                    <p:column style="width:45%; padding: 4px 10px !important;" >
                                        <h:link value="#{nonSprResult.surgeonNm}" outcome="SpecialistProfile" onclick="PF('statusDialog').show();">
                                            <f:param name="rollupSurgeonId" value="#{nonSprResult.rollupSurgeonId}"/>
                                            <f:param name="surgeonNm" value="#{nonSprResult.surgeonNm}"/>
                                            <h:panelGroup rendered="#{ApplicationBean1.isCentralIntakeSurgeon(nonSprResult.surgeonNm)}">                
                                                <h:outputText id="CentralIntake" value="?" styleClass="question-circle2" style="margin-left: 5px" />                    
                                                <p:tooltip id="toolTipCI" for="CentralIntake" 
                                                        value="Central Intake is a process used by some hospitals and specialists to support shorter wait times where patients are assigned to the first available specialist, rather than a specific specialist. A Generic Provider is named temporarily, until a specialist is assigned." 
                                                        position="top" />
                                            </h:panelGroup> 
                                        </h:link>
                                    </p:column>                                    
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText id="lt6" value="#{nonSprResult.patientsWaitingNbr lt 5 ? 'Less than 5' : nonSprResult.patientsWaitingNbr}">
                                            <f:convertNumber pattern="###,###" />
                                        </h:outputText>
                                        <p:tooltip id="toolTip22" for="lt6" rendered="#{nonSprResult.patientsWaitingNbr lt 5}"
                                                   value="For the purposes of ensuring patient confidentiality, all 
                                                   cases waiting fields shown on the Surgery Wait Times website with values less than five are shown as
                                                   Less than 5" position="top"/>
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn">
                                        <h:outputText value="#{nonSprResult.fiftyPctWeeksNbrForWaitTwo} " rendered="#{Search.shouldDisplayResult(nonSprResult)}" style="font-weight:bold"/>
                                        <h:outputText id="na11" value="#{Search.shouldDisplayResult(nonSprResult) ? 'weeks' : 'N/A'}" />
                                        <p:tooltip id="toolTip23" for="na11" rendered="#{!Search.shouldDisplayResult(nonSprResult)}"
                                                   value="N/A: Not applicable (when there are no cases completed
                                                   during the reporting period, it is not applicable to report wait times information)" position="top"/>                                    
                                    </p:column>
                                    <p:column styleClass="resultpanel-casesColumn ">
                                        <h:outputText value="#{nonSprResult.ninetyPctWeeksNbrForWaitTwo} " rendered="#{Search.shouldDisplayResult(nonSprResult)}" style="font-weight:bold"/>
                                        <h:outputText id="na12" value="#{Search.shouldDisplayResult(nonSprResult) ? 'weeks' : 'N/A'}" />
                                        <p:tooltip id="toolTip24" for="na12" rendered="#{!Search.shouldDisplayResult(nonSprResult)}"
                                                   value="N/A: Not applicable (when there are no cases completed
                                                   during the reporting period, it is not applicable to report wait times information)" position="top"/>                                    
                                    </p:column>
                                </p:row> 
                            </p:panelGrid>
                        </p:column>                                
                    </p:dataTable>
                </div>
                <p:messages id="invalidHAMsg" showDetail="true" showSummary="tue">
                    <p:autoUpdate />
                </p:messages>
                <script language='javascript'>
                    var overflowWrapperHeight = $('#dataTableOverflowWrapper').css('height');
                    var sheet = document.styleSheets[0];
                    var rules = sheet.cssRules || sheet.rules;

                    rules[0].style.height = overflowWrapperHeight;
                </script>
            </h:form>
            <br/>
            <h:outputText value="The data presented on the Surgery Wait Times website is a snapshot of a 3-month time period. The " style="font-size: 13px; color:#494949"/>
            <h:link value="Wait for Surgery" style="font-size: 13px" outcome="WaitTimeDefinitions"/>
            <h:outputText value=" represents a component of the total waiting time for surgery, from the date the health authority receives the booking form
                          to the date that the patient receives surgery." style="font-size: 13px; color:#494949;"/>
            <br/><br/>
            <ui:include src="WEB-INF/fragments/emailPrintShareMobile.xhtml" />
        </ui:define>
    </ui:composition>
</html>
