/*
 * ProductDetail.java
 *
 * Created on Dec 7, 2009, 1:21:56 PM
 */
 
package ca.bc.gov.health.pharmacare.web;

import ca.bc.gov.health.pcbl.entity.BenDtl;
import ca.bc.gov.health.pcbl.session.BenDtlFacadeLocal;
import jakarta.enterprise.context.RequestScoped;
import jakarta.faces.component.UIComponent;
import jakarta.faces.context.FacesContext;
import jakarta.faces.convert.Converter;
import jakarta.inject.Inject;
import jakarta.inject.Named;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;

/**
 * Backing Bean for the Product Details screen
 *
 * @author greg.perkins
 */
@RequestScoped
@Named("ProductDetail")
public class ProductDetail {
    
    @Inject
    private Constants constants;
    
    @Inject
    private BenDtlFacadeLocal drugFacade;
    
    private List<BenDtl> benefits;
    private BenDtl drug;
    private String dinPin;
    
    /**
     * Custom date Converter instance
     */
    private Converter dateConverter = new Converter(){

        @Override
        public Object getAsObject(FacesContext arg0, UIComponent arg1, String arg2) {
            return arg2;
        }

        @Override
        public String getAsString(FacesContext arg0, UIComponent arg1, Object arg2) {
            SimpleDateFormat sdf = new SimpleDateFormat("dd-MMM-yyyy");
            return sdf.format((Date)arg2);
        }
    };
    
    public String viewDrug(){
        benefits = drugFacade.findByDin(dinPin);
        drug = benefits.get(0);      
        return null;
    }
    
    public String viewQuantityLimits(){
        benefits = drugFacade.findByDin(dinPin);
        drug = benefits.get(0);      
        return null;
    }
    
    /* Getters and Setters below */
    
    public BenDtl getDrug() {
        return drug;
    }

    public void setDrug(BenDtl drug) {
        this.drug = drug;
    }

    public List<BenDtl> getBenefits() {
        return benefits;
    }

    public void setBenefits(List<BenDtl> benefits) {
        this.benefits = benefits;
    }

    public String getDinPin() {
        return dinPin;
    }

    public void setDinPin(String dinPin) {
        this.dinPin = dinPin;
    }
    
    public boolean getShowPagination(){
        return benefits!=null && benefits.size()> constants.getMaxResultsPerPage();
    }
    
    public Converter getDateConverter() {
        return dateConverter;
    }

    public void setDateConverter(Converter dateConverter) {
        this.dateConverter = dateConverter;
    }

    public void setDrugFacade(BenDtlFacadeLocal drugFacade) {
        this.drugFacade = drugFacade;
    }
}

