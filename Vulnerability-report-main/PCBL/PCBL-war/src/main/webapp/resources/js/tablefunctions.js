// hide productDetailPopup dialog when clicked outside the dialog borders
$(document).click(function(event) { 
    if(!$(event.target).closest('#' + $.escapeSelector('form1:productDetailPopup')).length) {
        if($('#' + $.escapeSelector('form1:productDetailPopup')).is(":visible")) {
            PF('productDetailPopup').hide();
        }
    }        
});

// hide quantityLimitsPopup dialog when clicked outside the dialog borders
$(document).click(function(event) { 
    if(!$(event.target).closest('#' + $.escapeSelector('form1:quantityLimitsPopup')).length) {
        if($('#' + $.escapeSelector('form1:quantityLimitsPopup')).is(":visible")) {
            PF('quantityLimitsPopup').hide();
        }
    }        
}); 

// this is a fix for an IE only primefaces bug for pagination buttons
// https://github.com/primefaces/primefaces/issues/830
PrimeFaces.widget.Paginator.prototype.updatePageLinks = function() {
var start, end, delta;
    // calculate visible page links
    this.cfg.pageCount = Math.ceil(this.cfg.rowCount / this.cfg.rows) || 1;
    var visiblePages = Math.min(this.cfg.pageLinks, this.cfg.pageCount);

    // calculate range, keep current in middle if necessary
    start = Math.max(0, Math.ceil(this.cfg.page - ((visiblePages) / 2)));
    end = Math.min(this.cfg.pageCount - 1, start + visiblePages - 1);

    // check when approaching to last page
    delta = this.cfg.pageLinks - (end - start + 1);
    start = Math.max(0, start - delta);

    // update dom
    this.pagesContainer.children().remove();
    for ( var i = start; i <= end; i++) {
        var styleClass = 'ui-paginator-page ui-state-default ui-corner-all';
        if (this.cfg.page === i) {
            styleClass += " ui-state-active";
        }

        this.pagesContainer.append('<a class="' + styleClass + '" href="#">'
                + (i + 1) + '</a>');
    }

    this.bindPageLinkEvents();
};
