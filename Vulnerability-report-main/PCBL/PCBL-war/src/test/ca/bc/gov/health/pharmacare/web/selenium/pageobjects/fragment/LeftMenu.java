/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.health.pharmacare.web.selenium.pageobjects.fragment;

import org.openqa.selenium.By;
import org.openqa.selenium.NoSuchElementException;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.FindBy;
import org.openqa.selenium.support.PageFactory;
import org.openqa.selenium.support.ui.LoadableComponent;
import selenium.util.ActionBot;
import static org.junit.Assert.*;

/**
 *
 * @author adebiyi.kuseju
 */
public class LeftMenu extends LoadableComponent<LeftMenu> {
    
    
    public static final String PHARMACRE_HOME_LINK_XPATH = "//a[text()='PharmaCare Home']";
    public static final String BENEFITS_LOOKUP_HOME_LINK_XPATH = "//a[text()='Benefits Lookup Home']";
    public static final String SEARCH_LINK_XPATH = "//a[text()='Search']";
    
    public static final String PHARMACRE_HOME_LINK_TEXT = "PharmaCare Home";
    public static final String BENEFITS_LOOKUP_HOME_LINK_TEXT = "Benefits Lookup Home";
    public static final String SEARCH_LINK_TEXT = "Search";

    private final WebDriver driver;
    private String handle;
    private final ActionBot actionBot;
    private final String browser;
    
    public LeftMenu(WebDriver driver, String browser) {
        this.driver = driver;
        this.browser = browser;
        actionBot = new ActionBot(driver);
        
        PageFactory.initElements(driver, this);
    }

    @Override
    protected void load() {
        PageFactory.initElements(driver, this);
    }

    @Override
    protected void isLoaded() throws Error {

        try {
            driver.findElement(By.xpath(PHARMACRE_HOME_LINK_XPATH));
            assert true;
        } catch (NoSuchElementException e) {
            load();

        }
    }
    
    public void setHandle(String handle) {
        this.handle = handle;
    }

    public void navigateToPharmacareHome() {
        actionBot.click(By.xpath(PHARMACRE_HOME_LINK_XPATH));
    }
    
    public void navigateToBenefitsLookupHome() {
        actionBot.click(By.xpath(BENEFITS_LOOKUP_HOME_LINK_XPATH));
    }
    
    public void navigateToSearchForm() {
        actionBot.click(By.xpath(SEARCH_LINK_XPATH));
    }
  
    public void assertLeftMenuLoaded() {
        
        String common = "link in left menu cannot be found";
        
        try {
            driver.findElement(By.xpath(PHARMACRE_HOME_LINK_XPATH));
        } catch (NoSuchElementException nse) {
            fail(String.format("'%s' %s", PHARMACRE_HOME_LINK_TEXT, common));
        }
        
        
        try {
            driver.findElement(By.xpath(BENEFITS_LOOKUP_HOME_LINK_XPATH));
        } catch (NoSuchElementException nse) {
            fail(String.format("'%s' %s", BENEFITS_LOOKUP_HOME_LINK_TEXT, common));
        }
        
        
        try {
            driver.findElement(By.xpath(SEARCH_LINK_XPATH));
        } catch (NoSuchElementException nse) {
            fail(String.format("'%s' %s", SEARCH_LINK_TEXT, common));
        }
    }
}
