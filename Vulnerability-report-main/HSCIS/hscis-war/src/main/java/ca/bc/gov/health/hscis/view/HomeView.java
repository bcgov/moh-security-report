package ca.bc.gov.health.hscis.view;

import jakarta.annotation.PostConstruct;
import jakarta.faces.view.ViewScoped;
import jakarta.inject.Named;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.List;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

@ViewScoped
@Named("HomeView")
public class HomeView extends BaseView {

  private static final long serialVersionUID = 1L;

  private static Logger logger = LoggerFactory.getLogger(HomeView.class);

  private String fiscalYear;
  private List<String> fiscalYearList;
  private List<List<String>> hnFile2Dlist = new ArrayList<>();
  private List<List<String>> dataEntry2Dlist = new ArrayList<>();
  private List<List<String>> funding2Dlist = new ArrayList<>();
  private String fiscalYearPreviousFirstYear;
  private String fiscalYearPreviousSecondYear;
  private String fiscalYearFirstYear;
  private String fiscalYearSecondYear;
  private String fiscalYearFollowingFirstYear;
  private String fiscalYearFollowingSecondYear;

  @PostConstruct
  public void init() {
    refreshFiscalYearList();
    initialzeComponents();
  }

  private void initialzeComponents() {
    List<String> items = new ArrayList<>();
    items.add("1");
    items.add("January 1 to March 31");
    items.add("April 30");
    hnFile2Dlist.add(items);

    items = new ArrayList<>();
    items.add("2");
    items.add("January 1 to June 30");
    items.add("July 31");
    hnFile2Dlist.add(items);

    items = new ArrayList<>();
    items.add("3");
    items.add("January 1 to September 30");
    items.add("October 31");
    hnFile2Dlist.add(items);

    items = new ArrayList<>();
    items.add("4");
    items.add("January 1 to December 31");
    items.add("January 31");
    hnFile2Dlist.add(items);

    items = new ArrayList<>();
    items.add("1");
    items.add("January 1 to June 30");
    items.add("July 31");
    dataEntry2Dlist.add(items);

    items = new ArrayList<>();
    items.add("2");
    items.add("January 1 to December 31");
    items.add("January 31");
    dataEntry2Dlist.add(items);

    items = new ArrayList<>();
    items.add(fiscalYearList.get(0));
    items.add(
        "April 1, "
            + fiscalYearPreviousFirstYear
            + " to March 31, "
            + fiscalYearPreviousSecondYear);
    items.add("July 31, " + fiscalYearPreviousFirstYear);
    funding2Dlist.add(items);

    items = new ArrayList<>();
    items.add(fiscalYearList.get(1));
    items.add("April 1, " + fiscalYearFirstYear + " to March 31, " + fiscalYearSecondYear);
    items.add("July 31, " + fiscalYearFirstYear);
    funding2Dlist.add(items);

    items = new ArrayList<>();
    items.add(fiscalYearList.get(2));
    items.add(
        "April 1, "
            + fiscalYearFollowingFirstYear
            + " to March 31, "
            + fiscalYearFollowingSecondYear);
    items.add("July 31, " + fiscalYearFollowingFirstYear);
    funding2Dlist.add(items);
  }

  public void refreshFiscalYearList() {
    fiscalYearList = new ArrayList<>();
    int year = Calendar.getInstance().get(Calendar.YEAR);
    int month = Calendar.getInstance().get(Calendar.MONTH);
    // Calculates current fiscal year (fiscal year runs April 1 - March 31)
    if (month >= 3) {
      fiscalYear = year + "/" + (year + 1);
    } else {
      fiscalYear = (year - 1) + "/" + year;
    }
    String fiscalYearPrevious = (year - 1) + "/" + year;
    String fiscalYearFollowing = (year + 1) + "/" + (year + 2);

    // Setting substrings for the individual years
    fiscalYearPreviousFirstYear = fiscalYearPrevious.substring(0, 4);
    fiscalYearPreviousSecondYear = fiscalYearPrevious.substring(5, 9);
    fiscalYearFirstYear = fiscalYear.substring(0, 4);
    fiscalYearSecondYear = fiscalYear.substring(5, 9);
    fiscalYearFollowingFirstYear = fiscalYearFollowing.substring(0, 4);
    fiscalYearFollowingSecondYear = fiscalYearFollowing.substring(5, 9);

    fiscalYearList.add(fiscalYearPrevious);
    fiscalYearList.add(fiscalYear);
    fiscalYearList.add(fiscalYearFollowing);
  }

  public void updateFundingSourceRow() {
    logger.debug("TODO: Update funding source row");
  }

  public List<List<String>> getHnFile2Dlist() {
    return hnFile2Dlist;
  }

  public void setMy2DList(List<List<String>> my2Dlist) {
    this.hnFile2Dlist = my2Dlist;
  }

  public List<List<String>> getDataEntry2Dlist() {
    return dataEntry2Dlist;
  }

  public void setDataEntry2Dlist(List<List<String>> dataEntry2Dlist) {
    this.dataEntry2Dlist = dataEntry2Dlist;
  }

  public List<List<String>> getFunding2Dlist() {
    return funding2Dlist;
  }

  public void setFunding2Dlist(List<List<String>> funding2Dlist) {
    this.funding2Dlist = funding2Dlist;
  }

  public String getFiscalYear() {
    return fiscalYear;
  }

  public void setFiscalYear(String fiscalYear) {
    this.fiscalYear = fiscalYear;
  }

  public List<String> getFiscalYearList() {
    return fiscalYearList;
  }

  public void setFiscalYearList(List<String> fiscalYearList) {
    this.fiscalYearList = fiscalYearList;
  }
}
