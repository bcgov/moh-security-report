package ca.bc.gov.health.hscis.view.admin.codetables;

import ca.bc.gov.health.hscis.entity.HcdHealthAuthority;
import ca.bc.gov.health.hscis.service.HscisAdminService;
import ca.bc.gov.health.hscis.view.ApplicationBean;
import ca.bc.gov.health.hscis.view.BaseView;
import jakarta.annotation.PostConstruct;
import jakarta.ejb.EJB;
import jakarta.faces.application.FacesMessage;
import jakarta.faces.view.ViewScoped;
import jakarta.inject.Inject;
import jakarta.inject.Named;
import java.util.List;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

@ViewScoped
@Named("HealthAuthoritiesView")
public class HealthAuthoritiesView extends BaseView {

  private static final long serialVersionUID = 1L;

  private static Logger logger = LoggerFactory.getLogger(HealthAuthoritiesView.class);

  @EJB private HscisAdminService adminService;
  @Inject private ApplicationBean applicationBean;

  private List<HcdHealthAuthority> healthAuthorities;
  private HcdHealthAuthority selectedHealthAuthority;
  private HcdHealthAuthority newHealthAuthority;

  @PostConstruct
  public void init() {
    refreshHealthAuthoritiesList();
  }

  public void refreshHealthAuthoritiesList() {
    applicationBean.initHealthAuthorityCodes();
    healthAuthorities = applicationBean.getHealthAuthorityCodes();
  }

  public void createEmptyHealthAuthorityRow() {
    newHealthAuthority = new HcdHealthAuthority();
  }

  /** @Update the viewed row */
  public void updateHealthAuthorityRow() {
    FacesMessage message = adminService.updateHealthAuthorityRow(selectedHealthAuthority);
    addMessage(message);
    refreshHealthAuthoritiesList();
  }

  /** @Create the new Health Authority */
  public void createHealthAuthorityRow() {
    FacesMessage message = adminService.createHealthAuthorityRow(newHealthAuthority);
    addMessage(message);
    refreshHealthAuthoritiesList();
  }

  public List<HcdHealthAuthority> getHealthAuthorities() {
    return healthAuthorities;
  }

  public void setHealthAuthorities(List<HcdHealthAuthority> healthAuthorities) {
    this.healthAuthorities = healthAuthorities;
  }

  public HcdHealthAuthority getSelectedHealthAuthority() {
    return selectedHealthAuthority;
  }

  public void setSelectedHealthAuthority(HcdHealthAuthority selectedHealthAuthority) {
    this.selectedHealthAuthority = selectedHealthAuthority;
  }

  public HcdHealthAuthority getNewHealthAuthority() {
    return newHealthAuthority;
  }

  public void setNewHealthAuthority(HcdHealthAuthority newHealthAuthority) {
    this.newHealthAuthority = newHealthAuthority;
  }
}
