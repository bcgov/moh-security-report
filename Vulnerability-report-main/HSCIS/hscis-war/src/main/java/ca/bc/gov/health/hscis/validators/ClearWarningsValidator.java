package ca.bc.gov.health.hscis.validators;

import jakarta.faces.application.FacesMessage;
import jakarta.faces.component.UIComponent;
import jakarta.faces.context.FacesContext;
import jakarta.faces.validator.FacesValidator;
import jakarta.faces.validator.Validator;
import java.util.Iterator;

/**
 * FacesValidator to clear "Click Create/Update to save" warning validation messages when error
 * validation messages also exist. This is necessary to be triggered last due to the way validations
 * are triggered. When we create a warning validation messages, we will only know of error
 * validations messages that have happened before and have no way of figuring out if any will happen
 * after.
 *
 * @author CGI Information Management Consultants Inc.
 */
@FacesValidator("ClearWarningsValidator")
public class ClearWarningsValidator implements Validator {

  /**
   * Not a validator...
   *
   * @see jakarta.faces.validator.Validator#validate(jakarta.faces.context.FacesContext,
   *     jakarta.faces.component.UIComponent, java.lang.Object)
   * @param context
   * @param component
   * @param value
   */
  @Override
  public void validate(FacesContext context, UIComponent component, Object value) {

    if (context.getMaximumSeverity() != null
        && context.getMaximumSeverity().compareTo(FacesMessage.SEVERITY_ERROR) >= 0) {
      Iterator<FacesMessage> msgIterator = context.getMessages("saveMsg");
      while (msgIterator.hasNext()) {
        msgIterator.next();
        msgIterator.remove();
      }
    }
  }
}
