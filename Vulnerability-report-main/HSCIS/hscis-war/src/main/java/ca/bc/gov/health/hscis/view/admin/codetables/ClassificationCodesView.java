package ca.bc.gov.health.hscis.view.admin.codetables;

import ca.bc.gov.health.hscis.entity.HcdClassification;
import ca.bc.gov.health.hscis.service.HscisAdminService;
import ca.bc.gov.health.hscis.view.ApplicationBean;
import ca.bc.gov.health.hscis.view.BaseView;
import jakarta.annotation.PostConstruct;
import jakarta.ejb.EJB;
import jakarta.faces.application.FacesMessage;
import jakarta.faces.view.ViewScoped;
import jakarta.inject.Inject;
import jakarta.inject.Named;
import java.util.List;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

@ViewScoped
@Named("ClassificationCodesView")
public class ClassificationCodesView extends BaseView {

  private static final long serialVersionUID = 1L;

  private static Logger logger = LoggerFactory.getLogger(ClassificationCodesView.class);

  @EJB private HscisAdminService adminService;
  @Inject private ApplicationBean applicationBean;

  private List<HcdClassification> classificationCodes;
  private String searchValue;
  private HcdClassification selectedClassificationCode;
  private HcdClassification newClassificationCode;

  @PostConstruct
  public void init() {
    searchValue = "";
    applicationBean.initDesignatedGroups();
    refreshClassificationCodes();
  }

  public void refreshClassificationCodes() {
    classificationCodes = adminService.refreshClassificationCodesList();
  }

  public void searchClassificationCodes() {
    classificationCodes = adminService.searchClassificationCodesList(searchValue);
  }

  public void createEmptyClassificationCodeRow() {
    newClassificationCode = new HcdClassification();
  }

  /** @Update the viewed row */
  public void updateClassificationCodeRow() {
    FacesMessage message = adminService.updateClassificationCodeRow(selectedClassificationCode);
    addMessage(message);
    searchClassificationCodes();
  }

  /** @Create the new Classification Code */
  public void createClassificationCodeRow() {
    FacesMessage message = adminService.createClassificationCodeRow(newClassificationCode);
    addMessage(message);
    searchClassificationCodes();
  }

  /** @return the searchValue */
  public String getSearchValue() {
    return searchValue;
  }

  /** @param searchValue the searchValue to set */
  public void setSearchValue(String searchValue) {
    this.searchValue = searchValue;
  }

  public List<HcdClassification> getClassificationCodes() {
    return classificationCodes;
  }

  public void setClassificationCodes(List<HcdClassification> classificationCodes) {
    this.classificationCodes = classificationCodes;
  }

  public HcdClassification getSelectedClassificationCode() {
    return selectedClassificationCode;
  }

  public void setSelectedClassificationCode(HcdClassification selectedClassificationCode) {
    this.selectedClassificationCode = selectedClassificationCode;
  }

  public HcdClassification getNewClassificationCode() {
    return newClassificationCode;
  }

  public void setNewClassificationCode(HcdClassification newClassificationCode) {
    this.newClassificationCode = newClassificationCode;
  }
}
