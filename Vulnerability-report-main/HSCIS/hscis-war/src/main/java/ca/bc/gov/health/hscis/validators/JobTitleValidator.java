package ca.bc.gov.health.hscis.validators;

import jakarta.faces.application.FacesMessage;
import jakarta.faces.component.UIComponent;
import jakarta.faces.context.FacesContext;
import jakarta.faces.validator.FacesValidator;
import jakarta.faces.validator.Validator;
import jakarta.faces.validator.ValidatorException;

/**
 * FacesValidator for validating Job Title values
 *
 * @author CGI Information Management Consultants Inc.
 */
@FacesValidator("JobTitleValidator")
public class JobTitleValidator implements Validator {

  private static final String JOB_TITLE_DISABLED = "jobTitleDisabled";

  /**
   * Validate the employee's job title. The following rules are validated:
   * <li>If Classification Code does not start with "Unlisted", job title cannot be "N/A"
   *
   * @see jakarta.faces.validator.Validator#validate(jakarta.faces.context.FacesContext,
   *     jakarta.faces.component.UIComponent, java.lang.Object)
   * @param context
   * @param component
   * @param value
   */
  @Override
  public void validate(FacesContext context, UIComponent component, Object value) {

    String errorMsg = null;
    boolean jobTitleDisabled = (boolean) component.getAttributes().get(JOB_TITLE_DISABLED);

    /**
     * The check if Class Code is Unlisted is passed in as the jobTitleDisabled attribute
     *
     * @see ca.bc.gov.health.hscis.view.payroll.EnterPayrollSummaryView#updateJobTitleDisabled()
     */
    if (!jobTitleDisabled) {
      if ("N/A".equalsIgnoreCase((String) value)) {
        errorMsg = "Job Title: Cannot be N/A if Class Code is Unlisted";
      }
    }

    if (errorMsg != null) {
      throw new ValidatorException(
          new FacesMessage(FacesMessage.SEVERITY_ERROR, errorMsg, errorMsg));
    }
  }
}
