package ca.bc.gov.health.hscis.validators;

import jakarta.faces.application.FacesMessage;
import jakarta.faces.component.UIComponent;
import jakarta.faces.context.FacesContext;
import jakarta.faces.validator.FacesValidator;
import jakarta.faces.validator.Validator;
import jakarta.faces.validator.ValidatorException;
import java.util.Arrays;

/**
 * FacesValidator for validating Original Date of Hire values
 *
 * @author CGI Information Management Consultants Inc.
 */
@FacesValidator("OriginalDateOfHireValidator")
public class OriginalDateOfHireValidator implements Validator {

  private static final String JOB_STATUS = "jobStatus";
  private static final String[] JOB_STATUS_REQUIRING_DATE_OF_HIRE = {"F", "P"};

  /**
   * Validate the employee's union. The following rules are validated:
   * <li>If Job Status is F or P, date of hire must be set
   *
   * @see jakarta.faces.validator.Validator#validate(jakarta.faces.context.FacesContext,
   *     jakarta.faces.component.UIComponent, java.lang.Object)
   * @param context
   * @param component
   * @param value
   */
  @Override
  public void validate(FacesContext context, UIComponent component, Object value) {

    String errorMsg = null;
    String jobStatus = (String) component.getAttributes().get(JOB_STATUS);

    if (jobStatus != null) {
      if (Arrays.asList(JOB_STATUS_REQUIRING_DATE_OF_HIRE).contains(jobStatus) && value == null) {
        errorMsg = "Original Date of Hire: Value is required if Job Status is F or P.";
      }

      if (errorMsg != null) {
        throw new ValidatorException(
            new FacesMessage(FacesMessage.SEVERITY_ERROR, errorMsg, errorMsg));
      }
    }
  }
}
