package ca.bc.gov.health.hscis.view.admin;

import ca.bc.gov.health.hscis.entity.HcdValidationRules;
import ca.bc.gov.health.hscis.service.HscisAdminService;
import ca.bc.gov.health.hscis.view.BaseView;
import jakarta.annotation.PostConstruct;
import jakarta.ejb.EJB;
import jakarta.faces.application.FacesMessage;
import jakarta.faces.view.ViewScoped;
import jakarta.inject.Named;
import java.util.List;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

@ViewScoped
@Named("ValidationsView")
public class ValidationsView extends BaseView {

  private static final long serialVersionUID = 1L;

  private static Logger logger = LoggerFactory.getLogger(ValidationsView.class);

  @EJB private HscisAdminService adminService;

  private List<HcdValidationRules> validations;
  private String searchValue;
  private HcdValidationRules selectedValidation;

  private Integer ruleNumber;
  private String programName;
  private String programType;
  private String messageText;
  private String recordType;
  private String severity;
  private String defaultSeverity;
  private String fieldName;

  @PostConstruct
  public void init() {
    searchValue = "";
    validations = adminService.refreshValidationsList();
  }

  public void refreshValidationsList() {
    validations = adminService.refreshValidationsList();
  }

  public void searchValidationsList() {
    validations = adminService.searchValidationsList(searchValue);
  }

  public void onRowSelect() {
    ruleNumber = selectedValidation.getRuleNumber();
    programName = selectedValidation.getProgramName();
    programType = selectedValidation.getProgramType();
    messageText = selectedValidation.getMessageText();
    recordType = selectedValidation.getRecordType();
    severity = selectedValidation.getSeverity();
    defaultSeverity = selectedValidation.getDefaultSeverity();
    fieldName = selectedValidation.getFieldName();
  }

  public void updateValidationRow() {
    selectedValidation.setMessageText(messageText);
    selectedValidation.setSeverity(severity);
    FacesMessage message = adminService.updateValidationRow(selectedValidation);
    addMessage(message);
    searchValidationsList();
  }

  /** @return the searchValue */
  public String getSearchValue() {
    return searchValue;
  }

  /** @param searchValue the searchValue to set */
  public void setSearchValue(String searchValue) {
    this.searchValue = searchValue;
  }

  /** @return the validations */
  public List<HcdValidationRules> getValidations() {
    return validations;
  }

  /** @param validations the validations to set */
  public void setValidations(List<HcdValidationRules> validations) {
    this.validations = validations;
  }

  /** @return the selectedValidation */
  public HcdValidationRules getSelectedValidation() {
    return selectedValidation;
  }

  /** @param selectedValidation the selectedValidation to set */
  public void setSelectedValidation(HcdValidationRules selectedValidation) {
    this.selectedValidation = selectedValidation;
  }

  /** @return the ruleNumber */
  public Integer getRuleNumber() {
    return ruleNumber;
  }

  /** @param ruleNumber the ruleNumber to set */
  public void setRuleNumber(Integer ruleNumber) {
    this.ruleNumber = ruleNumber;
  }

  /** @return the programName */
  public String getProgramName() {
    return programName;
  }

  /** @param programName the programName to set */
  public void setProgramName(String programName) {
    this.programName = programName;
  }

  /** @return the programType */
  public String getProgramType() {
    return programType;
  }

  /** @param programType the programType to set */
  public void setProgramType(String programType) {
    this.programType = programType;
  }

  /** @return the messageText */
  public String getMessageText() {
    return messageText;
  }

  /** @param messageText the messageText to set */
  public void setMessageText(String messageText) {
    this.messageText = messageText;
  }

  /** @return the recordType */
  public String getRecordType() {
    return recordType;
  }

  /** @param recordType the recordType to set */
  public void setRecordType(String recordType) {
    this.recordType = recordType;
  }

  /** @return the severity */
  public String getSeverity() {
    return severity;
  }

  /** @param severity the severity to set */
  public void setSeverity(String severity) {
    this.severity = severity;
  }

  /** @return the defaultSeverity */
  public String getDefaultSeverity() {
    return defaultSeverity;
  }

  /** @param defaultSeverity the defaultSeverity to set */
  public void setDefaultSeverity(String defaultSeverity) {
    this.defaultSeverity = defaultSeverity;
  }

  /** @return the fieldName */
  public String getFieldName() {
    return fieldName;
  }

  /** @param fieldName the fieldName to set */
  public void setFieldName(String fieldName) {
    this.fieldName = fieldName;
  }
}
