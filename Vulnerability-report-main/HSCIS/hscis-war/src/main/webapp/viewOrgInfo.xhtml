<ui:composition template="/WEB-INF/templates/gov30Template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html">
  <ui:define name="title">
    Org Info
  </ui:define>
  <ui:define name="content">
    <h:outputStylesheet name="css/enterpayrollsummary.css" />
    <div class="ui-g-field" style="margin-top: 20px;">
      <p>If any information requires updating, please contact the Ministry of Health</p>
      <p>HSCIS Support at <a href="mailto:HLTH.HscisSupport@gov.bc.ca">HLTH.HscisSupport@gov.bc.ca</a></p>
      <p:messages id="orgInfoMessages" closable="true" />
    </div>
    <h:form id="membershipForm">
      <p:outputPanel id="infoPanel" styleClass="display-flex">
        <div class="ui-g-field">
          <p:outputLabel class="ui-g-label" for="@next" value="Corporate Employer" />
          <div class="ui-g-field">
            <p:selectOneMenu id="corporateId" value="#{OrgInfoView.corpMembership}" style="width: 600px;" required="true">
              <f:selectItem itemDisabled="true" itemLabel="Select" itemValue="#{null}" noSelectionOption="true" />
              <f:selectItems var="membership" value="#{OrgInfoView.membershipsByCorpIds}" itemLabel="#{membership.corporateEmployerNumber} - #{membership.legalName}" itemValue="#{membership}" />
              <f:converter converterId="membershipConverter" />
              <p:ajax event="change" process="@form" />
              <p:ajax event="itemSelect" update="infoPanel orgInfoMessages" immediate="true" listener="#{OrgInfoView.updateCorpId}" />
            </p:selectOneMenu>
          </div>
          <div class="clearfix" />
          <p:outputLabel class="${OrgInfoView.corpMembership == null ? 'ui-g-label readonly' : 'ui-g-label'}" for="@next" value="Site Employer" />
          <div class="ui-g-field">
            <p:selectOneMenu id="siteId" value="#{OrgInfoView.siteMembership}" disabled="${OrgInfoView.corpMembership == null}" style="width: 600px;" required="true">
              <f:selectItem itemDisabled="true" itemLabel="Select" itemValue="#{null}" noSelectionOption="true" />
              <f:selectItems var="membership" value="#{OrgInfoView.membershipsBySiteIds}" itemLabel="#{membership.siteEmployerNumber} - #{membership.operatingName}" itemValue="#{membership}" />
              <f:converter converterId="membershipConverter" />
              <p:ajax event="change" process="@form" />
              <p:ajax event="itemSelect" update="infoPanel orgInfoMessages" immediate="true" />
            </p:selectOneMenu>
          </div>
          <div class="clearfix" />
          <p:outputLabel class="ui-g-label readonly" for="@next" value="Address Line 1" />
          <div class="ui-g-field">
            <p:inputText id="address1" disabled="true" value="#{OrgInfoView.siteMembership.address1}" style="width: 600px" maxlength="40" />
          </div>
          <p:outputLabel class="ui-g-label readonly" for="@next" value="Address Line 2" />
          <div class="ui-g-field">
            <p:inputText id="address2" disabled="true" value="#{OrgInfoView.siteMembership.address2}" style="width: 600px" maxlength="40" />
          </div>
          <div class="clearfix" />
          <p:outputLabel class="ui-g-label readonly" for="@next" value="City" />
          <div class="ui-g-field">
            <p:inputText id="city" disabled="true" value="#{OrgInfoView.siteMembership.city}" style="width: 270px" maxlength="20" />
          </div>
          <p:outputLabel class="ui-g-label readonly" for="@next" value="Province" />
          <div class="ui-g-field">
            <p:inputText id="province" disabled="true" value="#{OrgInfoView.siteMembership.provinceCode}" style="width: 270px" maxlength="4" />
          </div>
          <div class="clearfix" />
          <p:outputLabel class="ui-g-label readonly" for="@next" value="Postal Code" />
          <div class="ui-g-field">
            <p:inputText id="postCode" disabled="true" value="#{OrgInfoView.siteMembership.postalCode}" style="width: 270px" maxlength="7" />
          </div>
          <p:outputLabel class="ui-g-label-large" for="@next" value="Contacts" />
          <p:dataTable id="empList" widgetVar="tblEmpList"
                       value="#{OrgInfoView.siteMembership}"
                       sortBy="#{rows.operatingName}"
                       var="rows" rowKey="#{rows.hscisId}"
                       rows="10" paginator="true" paginatorAlwaysVisible="false"
                       paginatorPosition="top"
                       paginatorTemplate="{CurrentPageReport} {PreviousPageLink} {NextPageLink}"
                       currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords}">
            <p:columnGroup type="header">
              <p:row>
                <p:column headerText="NAME" />
                <p:column headerText="EMAIL" width="400" />
                <p:column headerText="PHONE" width="400" />
              </p:row>
            </p:columnGroup>
            <p:column>
              <p:panelGrid>
                <p:row rendered="#{OrgInfoView.isPrimaryContactSet(rows)}">
                  <p:column>
                    <h:outputText value="#{(rows.contactName1 == null || rows.contactName1.trim() == '') ? '&#160;' : rows.contactName1}" />
                  </p:column>
                </p:row>
                <p:row rendered="#{OrgInfoView.isSecondaryContactSet(rows)}">
                  <p:column>
                    <h:outputText value="#{(rows.contactName2 == null || rows.contactName2.trim() == '') ? '&#160;' : rows.contactName2}" />
                  </p:column>
                </p:row>
              </p:panelGrid>
            </p:column>
            <p:column>
              <p:panelGrid>
                <p:row rendered="#{OrgInfoView.isPrimaryContactSet(rows)}">
                  <p:column>
                    <h:outputText value="#{(rows.email1 == null || rows.email1.trim() == '') ? '&#160;' : rows.email1}" />
                  </p:column>
                </p:row>
                <p:row rendered="#{OrgInfoView.isSecondaryContactSet(rows)}">
                  <p:column>
                    <h:outputText value="#{(rows.email2 == null || rows.email2.trim() == '') ? '&#160;' : rows.email2}" />
                  </p:column>
                </p:row>
              </p:panelGrid>
            </p:column>
            <p:column>
              <p:panelGrid>
                <p:row rendered="#{OrgInfoView.isPrimaryContactSet(rows)}">
                  <p:column>
                    <h:outputText value="#{(rows.areaCode1 == null || rows.areaCode1.trim() == '') ? '' : '('.concat(rows.areaCode1).concat(')')} #{(rows.phone1 == null || rows.phone1.trim() == '') ? '&#160;' : rows.phone1}" />
                  </p:column>
                </p:row>
                <p:row rendered="#{OrgInfoView.isSecondaryContactSet(rows)}">
                  <p:column>
                    <h:outputText value="#{(rows.areaCode2 == null || rows.areaCode2.trim() == '') ? '' : '('.concat(rows.areaCode2).concat(')')} #{(rows.phone2 == null || rows.phone2.trim() == '') ? '&#160;' : rows.phone2}" />
                  </p:column>
                </p:row>
              </p:panelGrid>
            </p:column>
          </p:dataTable>
        </div>
      </p:outputPanel>
    </h:form>
  </ui:define>
</ui:composition>
