<ui:composition template="/WEB-INF/templates/gov30Template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
  <ui:define name="title">
    Data Entry Confirmation
  </ui:define> 
  <ui:define name="content">
    <ui:include src="/WEB-INF/fragments/navTabs/adminTabs.xhtml" />
    <h:form id="dataEntryConfirmationForm">
      <p:messages id="messages" closable="true">
        <p:autoUpdate />
      </p:messages>
      <div class="search-form ui-g-field">
        <p:outputLabel class="ui-g-label" for="@next" value="Search" />
        <div class="search-bar">
          <p:inputText id="inputSearchString" value="#{DataEntryConfirmationView.searchValue}" styleClass="input-field" />
          <p:commandButton value="Search" id="searchButtonGo"
                           styleClass="search search-button" 
                           action="#{DataEntryConfirmationView.searchDataEntryConfirmation}"
                           update="@form"
                           onclick="PF('tblDataEntryConfirmation').paginator.setPage(0);" />
        </div>
      </div>
      <p:dataTable id="dataEntryConfirmationTable" widgetVar="tblDataEntryConfirmation"
                   value="#{DataEntryConfirmationView.confirmations}"
                   sortBy="#{rows.createdOn}"
                   selectionMode="single"
                   selection="#{DataEntryConfirmationView.selectedUpload}"
                   var="rows" rowKey="#{rows.id}"
                   rows="10" paginator="true" paginatorAlwaysVisible="false"
                   paginatorPosition="top"
                   paginatorTemplate="{CurrentPageReport} {PreviousPageLink} {NextPageLink}"
                   currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords}">
        <p:ajax event="rowSelect" listener="#{DataEntryConfirmationView.onRowSelect}" update="@form:periodConfirmationSelectedView" oncomplete="PF('cdViewPeriodConfirmation').show()" />
        <p:column headerText="CORP EMPLOYER #" width="180" sortBy="#{rows.id.corporateEmployerNumber}">
          <h:outputText value="#{rows.id.corporateEmployerNumber}" />
        </p:column>
        <p:column headerText="SITE EMPLOYER #" width="170" sortBy="#{rows.id.siteEmployerNumber}">
          <h:outputText value="#{rows.id.siteEmployerNumber}" />
        </p:column>
        <p:column headerText="LEGAL NAME" sortBy="#{rows.membership.legalName}">
          <h:outputText value="#{DataEntryConfirmationView.truncateString(rows.membership.legalName, 47)}" title="#{rows.membership.legalName}" />
        </p:column>
        <p:column headerText="REPORTING FROM" width="175" sortBy="#{rows.id.reportingFrom}">
          <h:outputText value="#{DataEntryConfirmationView.convertDateToDisplay(rows.id.reportingFrom)}" />
        </p:column>
        <p:column headerText="REPORTING TO" width="150" sortBy="#{rows.id.reportingTo}">
          <h:outputText value="#{DataEntryConfirmationView.convertDateToDisplay(rows.id.reportingTo)}" />
        </p:column>
        <p:column headerText="SUBMIT DATE" width="145" sortBy="#{rows.createdOn}" sortOrder="desc">
          <h:outputText value="#{DataEntryConfirmationView.convertDateToDisplay(rows.createdOn)}" />
        </p:column>
      </p:dataTable>
      <p:confirmDialog id="periodConfirmationSelectedView" global="false" widgetVar="cdViewPeriodConfirmation" header="View Details" appendTo="@(body)" width="650px">
        <f:facet name="message">
          <p:panelGrid columns="2" styleClass="ui-noborder">
            <p:outputPanel>
              <p:outputLabel class="ui-g-label readonly" for="@next" value="Corp Employer #" />
              <p:inputText disabled="true" value="#{DataEntryConfirmationView.corporateEmployerNumber}" />
            </p:outputPanel>
            <p:outputPanel>
              <p:outputLabel class="ui-g-label readonly" for="@next" value="Site Employer #" />
              <p:inputText disabled="true" value="#{DataEntryConfirmationView.siteEmployerNumber}" />
            </p:outputPanel>
          </p:panelGrid>
          <p:panelGrid columns="1" styleClass="ui-noborder" style="width: 574px">
            <p:outputPanel>
              <p:outputLabel class="ui-g-label readonly" for="@next" value="Legal Name" />
              <p:inputText disabled="true" value="#{DataEntryConfirmationView.legalName}" style="pointer-events: all" title="#{DataEntryConfirmationView.legalName}" />
            </p:outputPanel>
          </p:panelGrid>
          <p:panelGrid columns="2" styleClass="ui-noborder">
            <p:outputPanel>
              <p:outputLabel class="ui-g-label readonly" for="@next" value="Reporting From" />
              <p:inputText disabled="true" value="#{DataEntryConfirmationView.reportingFrom}" />
            </p:outputPanel>
            <p:outputPanel>
              <p:outputLabel class="ui-g-label readonly" for="@next" value="Reporting To" />
              <p:inputText disabled="true" value="#{DataEntryConfirmationView.reportingTo}" />
            </p:outputPanel>
            <p:outputPanel>
              <p:outputLabel class="ui-g-label readonly" for="@next" value="Submit Date" />
              <p:inputText disabled="true" value="#{DataEntryConfirmationView.createdOn}" />
            </p:outputPanel>
            <p:outputPanel />
            <p:outputPanel>
              <p:commandButton value="Delete"
                               oncomplete="PF('cdDeletePeriodConfirmation').show()"
                               styleClass="danger" />
              <p:commandButton value="Cancel" type="button"
                               onclick="PF('cdViewPeriodConfirmation').hide();"
                               styleClass="ui-confirmdialog-no"
                               immediate="true" />
            </p:outputPanel>
          </p:panelGrid>
        </f:facet>
      </p:confirmDialog>
      <p:confirmDialog id="deleteConfirmation" global="false" widgetVar="cdDeletePeriodConfirmation" header="Confirm Delete" appendTo="@(body)" width="650px">
        <f:facet name="message">
          <p:outputPanel>
            <h:outputText id="confirmtext" value="Are you sure you want to delete?" escape="false" /> 
          </p:outputPanel>
        </f:facet>
        <p:commandButton value="Delete"
                         oncomplete="PF('cdViewPeriodConfirmation').hide(); PF('cdDeletePeriodConfirmation').hide()"
                         action="#{DataEntryConfirmationView.deleteConfirmationRow()}"
                         update="@widgetVar(tblDataEntryConfirmation)"
                         styleClass="danger" />
        <p:commandButton value="Cancel" type="button"
                         onclick="PF('cdDeletePeriodConfirmation').hide();"
                         styleClass="ui-confirmdialog-no"
                         immediate="true" />
      </p:confirmDialog>
    </h:form>
  </ui:define>
</ui:composition>