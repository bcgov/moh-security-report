import { t } from 'testcafe';
import { selectorById } from '../helpers/selector.helper';
import { extractDataFromTable } from '../helpers/table.helper';

export default class EnterPayrollSummaryPage {
    constructor () {
        this.enterPayrollLink = selectorById("enter-payroll-link");
        this.reportsPanel     = selectorById("summaryList");
        this.entryTableData   = selectorById("entryTable_data");
        this.createButton     = selectorById("create");
    }
    
    async clickEnterPayrollLink() {
        await t.click(this.enterPayrollLink);
    }
    
    async clickCreateButton() {
        await t.click(this.createButton);
    }
      
    payrollSummaryReports() {
        return this.entryTableData.find("tr");
    }
    
    async payrollSummaryReportsData() {
        return extractDataFromTable(this.entryTableData);
    }
    
    dataIndexOfPayrollSummary(data, corporateID, siteID, reportingPeriodFromDate, reportingPeriodToDate, payrollSummaryStatus) {
        for (let rowNumber = 0; rowNumber < data.length; rowNumber++) {
            let row = data[rowNumber];
            if (row.length === 6 &&
                row[0] == corporateID &&
                row[1] == siteID &&
                row[2] == reportingPeriodFromDate &&
                row[3] == reportingPeriodToDate &&
                row[5] == payrollSummaryStatus) {
                return rowNumber;
            }
        }
        return -1;
    }
    
    dataContainsPayrollSummary(data, corporateID, siteID, reportingPeriodFromDate, reportingPeriodToDate, payrollSummaryStatus) {
        return this.dataIndexOfPayrollSummary(data, corporateID, siteID, reportingPeriodFromDate, reportingPeriodToDate, payrollSummaryStatus) !== -1;
    }
}