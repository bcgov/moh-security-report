/*
 * *********************************************************************************************************************
 *  Copyright (c) 2020, Ministry of Health, BC.                                                                        *
 *                                                                                                                     *
 *  All rights reserved.                                                                                               *
 *    This information contained herein may not be used in whole                                                       *
 *    or in part without the express written consent of the                                                            *
 *    Government of British Columbia, Canada.                                                                          *
 *                                                                                                                     *
 *  Revision Control Information                                                                                       *
 *  File:                $Id:: OidcConfig.java 2932 2024-10-21 18:15:18Z ahoplock                                    $ *
 *  Date of Last Commit: $Date:: 2024-10-21 11:15:18 -0700 (Mon, 21 Oct 2024)                                        $ *
 *  Revision Number:     $Rev:: 2932                                                                                 $ *
 *  Last Commit by:      $Author:: ahoplock                                                                          $ *
 *                                                                                                                     *
 * *********************************************************************************************************************
 */
package ca.bc.gov.health.security;

import jakarta.annotation.PostConstruct;
import jakarta.annotation.Resource;
import jakarta.enterprise.context.ApplicationScoped;
import jakarta.inject.Named;
import java.util.Properties;

/**
 * Defines OpenId connect client configuration for Keycloak integration
 *
 * @author CGI Information Management Consultants Inc.
 */
@Named
@ApplicationScoped
public class OidcConfig {

    @Resource(lookup = "java:app/miwt/oidc_properties")
    Properties oidcProperties;

    private String providerUri;
    private String clientId;
    private String clientSecret;
    private String redirectUri;
    private String scope;
    private String callerGroupsClaim;
    private String callerNameClaim;
    private String siteminderLogoutUri;
    private String phsaLogoutUri;

    @PostConstruct
    private void init() {

        providerUri = oidcProperties.getProperty("providerUri");
        clientId = oidcProperties.getProperty("clientId");
        clientSecret = oidcProperties.getProperty("clientSecret");
        redirectUri = oidcProperties.getProperty("redirectUri");
        scope = oidcProperties.getProperty("scope");
        callerGroupsClaim = oidcProperties.getProperty("callerGroupsClaim");
        callerNameClaim = oidcProperties.getProperty("callerNameClaim");
        siteminderLogoutUri = oidcProperties.getProperty("siteminderLogoutUri");
        phsaLogoutUri = oidcProperties.getProperty("phsaLogoutUri");
    }

    public String getProviderUri() {
        return providerUri;
    }

    public String getClientId() {
        return clientId;
    }

    public String getClientSecret() {
        return clientSecret;
    }

    public String getRedirectUri() {
        return redirectUri;
    }

    public String getScope() {
        return scope;
    }

    public String getCallerGroupsClaim() {
        return callerGroupsClaim;
    }

    public String getCallerNameClaim() {
        return callerNameClaim;
    }

    public String getSiteminderLogoutUri() {
        return siteminderLogoutUri;
    }

    public String getPhsaLogoutUri() {
        return phsaLogoutUri;
    }

}
