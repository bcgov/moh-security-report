package mid.selenium.pageobjects.admin;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Comparator;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import mid.selenium.functional.util.ConvertStringToDateComparator;
import mid.selenium.functional.util.DbUtils;
import mid.selenium.functional.util.DbUtils.FieldValue;
import mid.selenium.functional.util.TableUtils;
import mid.selenium.functional.util.ValidationUtils;
import mid.selenium.pageobjects.fragment.LeftMenuCodeTables;
import org.openqa.selenium.By;
import org.openqa.selenium.NoSuchElementException;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.PageFactory;
import org.openqa.selenium.support.ui.LoadableComponent;
import selenium.util.ActionBot;
import selenium.util.Constants;
import static org.junit.Assert.*;

/**
 *
 * @author CGI Information Management Consultants Inc.
 */
public class MaintainFacilityCodeTablePage extends LoadableComponent<MaintainFacilityCodeTablePage> {

    public enum SUBMIT_BUTTONS {

        ADD, UPDATE
    }
    // DB Column names for the associated table
    public static final String DB_TABLE_NAME = "MIRD_FACILITY";
    public static final String DB_HEALTH_AUTHORITY_COLUMN = "HEALTH_AUTHORITY_ID";
    public static final String DB_FACILITY_ID_COLUMN = "FACILITY_ID";
    public static final String DB_FACILITY_NAME_COLUMN = "FACILITY_NM";
    public static final String DB_ADDRESS_LINE_1_COLUMN = "ADDRESS_LINE_1";
    public static final String DB_ADDRESS_LINE_2_COLUMN = "ADDRESS_LINE_2";
    public static final String DB_ADDRESS_LINE_3_COLUMN = "ADDRESS_LINE_3";
    public static final String DB_CITY_NAME_COLUMN = "CITY_NM";
    public static final String DB_POSTAL_CODE_COLUMN = "POSTAL_CODE_TXT";
    public static final String DB_HSDA_CODE_COLUMN = "HSDA_CD";
    public static final String DB_HSDA_NAME_COLUMN = "HSDA_NM";
    public static final String DB_LHA_CODE_COLUMN = "LHA_CD";
    public static final String DB_LHA_NAME_COLUMN = "LHA_NM";
    public static final String DB_EFFECTIVE_DT_COLUMN = "EFFECTIVE_DT";
    public static final String DB_EXPIRY_DT_COLUMN = "EXPIRY_DT";
    public static final String XPATH_FOR_HOME_PAGE_FORM = "//form[@id='form1' and contains(@action, 'MaintainFacility.xhtml')]";
    public static final String XPATH_FOR_HEALTH_AUTHORITY_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//select)[1]";
    public static final String XPATH_FOR_FACILITY_ID_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[1]";
    public static final String XPATH_FOR_FACILITY_NAME_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[2]";
    public static final String XPATH_FOR_ADDRESS_LINE_1_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[3]";
    public static final String XPATH_FOR_ADDRESS_LINE_2_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[4]";
    public static final String XPATH_FOR_ADDRESS_LINE_3_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[5]";
    public static final String XPATH_FOR_CITY_NAME_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[6]";
    public static final String XPATH_FOR_POSTAL_CODE_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[7]";
    public static final String XPATH_FOR_HSDA_CODE_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[8]";
    public static final String XPATH_FOR_HSDA_NAME_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[9]";
    public static final String XPATH_FOR_LHA_CODE_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[10]";
    public static final String XPATH_FOR_LHA_NAME_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[11]";
    public static final String XPATH_FOR_EFFECTIVE_DATE_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input[contains(@class, 'hasDatepicker')])[1]";
    public static final String XPATH_FOR_EFFECTIVE_DATE_CALENDAR_BUTTON = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input[contains(@class, 'hasDatepicker')])[1]/../button";
    public static final String XPATH_FOR_EXPIRY_DATE_FIELD = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input[contains(@class, 'hasDatepicker')])[2]";
    public static final String XPATH_FOR_EXPIRY_DATE_CALENDAR_BUTTON = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input[contains(@class, 'hasDatepicker')])[2]/../button";
    public static final String XPATH_FOR_ADD_BUTTON = "//button/span[text()='Add']/..";
    public static final String XPATH_FOR_UPDATE_BUTTON = "//button/span[text()='Update']/..";
    public static final String XPATH_FOR_CANCEL_BUTTON = "//button/span[text()='Cancel']/..";
    public static final String ID_FOR_RESULT_TABLE = "form1:listTable";
    public static final String XPATH_FOR_TABLE_ROWS = "//div[@id='" + ID_FOR_RESULT_TABLE + "']//tbody/tr";
    public static final String ID_FOR_BOTTOM_PAGINATOR = ID_FOR_RESULT_TABLE + "_paginator_bottom";
    public static final String XPATH_FOR_FACILITY_ID_FIELD_LENGTH_VALIDATION = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[1]/../span[@class='lengthWarn']";
    public static final String XPATH_FOR_FACILITY_NAME_FIELD_LENGTH_VALIDATION = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[2]/../span[@class='lengthWarn']";
    public static final String XPATH_FOR_ADDRESS_LINE_1_FIELD_LENGTH_VALIDATION = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[3]/../span[@class='lengthWarn']";
    public static final String XPATH_FOR_ADDRESS_LINE_2_FIELD_LENGTH_VALIDATION = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[4]/../span[@class='lengthWarn']";
    public static final String XPATH_FOR_ADDRESS_LINE_3_FIELD_LENGTH_VALIDATION = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[5]/../span[@class='lengthWarn']";
    public static final String XPATH_FOR_CITY_NAME_FIELD_LENGTH_VALIDATION = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[6]/../span[@class='lengthWarn']";
    public static final String XPATH_FOR_POSTAL_CODE_FIELD_LENGTH_VALIDATION = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[7]/../span[@class='lengthWarn']";
    public static final String XPATH_FOR_HSDA_CODE_FIELD_LENGTH_VALIDATION = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[8]/../span[@class='lengthWarn']";
    public static final String XPATH_FOR_HSDA_NAME_FIELD_LENGTH_VALIDATION = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[9]/../span[@class='lengthWarn']";
    public static final String XPATH_FOR_LHA_CODE_FIELD_LENGTH_VALIDATION = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[10]/../span[@class='lengthWarn']";
    public static final String XPATH_FOR_LHA_NAME_FIELD_LENGTH_VALIDATION = "(//div[@id='form1:entry']/div[@id='form1:entry_content']//tbody//input)[11]/../span[@class='lengthWarn']";
    public static final String XPATH_FOR_HEALTH_AUTHORITY_FIELD_VALIDATION_MSG = "//div[@id='content']//span[@class='ui-messages-error-summary' and contains(text(), 'Health Authority')]";
    public static final String XPATH_FOR_FACILITY_ID_VALIDATION_MSG = "//div[@id='content']//span[@class='ui-messages-error-summary' and contains(text(), 'Facility Id')]";
    public static final String XPATH_FOR_FACILITY_NAME_FIELD_VALIDATION_MSG = "//div[@id='content']//span[@class='ui-messages-error-summary' and contains(text(), 'Facility Name')]";
    public static final String XPATH_FOR_EFFECTIVE_DATE_VALIDATION_MSG = "//div[@id='content']//span[@class='ui-messages-error-summary' and contains(text(), 'Effective')]";
    public static final String XPATH_FOR_EXPIRY_DATE_VALIDATION_MSG = "//div[@id='content']//span[@class='ui-messages-error-summary' and contains(text(), 'Expiry')]";
    //Messages
    public static final String HEALTH_AUTHORITY_FIELD_REQUIRED = "Health Authority is required";
    public static final String FACILITY_ID_REQUIRED = "Facility Id is required";
    public static final String FACILITY_NAME_FIELD_REQUIRED = "Facility Name is required";
    public static final String FACILITY_ID_MAXIMUM_FIELD_LENGTH = "Maximum Field Length Reached for Facility Id";
    public static final String FACILITY_NAME_MAXIMUM_FIELD_LENGTH = "Maximum Field Length Reached for Facility Name";
    public static final String ADDRESS_LINE_1_MAXIMUM_FIELD_LENGTH = "Maximum Field Length Reached for Address Line 1";
    public static final String ADDRESS_LINE_2_MAXIMUM_FIELD_LENGTH = "Maximum Field Length Reached for Address Line 2";
    public static final String ADDRESS_LINE_3_MAXIMUM_FIELD_LENGTH = "Maximum Field Length Reached for Address Line 3";
    public static final String CITY_NAME_MAXIMUM_FIELD_LENGTH = "Maximum Field Length Reached for City Name";
    public static final String POSTAL_CODE_MAXIMUM_FIELD_LENGTH = "Maximum Field Length Reached for Postal Code";
    public static final String HSDA_CODE_MAXIMUM_FIELD_LENGTH = "Maximum Field Length Reached for HSDA Code";
    public static final String HSDA_NAME_MAXIMUM_FIELD_LENGTH = "Maximum Field Length Reached for HSDA Name";
    public static final String LHA_CODE_MAXIMUM_FIELD_LENGTH = "Maximum Field Length Reached for LHA Code";
    public static final String LHA_NAME_MAXIMUM_FIELD_LENGTH = "Maximum Field Length Reached for LHA Name";
    //Fragments and Selenium objects
    private final WebDriver driver;
    private String[] handles;
    private final ActionBot actionBot;
    private final String browser;
    private final LoadableComponent<?> parent;
    private final LeftMenuCodeTables leftMenuCodeTables;
    private List<Map<String, DbUtils.FieldValue>> insertedRecords = new ArrayList<>();

    public MaintainFacilityCodeTablePage(LoadableComponent<?> parent, LeftMenuCodeTables leftMenuCodeTables, WebDriver driver, String browser) {

        this.driver = driver;
        this.browser = browser;
        this.parent = parent;
        this.leftMenuCodeTables = leftMenuCodeTables;
        actionBot = new ActionBot(driver);


        PageFactory.initElements(driver, this);

    }

    @Override
    protected void load() {
        parent.get();
        actionBot.waitForLoadingUsingXpath(HomePageAdmin.XPATH_FOR_HOME_PAGE_FORM, Constants.SHORT_TIMEOUT);
        leftMenuCodeTables.openMenu();
        leftMenuCodeTables.showMaintainFacilityForm();
    }

    @Override
    protected void isLoaded() throws Error {

        try {
            driver.findElement(By.xpath(ID_FOR_RESULT_TABLE));
            assert true;
        } catch (NoSuchElementException e) {
            load();
        }
    }

    public void submitForm(SUBMIT_BUTTONS button) {

        if (SUBMIT_BUTTONS.ADD.equals(button)) {
            actionBot.click(driver.findElement(By.xpath(XPATH_FOR_ADD_BUTTON)));
        } else if (SUBMIT_BUTTONS.UPDATE.equals(button)) {
            actionBot.click(driver.findElement(By.xpath(XPATH_FOR_UPDATE_BUTTON)));
        }
    }

    public void cancelForm() {
        actionBot.click(driver.findElement(By.xpath(XPATH_FOR_CANCEL_BUTTON)));
    }

    public void selectRecord(String... searchParameters) {
        TableUtils.selectRecord(searchParameters, ID_FOR_RESULT_TABLE, "//div[@id='" + ID_FOR_RESULT_TABLE + "']//tbody/tr", ID_FOR_BOTTOM_PAGINATOR, driver, actionBot);
    }

    public void selectRecord() {
        TableUtils.selectRecord(ID_FOR_RESULT_TABLE, "//div[@id='" + ID_FOR_RESULT_TABLE + "']//tbody/tr", ID_FOR_BOTTOM_PAGINATOR, driver, actionBot);
    }

    public void addRecord(String healthAuthority, String facilityId, String facilityName, String addressLine1, String addressLine2, String addressLine3, String cityName, String postalCode, String hsdaCode, String hsdaName, String lhaCode, String lhaName, String effectiveDate) {

        actionBot.selectByDisplayedText(driver.findElement(By.xpath(XPATH_FOR_HEALTH_AUTHORITY_FIELD)), healthAuthority);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_FACILITY_ID_FIELD)), facilityId);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_FACILITY_NAME_FIELD)), facilityName);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_ADDRESS_LINE_1_FIELD)), addressLine1);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_ADDRESS_LINE_2_FIELD)), addressLine2);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_ADDRESS_LINE_3_FIELD)), addressLine3);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_CITY_NAME_FIELD)), cityName);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_POSTAL_CODE_FIELD)), postalCode);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_HSDA_CODE_FIELD)), hsdaCode);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_HSDA_NAME_FIELD)), hsdaName);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_LHA_CODE_FIELD)), lhaCode);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_LHA_NAME_FIELD)), lhaName);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_EFFECTIVE_DATE_FIELD)), effectiveDate);

        try {
            // Ensure we can parse the date string to avoid db errors
            SimpleDateFormat format = new SimpleDateFormat(Constants.DATE_FORMATTER);
            format.parse(effectiveDate);

            // No Health Authority value, this record is most like a negative test that may result in database errors when attempting to clean up
            // therefore, no need to track it
            if (healthAuthority != null && !healthAuthority.isEmpty()) {
                Map<String, FieldValue> data = new HashMap<>();
                data.put(DB_HEALTH_AUTHORITY_COLUMN, new DbUtils.FieldValue(DbUtils.TYPE.NUMBER, actionBot.findValueForDisplayedText(driver.findElement(By.xpath(XPATH_FOR_HEALTH_AUTHORITY_FIELD)), healthAuthority)));
                data.put(DB_FACILITY_ID_COLUMN, new DbUtils.FieldValue(DbUtils.TYPE.NUMBER, facilityId));
                data.put(DB_FACILITY_NAME_COLUMN, new DbUtils.FieldValue(DbUtils.TYPE.STRING, facilityName));
                data.put(DB_ADDRESS_LINE_1_COLUMN, new DbUtils.FieldValue(DbUtils.TYPE.STRING, addressLine1));
                data.put(DB_ADDRESS_LINE_2_COLUMN, new DbUtils.FieldValue(DbUtils.TYPE.STRING, addressLine2));
                data.put(DB_ADDRESS_LINE_3_COLUMN, new DbUtils.FieldValue(DbUtils.TYPE.STRING, addressLine3));
                data.put(DB_CITY_NAME_COLUMN, new DbUtils.FieldValue(DbUtils.TYPE.STRING, cityName));
                data.put(DB_POSTAL_CODE_COLUMN, new DbUtils.FieldValue(DbUtils.TYPE.STRING, postalCode));
                data.put(DB_HSDA_CODE_COLUMN, new DbUtils.FieldValue(DbUtils.TYPE.STRING, hsdaCode));
                data.put(DB_HSDA_NAME_COLUMN, new DbUtils.FieldValue(DbUtils.TYPE.STRING, hsdaName));
                data.put(DB_LHA_CODE_COLUMN, new DbUtils.FieldValue(DbUtils.TYPE.STRING, lhaCode));
                data.put(DB_LHA_NAME_COLUMN, new DbUtils.FieldValue(DbUtils.TYPE.STRING, lhaName));
                data.put(DB_EFFECTIVE_DT_COLUMN, new DbUtils.FieldValue(DbUtils.TYPE.DATE, effectiveDate));

                insertedRecords.add(data);
            }
        } catch (ParseException pe) {
        }
    }

    public void addRecord(String healthAuthority, String facilityId, String facilityName, String addressLine1, String addressLine2, String addressLine3, String cityName, String postalCode, String hsdaCode, String hsdaName, String lhaCode, String lhaName, String effectiveDate, String expiryDate) {
        addRecord(healthAuthority, facilityId, facilityName, addressLine1, addressLine2, addressLine3, cityName, postalCode, hsdaCode, hsdaName, lhaCode, lhaName, effectiveDate);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_EXPIRY_DATE_FIELD)), expiryDate);

    }

    public void updateRecord(String healthAuthority, String facilityId, String facilityName, String addressLine1, String addressLine2, String addressLine3, String cityName, String postalCode, String hsdaCode, String hsdaName, String lhaCode, String lhaName, String effectiveDate) {
        addRecord(healthAuthority, facilityId, facilityName, addressLine1, addressLine2, addressLine3, cityName, postalCode, hsdaCode, hsdaName, lhaCode, lhaName, effectiveDate);
    }

    public void updateRecord(String healthAuthority, String facilityId, String facilityName, String addressLine1, String addressLine2, String addressLine3, String cityName, String postalCode, String hsdaCode, String hsdaName, String lhaCode, String lhaName, String effectiveDate, String expiryDate) {
        updateRecord(healthAuthority, facilityId, facilityName, addressLine1, addressLine2, addressLine3, cityName, postalCode, hsdaCode, hsdaName, lhaCode, lhaName, effectiveDate);
        actionBot.type(driver.findElement(By.xpath(XPATH_FOR_EXPIRY_DATE_FIELD)), expiryDate);
    }

    public boolean doesRecordExist(String... searchParameters) {
        return TableUtils.doesRecordExist(searchParameters, ID_FOR_RESULT_TABLE, "//div[@id='" + ID_FOR_RESULT_TABLE + "']//tbody/tr", ID_FOR_BOTTOM_PAGINATOR, driver, actionBot);
    }

    public void assertPageLoaded() {
        try {

            driver.findElement(By.id(ID_FOR_RESULT_TABLE));
            assert driver.getCurrentUrl().endsWith("MaintainFacility.xhtml") : "URL in address bar is not pointin to MaintainFacility.xhtml page";
        } catch (NoSuchElementException nse) {
            assert false : "Maintain Priority Level (CodeTables) is not being loaded";
        }
    }

    public void assertNoGlobalValidationErrors() {
        try {
            driver.findElement(By.xpath(ValidationUtils.XPATH_FOR_GLOBAL_VALIDATION_MSG));
            assert false : "No error message expected to be displayed";
        } catch (NoSuchElementException nse) {
            assert true;
        }
    }

    public void assertFieldsAreReset() {
        assert actionBot.valueForCurrentSelection(driver.findElement(By.xpath(XPATH_FOR_HEALTH_AUTHORITY_FIELD))).isEmpty() : "Health Authority field must be empty after pressing cancel button";
        assert driver.findElement(By.xpath(XPATH_FOR_FACILITY_ID_FIELD)).getAttribute("value").isEmpty() : "Facility Id field must be empty after pressing cancel button";
        assert driver.findElement(By.xpath(XPATH_FOR_FACILITY_NAME_FIELD)).getAttribute("value").isEmpty() : "Facility Name field must be empty after pressing cancel button";
        assert driver.findElement(By.xpath(XPATH_FOR_ADDRESS_LINE_1_FIELD)).getAttribute("value").isEmpty() : "Address Line 1 field must be empty after pressing cancel button";
        assert driver.findElement(By.xpath(XPATH_FOR_ADDRESS_LINE_2_FIELD)).getAttribute("value").isEmpty() : "Address Line 2 field must be empty after pressing cancel button";
        assert driver.findElement(By.xpath(XPATH_FOR_ADDRESS_LINE_3_FIELD)).getAttribute("value").isEmpty() : "Address Line 3 field must be empty after pressing cancel button";
        assert driver.findElement(By.xpath(XPATH_FOR_CITY_NAME_FIELD)).getAttribute("value").isEmpty() : "City Name field must be empty after pressing cancel button";
        assert driver.findElement(By.xpath(XPATH_FOR_POSTAL_CODE_FIELD)).getAttribute("value").isEmpty() : "Postal Code field must be empty after pressing cancel button";
        assert driver.findElement(By.xpath(XPATH_FOR_HSDA_CODE_FIELD)).getAttribute("value").isEmpty() : "HSDA Code field must be empty after pressing cancel button";
        assert driver.findElement(By.xpath(XPATH_FOR_HSDA_NAME_FIELD)).getAttribute("value").isEmpty() : "HSDA Name field must be empty after pressing cancel button";
        assert driver.findElement(By.xpath(XPATH_FOR_LHA_CODE_FIELD)).getAttribute("value").isEmpty() : "LHA Code field must be empty after pressing cancel button";
        assert driver.findElement(By.xpath(XPATH_FOR_LHA_NAME_FIELD)).getAttribute("value").isEmpty() : "LHA Name field must be empty after pressing cancel button";
        assert driver.findElement(By.xpath(XPATH_FOR_EFFECTIVE_DATE_FIELD)).getAttribute("value").isEmpty() : "Effective Date field must be empty after pressing cancel button";
        assert driver.findElement(By.xpath(XPATH_FOR_EXPIRY_DATE_FIELD)).getAttribute("value").isEmpty() : "Expiry Date field must be empty after pressing cancel button";

    }

    public void assertRecordExist(String healthAuthority, String facilityId, String facilityName, String addressLine1, String addressLine2, String addressLine3, String cityName, String postalCode, String hsdaCode, String hsdaName, String lhaCode, String lhaName, String effectiveDate) {
        assert doesRecordExist(facilityId, facilityName, addressLine1, addressLine2, addressLine3, cityName, postalCode, hsdaCode, hsdaName, lhaCode, lhaName, effectiveDate) : String.format("Entry with the values '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s' and '%s' does not exist", healthAuthority, facilityId, facilityName, addressLine1, addressLine2, addressLine3, cityName, postalCode, hsdaCode, hsdaName, lhaCode, lhaName, effectiveDate);
    }

    public void assertRecordDoesNotExist(String facilityId, String facilityName, String addressLine1, String addressLine2, String addressLine3, String cityName, String postalCode, String hsdaCode, String hsdaName, String lhaCode, String lhaName, String effectiveDate) {
        assert !doesRecordExist(facilityId, facilityName, addressLine1, addressLine2, addressLine3, cityName, postalCode, hsdaCode, hsdaName, lhaCode, lhaName, effectiveDate) : String.format("Entry with the values '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s' and '%s' does not exist", facilityId, facilityName, addressLine1, addressLine2, addressLine3, cityName, postalCode, hsdaCode, hsdaName, lhaCode, lhaName, effectiveDate);
    }

    public void assertRecordExist(String healthAuthority, String facilityId, String facilityName, String addressLine1, String addressLine2, String addressLine3, String cityName, String postalCode, String hsdaCode, String hsdaName, String lhaCode, String lhaName, String effectiveDate, String expiryDate) {
        assert doesRecordExist(facilityId, facilityName, addressLine1, addressLine2, addressLine3, cityName, postalCode, hsdaCode, hsdaName, lhaCode, lhaName, effectiveDate, expiryDate) : String.format("Entry with the values '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s' and '%s' does not exist", healthAuthority, facilityId, facilityName, addressLine1, addressLine2, addressLine3, cityName, postalCode, hsdaCode, hsdaName, lhaCode, lhaName, effectiveDate, expiryDate);
    }

    public void assertEntryUpdatedSuccessfully(String healthAuthority, String facilityId, String facilityName, String addressLine1, String addressLine2, String addressLine3, String cityName, String postalCode, String hsdaCode, String hsdaName, String lhaCode, String lhaName, String effectiveDate, String expiryDate) {
        assertRecordExist(facilityId, facilityName, addressLine1, addressLine2, addressLine3, cityName, postalCode, hsdaCode, hsdaName, lhaCode, lhaName, effectiveDate, expiryDate);
    }

    public void assertAddSuccessfulMessageDisplayed() {
        ValidationUtils.assertMessageIsDisplayed(ValidationUtils.XPATH_SUCCESSFUL_MSG, ValidationUtils.ADD_SUCCESSFUL, driver);
    }

    public void assertUpdateSuccessfulMessageDisplayed() {

        try {
            driver.findElement(By.xpath(ValidationUtils.XPATH_FOR_GLOBAL_VALIDATION_MSG));
            assert false : "No error message expected to be displayed";
        } catch (NoSuchElementException nse) {
            assert true;
        }
    }

    public void assertValidationErrorDisplayed(String message) {


        switch (message) {
            case HEALTH_AUTHORITY_FIELD_REQUIRED:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_HEALTH_AUTHORITY_FIELD_VALIDATION_MSG, HEALTH_AUTHORITY_FIELD_REQUIRED, driver);
                break;
            case FACILITY_ID_REQUIRED:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_FACILITY_ID_VALIDATION_MSG, FACILITY_ID_REQUIRED, driver);
                break;
            case FACILITY_NAME_FIELD_REQUIRED:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_FACILITY_NAME_FIELD_VALIDATION_MSG, FACILITY_NAME_FIELD_REQUIRED, driver);
                break;
            case ValidationUtils.EFFECTIVE_DATE_REQUIRED:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_EFFECTIVE_DATE_VALIDATION_MSG, ValidationUtils.EFFECTIVE_DATE_REQUIRED, driver);
                break;
            case ValidationUtils.EFFECTIVE_DATE_INVALID:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_EFFECTIVE_DATE_VALIDATION_MSG, ValidationUtils.EFFECTIVE_DATE_INVALID, driver);
                break;
            case ValidationUtils.EXPIRY_DATE_INVALID:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_EXPIRY_DATE_VALIDATION_MSG, ValidationUtils.EXPIRY_DATE_INVALID, driver);
                break;
            case ValidationUtils.EXPIRY_MUST_BE_GREATER_THAN_EFFECTIVE_DATE:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_EXPIRY_DATE_VALIDATION_MSG, ValidationUtils.EXPIRY_MUST_BE_GREATER_THAN_EFFECTIVE_DATE, driver);
                break;
            case FACILITY_ID_MAXIMUM_FIELD_LENGTH:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_FACILITY_ID_FIELD_LENGTH_VALIDATION, ValidationUtils.MAXIMUM_FIELD_LENGTH_REACHED, driver);
                break;
            case FACILITY_NAME_MAXIMUM_FIELD_LENGTH:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_FACILITY_NAME_FIELD_LENGTH_VALIDATION, ValidationUtils.MAXIMUM_FIELD_LENGTH_REACHED, driver);
                break;
            case ADDRESS_LINE_1_MAXIMUM_FIELD_LENGTH:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_ADDRESS_LINE_1_FIELD_LENGTH_VALIDATION, ValidationUtils.MAXIMUM_FIELD_LENGTH_REACHED, driver);
                break;
            case ADDRESS_LINE_2_MAXIMUM_FIELD_LENGTH:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_ADDRESS_LINE_2_FIELD_LENGTH_VALIDATION, ValidationUtils.MAXIMUM_FIELD_LENGTH_REACHED, driver);
                break;
            case ADDRESS_LINE_3_MAXIMUM_FIELD_LENGTH:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_ADDRESS_LINE_3_FIELD_LENGTH_VALIDATION, ValidationUtils.MAXIMUM_FIELD_LENGTH_REACHED, driver);
                break;
            case CITY_NAME_MAXIMUM_FIELD_LENGTH:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_CITY_NAME_FIELD_LENGTH_VALIDATION, ValidationUtils.MAXIMUM_FIELD_LENGTH_REACHED, driver);
                break;
            case POSTAL_CODE_MAXIMUM_FIELD_LENGTH:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_POSTAL_CODE_FIELD_LENGTH_VALIDATION, ValidationUtils.MAXIMUM_FIELD_LENGTH_REACHED, driver);
                break;
            case HSDA_CODE_MAXIMUM_FIELD_LENGTH:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_HSDA_CODE_FIELD_LENGTH_VALIDATION, ValidationUtils.MAXIMUM_FIELD_LENGTH_REACHED, driver);
                break;
            case HSDA_NAME_MAXIMUM_FIELD_LENGTH:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_HSDA_NAME_FIELD_LENGTH_VALIDATION, ValidationUtils.MAXIMUM_FIELD_LENGTH_REACHED, driver);
                break;
            case LHA_CODE_MAXIMUM_FIELD_LENGTH:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_LHA_CODE_FIELD_LENGTH_VALIDATION, ValidationUtils.MAXIMUM_FIELD_LENGTH_REACHED, driver);
                break;
            case LHA_NAME_MAXIMUM_FIELD_LENGTH:
                ValidationUtils.assertMessageIsDisplayed(XPATH_FOR_LHA_NAME_FIELD_LENGTH_VALIDATION, ValidationUtils.MAXIMUM_FIELD_LENGTH_REACHED, driver);
                break;

        }

    }

    public void assertNoMaximumLengthValidationErrorDisplayed() {

        try {

            driver.findElement(By.xpath(XPATH_FOR_FACILITY_ID_FIELD_LENGTH_VALIDATION));
            assert false : ValidationUtils.MAXIMUM_FIELD_LENGTH_VALIDATION_MSG_NOT_EXPECTED;
        } catch (NoSuchElementException nse) {
            assert true;
        }

        try {

            driver.findElement(By.xpath(XPATH_FOR_FACILITY_NAME_FIELD_LENGTH_VALIDATION));
            assert false : ValidationUtils.MAXIMUM_FIELD_LENGTH_VALIDATION_MSG_NOT_EXPECTED;
        } catch (NoSuchElementException nse) {
            assert true;
        }

        try {

            driver.findElement(By.xpath(XPATH_FOR_ADDRESS_LINE_1_FIELD_LENGTH_VALIDATION));
            assert false : ValidationUtils.MAXIMUM_FIELD_LENGTH_VALIDATION_MSG_NOT_EXPECTED;
        } catch (NoSuchElementException nse) {
            assert true;
        }

        try {

            driver.findElement(By.xpath(XPATH_FOR_ADDRESS_LINE_2_FIELD_LENGTH_VALIDATION));
            assert false : ValidationUtils.MAXIMUM_FIELD_LENGTH_VALIDATION_MSG_NOT_EXPECTED;
        } catch (NoSuchElementException nse) {
            assert true;
        }

        try {

            driver.findElement(By.xpath(XPATH_FOR_ADDRESS_LINE_3_FIELD_LENGTH_VALIDATION));
            assert false : ValidationUtils.MAXIMUM_FIELD_LENGTH_VALIDATION_MSG_NOT_EXPECTED;
        } catch (NoSuchElementException nse) {
            assert true;
        }

        try {

            driver.findElement(By.xpath(XPATH_FOR_CITY_NAME_FIELD_LENGTH_VALIDATION));
            assert false : ValidationUtils.MAXIMUM_FIELD_LENGTH_VALIDATION_MSG_NOT_EXPECTED;
        } catch (NoSuchElementException nse) {
            assert true;
        }

        try {

            driver.findElement(By.xpath(XPATH_FOR_POSTAL_CODE_FIELD_LENGTH_VALIDATION));
            assert false : ValidationUtils.MAXIMUM_FIELD_LENGTH_VALIDATION_MSG_NOT_EXPECTED;
        } catch (NoSuchElementException nse) {
            assert true;
        }

        try {

            driver.findElement(By.xpath(XPATH_FOR_HSDA_CODE_FIELD_LENGTH_VALIDATION));
            assert false : ValidationUtils.MAXIMUM_FIELD_LENGTH_VALIDATION_MSG_NOT_EXPECTED;
        } catch (NoSuchElementException nse) {
            assert true;
        }

        try {

            driver.findElement(By.xpath(XPATH_FOR_HSDA_NAME_FIELD_LENGTH_VALIDATION));
            assert false : ValidationUtils.MAXIMUM_FIELD_LENGTH_VALIDATION_MSG_NOT_EXPECTED;
        } catch (NoSuchElementException nse) {
            assert true;
        }

        try {

            driver.findElement(By.xpath(XPATH_FOR_LHA_CODE_FIELD_LENGTH_VALIDATION));
            assert false : ValidationUtils.MAXIMUM_FIELD_LENGTH_VALIDATION_MSG_NOT_EXPECTED;
        } catch (NoSuchElementException nse) {
            assert true;
        }

        try {

            driver.findElement(By.xpath(XPATH_FOR_LHA_NAME_FIELD_LENGTH_VALIDATION));
            assert false : ValidationUtils.MAXIMUM_FIELD_LENGTH_VALIDATION_MSG_NOT_EXPECTED;
        } catch (NoSuchElementException nse) {
            assert true;
        }

    }

    public void assertTableSortingWorks() {

        Comparator dateComparator = new ConvertStringToDateComparator("dd-MMM-yyyy");
        // Sorting for Facility Id Column
        int columPosition = 1;
        String xpathForColumnTobeSorted = "(//div[@id='" + ID_FOR_RESULT_TABLE + "']//th)[" + columPosition + "]";
        String columnName = "Facility Id";
        TableUtils.testColumnSortingWorks(ID_FOR_RESULT_TABLE, xpathForColumnTobeSorted, ID_FOR_BOTTOM_PAGINATOR, columnName, columPosition, null, driver, actionBot);

        // Sorting for Facility Name Column
        columPosition = 2;
        xpathForColumnTobeSorted = "(//div[@id='" + ID_FOR_RESULT_TABLE + "']//th)[" + columPosition + "]";
        columnName = "Facility Name";
        TableUtils.testColumnSortingWorks(ID_FOR_RESULT_TABLE, xpathForColumnTobeSorted, ID_FOR_BOTTOM_PAGINATOR, columnName, columPosition, null, driver, actionBot);

        // Sorting for Address Line 1 Column
        columPosition = 3;
        xpathForColumnTobeSorted = "(//div[@id='" + ID_FOR_RESULT_TABLE + "']//th)[" + columPosition + "]";
        columnName = "Address Line 1";
        TableUtils.testColumnSortingWorks(ID_FOR_RESULT_TABLE, xpathForColumnTobeSorted, ID_FOR_BOTTOM_PAGINATOR, columnName, columPosition, null, driver, actionBot);

        // Sorting for Address Line 2 Column
        columPosition = 4;
        xpathForColumnTobeSorted = "(//div[@id='" + ID_FOR_RESULT_TABLE + "']//th)[" + columPosition + "]";
        columnName = "Address Line 2";
        TableUtils.testColumnSortingWorks(ID_FOR_RESULT_TABLE, xpathForColumnTobeSorted, ID_FOR_BOTTOM_PAGINATOR, columnName, columPosition, null, driver, actionBot);

        // Sorting for Address Line 3 Column
        columPosition = 5;
        xpathForColumnTobeSorted = "(//div[@id='" + ID_FOR_RESULT_TABLE + "']//th)[" + columPosition + "]";
        columnName = "Address Line 3";
        TableUtils.testColumnSortingWorks(ID_FOR_RESULT_TABLE, xpathForColumnTobeSorted, ID_FOR_BOTTOM_PAGINATOR, columnName, columPosition, null, driver, actionBot);

        // Sorting for City Name Column
        columPosition = 6;
        xpathForColumnTobeSorted = "(//div[@id='" + ID_FOR_RESULT_TABLE + "']//th)[" + columPosition + "]";
        columnName = "City Name";
        TableUtils.testColumnSortingWorks(ID_FOR_RESULT_TABLE, xpathForColumnTobeSorted, ID_FOR_BOTTOM_PAGINATOR, columnName, columPosition, null, driver, actionBot);

        // Sorting for Postal Code Column
        columPosition = 7;
        xpathForColumnTobeSorted = "(//div[@id='" + ID_FOR_RESULT_TABLE + "']//th)[" + columPosition + "]";
        columnName = "Postal Code";
        TableUtils.testColumnSortingWorks(ID_FOR_RESULT_TABLE, xpathForColumnTobeSorted, ID_FOR_BOTTOM_PAGINATOR, columnName, columPosition, null, driver, actionBot);

        // Sorting for HSDA Code Column
        columPosition = 8;
        xpathForColumnTobeSorted = "(//div[@id='" + ID_FOR_RESULT_TABLE + "']//th)[" + columPosition + "]";
        columnName = "HSDA Code";
        TableUtils.testColumnSortingWorks(ID_FOR_RESULT_TABLE, xpathForColumnTobeSorted, ID_FOR_BOTTOM_PAGINATOR, columnName, columPosition, null, driver, actionBot);

        // Sorting for HSDA Name Column
        columPosition = 9;
        xpathForColumnTobeSorted = "(//div[@id='" + ID_FOR_RESULT_TABLE + "']//th)[" + columPosition + "]";
        columnName = "HSDA Name";
        TableUtils.testColumnSortingWorks(ID_FOR_RESULT_TABLE, xpathForColumnTobeSorted, ID_FOR_BOTTOM_PAGINATOR, columnName, columPosition, null, driver, actionBot);

        // Sorting for LHA Code Column
        columPosition = 10;
        xpathForColumnTobeSorted = "(//div[@id='" + ID_FOR_RESULT_TABLE + "']//th)[" + columPosition + "]";
        columnName = "LHA Code";
        TableUtils.testColumnSortingWorks(ID_FOR_RESULT_TABLE, xpathForColumnTobeSorted, ID_FOR_BOTTOM_PAGINATOR, columnName, columPosition, null, driver, actionBot);

        // Sorting for LHA Name Column
        columPosition = 11;
        xpathForColumnTobeSorted = "(//div[@id='" + ID_FOR_RESULT_TABLE + "']//th)[" + columPosition + "]";
        columnName = "LHA Name";
        TableUtils.testColumnSortingWorks(ID_FOR_RESULT_TABLE, xpathForColumnTobeSorted, ID_FOR_BOTTOM_PAGINATOR, columnName, columPosition, null, driver, actionBot);

        // Sorting for effective date Column
        columPosition = 12;
        xpathForColumnTobeSorted = "(//div[@id='" + ID_FOR_RESULT_TABLE + "']//th)[" + columPosition + "]";
        columnName = "Effective Date";
        TableUtils.testColumnSortingWorks(ID_FOR_RESULT_TABLE, xpathForColumnTobeSorted, ID_FOR_BOTTOM_PAGINATOR, columnName, columPosition, dateComparator, driver, actionBot);

        // Sorting for Expiry date Column
        columPosition = 13;
        xpathForColumnTobeSorted = "(//div[@id='" + ID_FOR_RESULT_TABLE + "']//th)[" + columPosition + "]";
        columnName = "Expiry Date";
        TableUtils.testColumnSortingWorks(ID_FOR_RESULT_TABLE, xpathForColumnTobeSorted, ID_FOR_BOTTOM_PAGINATOR, columnName, columPosition, dateComparator, driver, actionBot);

    }

    public void assertTablePaginationWorks() {
        int pages = TableUtils.noOfPagesInDataScroller(ID_FOR_BOTTOM_PAGINATOR, driver);

        if (pages > 1) {
            TableUtils.testTablePagination(ID_FOR_RESULT_TABLE, ID_FOR_BOTTOM_PAGINATOR, driver, actionBot);
        }
    }

    public void assertRecordSelectionWorks() {
        String[] xpathForFields = {XPATH_FOR_HEALTH_AUTHORITY_FIELD, XPATH_FOR_FACILITY_ID_FIELD, XPATH_FOR_FACILITY_NAME_FIELD, XPATH_FOR_ADDRESS_LINE_1_FIELD, XPATH_FOR_ADDRESS_LINE_2_FIELD, XPATH_FOR_ADDRESS_LINE_3_FIELD, XPATH_FOR_CITY_NAME_FIELD, XPATH_FOR_POSTAL_CODE_FIELD, XPATH_FOR_HSDA_CODE_FIELD, XPATH_FOR_HSDA_NAME_FIELD, XPATH_FOR_LHA_CODE_FIELD, XPATH_FOR_LHA_NAME_FIELD, XPATH_FOR_EFFECTIVE_DATE_FIELD, XPATH_FOR_EXPIRY_DATE_FIELD};
        //   TableUtils.testRecordSelectionWorks(ID_FOR_RESULT_TABLE, XPATH_FOR_TABLE_ROWS, xpathForFields, ID_FOR_BOTTOM_PAGINATOR, XPATH_FOR_UPDATE_BUTTON, XPATH_FOR_ADD_BUTTON, XPATH_FOR_CANCEL_BUTTON, driver, actionBot);

        int pages = 3; // process maximum of 3 pages

        if (pages > 1) {
            //Ensure we start from the first page in table
            TableUtils.goToFirstPageInTableUsingFirstButton(ID_FOR_RESULT_TABLE, ID_FOR_BOTTOM_PAGINATOR, driver, actionBot);
        }

        for (int i = 1; i <= pages; i++) {
            int rowsOnPage = driver.findElements(By.xpath(XPATH_FOR_TABLE_ROWS)).size();
            for (int j = 1; j <= rowsOnPage; j++) {
                actionBot.click(By.xpath(XPATH_FOR_TABLE_ROWS + "[" + j + "]/td[last()]/button"));
                actionBot.waitForLoadingUsingXpath(XPATH_FOR_UPDATE_BUTTON, Constants.MEDIUM_TIMEOUT);

                List<WebElement> elems = driver.findElements(By.xpath(XPATH_FOR_TABLE_ROWS + "[" + j + "]/td"));
                int size = elems.size() - 1;  // avoid the last column, which holds the select button

                for (int x = 0; x < size; x++) {

                    if (x == 0) {
                        // Since we are looking at Health Authority Column, we need to check against the code displayed in column against
                        // the value for the current selection in the Health Authority dropdown
                        assertEquals(elems.get(x).getText(), actionBot.valueForCurrentSelection(driver.findElement(By.xpath(XPATH_FOR_HEALTH_AUTHORITY_FIELD))));
                    } else {
                        assertEquals(elems.get(x).getText(), driver.findElement(By.xpath(xpathForFields[x])).getAttribute("value"));
                    }

                }

                actionBot.click(By.xpath(XPATH_FOR_CANCEL_BUTTON));
                actionBot.waitForLoadingUsingXpath(XPATH_FOR_ADD_BUTTON, Constants.MEDIUM_TIMEOUT);
            }

            if (pages > 1 && TableUtils.morePagesAvailable(ID_FOR_BOTTOM_PAGINATOR, driver)) {
                // goToNextPageInTableUsingNextButton(tableId, paginatorId, driver, actionBot);
                TableUtils.nextPage(ID_FOR_RESULT_TABLE, ID_FOR_BOTTOM_PAGINATOR, driver, actionBot);
            }
        }
    }

    public void cleanup() {
        DbUtils.executeStatement(DB_TABLE_NAME, "DELETE", insertedRecords);
    }
}
