package mid.selenium.pageobjects.fragment;


import org.openqa.selenium.By;
import org.openqa.selenium.NoSuchElementException;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.PageFactory;
import org.openqa.selenium.support.ui.LoadableComponent;
import selenium.util.ActionBot;

/**
 *
 * @author CGI Information Management Consultants Inc.
 */
public class LeftMenuReports extends LoadableComponent<LeftMenuReports> {
    
    
    public static final String XPATH_FOR_WAIT_TIMES_REPORT_LINK = "//a[contains(@href, 'WaitTimes.xhtml')]";
    public static final String XPATH_FOR_CASE_DISTRIBUTION_REPORT_LINK = "//a[contains(@href, 'CaseDistribution.xhtml')]";   


    private final WebDriver driver;
    private String handle;
    private final ActionBot actionBot;
    private final String browser;
     

    public LeftMenuReports(WebDriver driver, String browser) {
        this.driver = driver;
        this.browser = browser;
        actionBot = new ActionBot(driver);
        
        PageFactory.initElements(driver, this);
    }

    @Override
    protected void load() {
        PageFactory.initElements(driver, this);
    }

    @Override
    protected void isLoaded() throws Error {

        try {
            driver.findElement(By.xpath(XPATH_FOR_WAIT_TIMES_REPORT_LINK));
            driver.findElement(By.xpath(XPATH_FOR_CASE_DISTRIBUTION_REPORT_LINK));
            assert true;
        } catch (NoSuchElementException e) {
            load();

        }
    }
    
    public void setHandle(String handle) {
        this.handle = handle;
    }

    public void showWaitTimesReport() {
        actionBot.click(driver.findElement(By.xpath(XPATH_FOR_WAIT_TIMES_REPORT_LINK)));
    }
    
    public void showCaseDistributionReport() {
        actionBot.click(driver.findElement(By.xpath(XPATH_FOR_CASE_DISTRIBUTION_REPORT_LINK)));
    }
  
    public void assertNotLoaded() {
        try {
            driver.findElement(By.xpath(XPATH_FOR_WAIT_TIMES_REPORT_LINK));
            assert false : "Wait Times Report Link is being displayed when it should not";
        } catch(NoSuchElementException nse) {
            assert true;
        }
        
        try {
            driver.findElement(By.xpath(XPATH_FOR_CASE_DISTRIBUTION_REPORT_LINK));
            assert false : "Case distrution Report Link is being displayed when it should not";
        } catch(NoSuchElementException nse) {
            assert true;
        }
    }
    
    public void assertLoaded() {
        try {
            driver.findElement(By.xpath(XPATH_FOR_WAIT_TIMES_REPORT_LINK));
            assert true;
        } catch(NoSuchElementException nse) {            
            assert false : "Wait Times Report Link is not being displayed when it should be";
        }
        
        try {
            driver.findElement(By.xpath(XPATH_FOR_CASE_DISTRIBUTION_REPORT_LINK));
            assert true;
        } catch(NoSuchElementException nse) {
            assert false : "Case distrution Report Link is not being displayed when it should be";            
        }
    }
}
