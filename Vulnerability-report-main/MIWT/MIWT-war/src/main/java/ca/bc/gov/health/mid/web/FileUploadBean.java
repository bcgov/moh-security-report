package ca.bc.gov.health.mid.web;

import jakarta.enterprise.context.SessionScoped;
import jakarta.inject.Inject;
import jakarta.inject.Named;
import java.io.Serializable;
import org.primefaces.event.FileUploadEvent;



/**
 *
 * @author CGI Information Management Consultants Inc.
 */
@Named("FileUploadBean")
@SessionScoped
public class FileUploadBean implements Serializable {    
        
    @Inject
    private DataUploadBean dataUploadBean;
    
    private String uploadedFileName;
    
    private boolean uploadInProgress = false;
    
    public String clear(){
        dataUploadBean.init();
        uploadedFileName = null;
        return null;
    }
    
    public void upload(FileUploadEvent event) {
        if (uploadInProgress){
            return;
        } 
        this.clear();
        uploadInProgress = true;
        try{
            dataUploadBean.uploadDataEjb(event.getFile(),event.getFile().getSize());
            uploadedFileName = event.getFile().getFileName();
        }catch(Throwable t){
            t.printStackTrace();
        }finally{
            uploadInProgress = false;
        }
    }
    
    public DataUploadBean getDataUploadBean() {
        return this.dataUploadBean;
    }   
    
    public void setDataUploadBean(DataUploadBean dataUploadBean) {
        this.dataUploadBean = dataUploadBean;
    }   

    public String getUploadedFileName() {
        return uploadedFileName;
    }
    
    
}
