<%
dim webservice_url
dim webservice_variables
dim webservice_capture_variables
dim oXML
dim objXML
dim objCities
dim objEmptyset
dim intNoOfCities
dim intNoOfConditions
dim intNoOfProvinces
dim objConditions
dim objProvince
dim objDetails
dim intNoOfDetails
dim GetWsResults
dim iLoop
dim newsletter_variables, newsletter_response
dim search_field_name, search_letter, prov_id, category_id, town_id
dim child, link, title, display
dim ws_recordcount_text, ws_link_text
dim objHdl, objHdl2, objHdl_cites
dim cs_condition, cs_conid, cs_geogdesc, cs_geogid
dim cs_covtype, cs_covid, cs_covdesc
dim cs_name, cs_address, cs_town, cs_province, cs_country, cs_postalcode, cs_phone, cs_fax, cs_url, cs_toll, cs_email
dim city_display, title_display, title_count, community_city_display
dim category_select, province_select, title_category, title_province
dim cs_cat_internet, cs_cat_national, cs_cat_provincial, cs_cat_regional, cs_cat_local
dim cs_title_phone, cs_title_fax, cs_title_toll, cs_title_url, cs_title_email
dim cs_header, cs_description, cs_intro, cs_cities_text, cs_details_text, cs_select_support_box, cs_select_province_box, cs_select_all, cs_select_all_value, cs_cities_in, cs_cities_empty, cs_cities_empty_2, sc_details_text, cs_cites_view, cs_cites_view_2
dim display_cs_details
dim cs_global_search_results, cs_search_count

dim empty_set_display
dim error_display
dim drug_header, drug_description, drug_intro, drug_alpha_text, drug_search_text, drug_search_box
dim drug_list_display, drug_intro_display
dim drug_details_display
dim drug_info, drug_id, drug_displayname, drug_displaynameA, drug_brandname, drug_brandname_id
dim drug_precautions, drug_warnings, drug_dosage, drug_contraindications, drug_availableform, drug_commonname, drug_indication, drug_adverseeffects
dim drug_brandname_title, drug_commonname_title
dim drug_precautions_title, drug_warnings_title, drug_dosage_title, drug_contraindications_title, drug_availableform_title, drug_indication_title, drug_adverseeffects_title, drug_search_count
dim disease_list_display, disease_intro_display
dim disease_details_display
dim disease_header, disease_description, disease_intro, disease_alpha_text, disease_search_text, disease_search_box, disease_id, disease_name, disease_name_a, disease_name_b, disease_name_c, disease_name_d, disease_patient_info, disease_info
dim disease_facts_title, disease_causes_title, disease_symptoms_title, disease_diagnosis_title, disease_treatment_title
dim search_by_alpha
dim disclaimer_text
dim disclaimer_text2
disclaimer_text2 = "<div class=""disclaimer_footer"">All material © 1996-" & Year(Date()) & " MediResource Inc. <a href=""termsmediresource.stm"">Terms and conditions</a> of use. The contents herein are for informational purposes only. Always seek the advice of your physician or other qualified health provider with any questions you may have regarding a medical condition.</div>"
dim email_body, o_msg, o_conf, mail_server_ip
dim strMessage, strSubject
dim objFSO,objTextStream, strFileName, strLine

search_field_name = request("search_field_name")
search_letter = request("search_letter")
'prov_id = request("prov_id")
prov_id = 3
category_id = request("category_id")
town_id = request("town_id")

'addictions
dim add_title, region_title, comm_title, add_intro, add_recordcount, add_region_id, add_region_dsc, add_comm_id, add_comm_dsc, add_resource_id, add_resource_name, add_nameext, add_subhead, add_subname, add_access, add_accred, add_address1, add_city1, add_prov1, add_postal1, add_phone1, add_fax1, add_address2, add_city2, add_prov2, add_postal2, add_phone2, add_fax2, add_email, add_website, add_hours, add_description, add_fees, add_program, add_approach, add_prevention, add_waitlist, add_special
dim add_search_alpha, add_dropdown, add_region_selected, add_community_text, add_community_selected, add_alpha_text

dim region_select, community_select, resource_list_display, resource_details_display, resource_alpha_display, add_region_title, add_comm_title
dim region_id, comm_id, resource_id
dim resource_list_duplicate
dim addiction_url

if request("region_id") = "" then
	addiction_url = "communitysupport_addiction.asp"
else
	addiction_url = "communitysupport_addiction.asp"
end if

resource_list_duplicate = "|"

if request("region_id") <> "" then
	region_id = request("region_id") 
else
	region_id = 999
end if

if request("resource_id") <> "" then
	resource_id = request("resource_id") 
else
	resource_id = ""
end if

'session("region_id") used to control community select box
if request("comm_id") <> "" and (session("region_id") = request("region_id")) then
	comm_id = request("comm_id") 
else
	comm_id = 999
end if
'session("region_id") used to control community select box
session("region_id") = region_id 

'Services
dim service_id, service_type_id, service_type_name, service_type_url, service_dropdown_display, service_list_display, service_title, service_select_dropdown, service_select_introduction
dim service_name, service_address, service_postal, service_city, service_phone, service_fax, service_website, service_coverage, service_tollfree, service_email, title_service
dim service_keyword_results, service_keyword_header, service_keyword_count, objServiceKeyword, intNoOfServices

service_id = request("service_id")

webservice_url = Application("webservice_url")
mail_server_ip = Application("mail_server_ip")
webservice_capture_variables = "&intCaptureOne=7&intCaptureTwo=0&intCaptureThree=0&intCaptureFour=0&intCaptureFive=0"
webservice_variables = "intLanguageId=" & application("language_id") & "&intCountryId=" & application("country_id") &"&strWsKey=" & Application("ws_key") & webservice_capture_variables

Function splitbrandname(x, y, path)
	dim x_brandname, x_bnarray, y_bnidarray, x_item, x_count
	x_bnarray = split(x, "|")
	y_bnidarray = split(y, "|")
	x_brandname = ""
	x_count = 0
	
		For Each x_item in x_bnarray
			x_brandname = x_brandname & "<a href=""" & path & "medications_details.asp?brand_name_id=" & y_bnidarray(x_count) & """>" &  x_item  & "</a>, "
			x_count = x_count + 1
		Next
	 
	 'remove trailing ", "
		if x_brandname <> "" then
			x_brandname = left(x_brandname, len(x_brandname)-2)
		end if
		
	splitbrandname = x_brandname
End Function

function isEmail(email)
	'isEmail=regexTest("[A-Za-z0-9\_\-]+\@[A-Za-z0-9\_\-]+.*\.\w{2,3}",email)  
	isEmail = regexTest("[\w\-._]+@[\w\-._]+.\w{2,3}", email)
end function 

function regexTest(expression, text)  
	dim regEx, Match, Matches ' Create variable.  
	
	set regEx			= New RegExp ' Create a regular expression.  
	
	regEx.Pattern		= expression ' Set pattern.  
	regEx.IgnoreCase	= true ' Set case insensitivity.  
	regEx.Global		= true ' Set global applicability.  
	regexTest			= regEx.test(text) ' Execute search.  
end function
%>

<!--#include file="text_definitions.inc"-->