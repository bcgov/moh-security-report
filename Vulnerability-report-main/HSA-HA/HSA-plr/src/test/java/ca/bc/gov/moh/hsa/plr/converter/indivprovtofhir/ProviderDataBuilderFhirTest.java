/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.moh.hsa.plr.converter.indivprovtofhir;

import ca.bc.gov.health.plr.dto.provider.esb.AddressDto;
import ca.bc.gov.health.plr.dto.provider.esb.CollegeIdentifierDto;
import ca.bc.gov.health.plr.dto.provider.esb.ConditionsDto;
import ca.bc.gov.health.plr.dto.provider.esb.CredentialsDto;
import ca.bc.gov.health.plr.dto.provider.esb.DemographicDetailsDto;
import ca.bc.gov.health.plr.dto.provider.esb.DisciplinaryActionDto;
import ca.bc.gov.health.plr.dto.provider.esb.ElectronicAddressDto;
import ca.bc.gov.health.plr.dto.provider.esb.ExpertiseDto;
import ca.bc.gov.health.plr.dto.provider.esb.InformationRouteDto;
import ca.bc.gov.health.plr.dto.provider.esb.JurisdictionNameCodeDto;
import ca.bc.gov.health.plr.dto.provider.esb.NoteDto;
import ca.bc.gov.health.plr.dto.provider.esb.PersonNameDto;
import ca.bc.gov.health.plr.dto.provider.esb.ProviderDetails;
import ca.bc.gov.health.plr.dto.provider.esb.ProviderRelationshipDto;
import ca.bc.gov.health.plr.dto.provider.esb.RegistryIdentifierDto;
import ca.bc.gov.health.plr.dto.provider.esb.RegistryUserRelationshipDto;
import ca.bc.gov.health.plr.dto.provider.esb.StatusDto;
import ca.bc.gov.health.plr.dto.provider.esb.TelecommunicationDto;
import ca.bc.gov.health.plr.dto.provider.esb.WorkLocationDto;
import ca.uhn.fhir.context.FhirContext;
import ca.uhn.fhir.validation.FhirValidator;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.List;

/**
 *
 * @author dan.stepanov
 */
public class ProviderDataBuilderFhirTest {

    public static int CAL_EFF_START_DATE_YEAR = 2020;
    public static int CAL_EFF_START_DATE_MONTH = 0;
    public static int CAL_EFF_START_DATE_DAY = 5;
    public static int CAL_EFF_END_DATE_YEAR = 2050;
    public static int CAL_EFF_END_DATE_MONTH = 11;
    public static int CAL_EFF_END_DATE_DAY = 30;
    public static final Date SYSTEM_START_DATE__NULL_FHIR = null;
    
    public static FhirValidator initFhirValidatorTest() {
        FhirContext ctx = FhirContextFactory.forR4();
        
        // Create a FhirInstanceValidator and register it to a validator
        FhirValidator fhirValidator = ctx.newValidator();
        fhirValidator.setValidateAgainstStandardSchema(true);
        return fhirValidator;
    }

    private static ProviderDetails initFullProvider() {
        ProviderDetails result = new ProviderDetails();
        result.setPauthId(10L);
        result.setType("DEN");

        result.setJurisdiction(new JurisdictionNameCodeDto());
        result.getJurisdiction().setJurisdicationNameCode("jurisdictionNameCode");

        List<AddressDto> addresses = new ArrayList<>();
        addresses.add(getAddressMail());
        addresses.add(getAddressPhysical());
        result.setAddresses(addresses);

        List<ConditionsDto> conditions = new ArrayList<>();
        result.setConditions(conditions);

        List<CredentialsDto> credentials = new ArrayList<>();
        credentials.add(getCredentialsBD());
        credentials.add(getCredentialsMD());
        result.setCredentials(credentials);

        List<DemographicDetailsDto> demographicDetails = new ArrayList<>();
        demographicDetails.add(getDemographicDetails());
        result.setDemographicDetails(demographicDetails);

        List<DisciplinaryActionDto> disciplinaryActions = new ArrayList<>();
        result.setDisciplinaryActions(disciplinaryActions);

        List<ElectronicAddressDto> electronicAddress = new ArrayList<>();
        electronicAddress.add(getElectronicAddress());
        result.setElectronicAddresses(electronicAddress);

        List<ExpertiseDto> expertise = new ArrayList<>();
        expertise.add(getExpertiseLanguageFrench());
        expertise.add(getExpertiseLanguageItalian());
        expertise.add(getExpertiseSpecialityPharma());
        expertise.add(getExpertiseSpecialityFamMedicine());
        result.setExpertise(expertise);

        List<CollegeIdentifierDto> identifier = new ArrayList<>();
        identifier.add(getIdentifierIPC());
        identifier.add(getIdentifierCPN());
        result.setIdentifiers(identifier);

        List<InformationRouteDto> informationRoute = new ArrayList<>();
        result.setInformationRoutes(informationRoute);

        List<PersonNameDto> personName = new ArrayList<>();
        personName.add(getPersonNameUsual());
        personName.add(getPersonNameOfficial());        
        result.setIndNames(personName);

        List<NoteDto> note = new ArrayList<>();
        result.setNotes(note);

        List<ProviderRelationshipDto> providerRelationship = new ArrayList<>();
        result.setProviderRelationships(providerRelationship);

        List<RegistryIdentifierDto> registryIdentifier = new ArrayList<>();
        result.setRegistryIdentifiers(registryIdentifier);

        List<RegistryUserRelationshipDto> registryUserRelationship = new ArrayList<>();
        result.setRegistryUserRelationships(registryUserRelationship);

        List<StatusDto> status = new ArrayList<>();
        result.setStatuses(status);

        List<TelecommunicationDto> telecommunication = new ArrayList<>();
        telecommunication.add(getTelecommunicationPhone());
        telecommunication.add(getTelecommunicationFax());
        result.setTelecommunication(telecommunication);

        List<WorkLocationDto> workLocations = new ArrayList<>();
        result.setWorkLocationList(workLocations);

        return result;
    }

    public static ProviderDetails getIndividualProviderDetails() {
        ProviderDetails result = initFullProvider();
        result.setConfidential(false);

        return result;
    }

    public static CollegeIdentifierDto getIdentifierCPN() {
        CollegeIdentifierDto result = new CollegeIdentifierDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("HA3");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setIdentifier("CPN.00000008.BC.PRS");
        result.setInvalidatedDate(null);
        result.setType("Test Type");
        result.setTypeCode("CPN");
        result.setUserChid("Test User Chiid");
        return result;
    }
    
    public static CollegeIdentifierDto getIdentifierIPC() {
        CollegeIdentifierDto result = new CollegeIdentifierDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("HA3");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setIdentifier("IPC.00000005.BC.PRS");
        result.setInvalidatedDate(null);
        result.setType("Test Type");
        result.setTypeCode("IPC");
        result.setUserChid("Test User Chiid");
        return result;
    }

    public static PersonNameDto getPersonNameUsual() {
        PersonNameDto result = new PersonNameDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("MOH");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setInvalidatedDate(null);
        result.setType("Test Type Usual");
        result.setTypeCode("CRED");
        result.setTypeId(997l);//credential name
        result.setUserChid("Test User Chid JUNIT");

        result.setFirstName("First Name Usual");
        result.setLastName("Last Name Usual");
        result.setPreferred(true);
        result.setSecondName("Second Name Usual");
        result.setThirdName("Third Name Usual");
        result.setSuffix("Suffix Usual");
        result.setPrefix("Prefix Usual");
        result.setFullName("Person Full Name Usual Test One");

        return result;
    }
    
    public static PersonNameDto getPersonNameOfficial() {
        PersonNameDto result = new PersonNameDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("MOH");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setInvalidatedDate(null);
        result.setType("Test Type Official");
        result.setTypeCode("CURR");
        result.setTypeId(1147l);//legal/official name
        result.setUserChid("Test User Chid JUNIT");

        result.setFirstName("First Name Official");
        result.setLastName("Last Name Official");
        result.setPreferred(true);
        result.setSecondName("Second Name Official");
        result.setThirdName("Third Name Official");
        result.setSuffix("Suffix Official");
        result.setPrefix("Prefix Official");
        result.setFullName("Person Full Name Official Test Two");

        return result;
    }

    public static DemographicDetailsDto getDemographicDetails() {
        DemographicDetailsDto result = new DemographicDetailsDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("MOH");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setInvalidatedDate(null);
        result.setType("Test Type Gender Male");
        result.setTypeCode("M");
        result.setUserChid("Test User Chiid");

        result.setBirthCountry("Canada");
        result.setBirthCountryCode("CA");
        result.setBirthDate(getEffectiveStartDate(1980, 0, 10));
        result.setBirthProvState("BC");
        result.setDeathDate(null);
        result.setGender("Male");
        result.setGenderCode("M");
        result.setGenderId(2332l);

        return result;
    }

    public static AddressDto getAddressMail() {
        AddressDto result = new AddressDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("RNA");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setInvalidatedDate(null);
        result.setType("Test Type");
        result.setTypeCode("M");
        result.setTypeId(2838l);  ///address type code Mailing

        result.setUserChid("Test User Chid JUNIT");

        result.setAddressLineOne("Address Line One Mail");
        result.setAddressLineTwo("Address Line Two Mail");
        result.setAddressLineThree("Address Line Three Mail");
        result.setCity("Victoria");
        result.setPostalCode("V9V 9V9");
        result.setFullAddress("Full Address Test Mail Sample 1");
        result.setCommunicationPurpose("Communication Purpose");
        result.setCommunicationPurposeCode("BC");
        result.setCommunicationPurposeId(2802l);
        result.setCountry("Canada");
        result.setCountryCode("CA");
        result.setCountryId(1239l);
        result.setProvinceOrStateTxt("British Columbia (BC)");

        return result;
    }
    
    public static AddressDto getAddressPhysical() {
        AddressDto result = new AddressDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("RNA");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setInvalidatedDate(null);
        result.setType("Test Physical Type");
        result.setTypeCode("P");
        result.setTypeId(2839l);  ///address type code Physical

        result.setUserChid("Test User Chid JUNIT");

        result.setAddressLineOne("Address Line One Physical");
        result.setAddressLineTwo("Address Line Two Physical");
        result.setAddressLineThree("Address Line Three Physical");
        result.setCity("Vernon");
        result.setPostalCode("V9V 9V7");
        result.setFullAddress("Full Address Test Physical Sample 1");
        result.setCommunicationPurpose("Communication Purpose");
        result.setCommunicationPurposeCode("BC");
        result.setCommunicationPurposeId(2802l);
        result.setCountry("Canada");
        result.setCountryCode("CA");
        result.setCountryId(1239l);
        result.setProvinceOrStateTxt("British Columbia (BC)");

        return result;
    }

    public static TelecommunicationDto getTelecommunicationFax() {
        TelecommunicationDto result = new TelecommunicationDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("MOH");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setInvalidatedDate(null);
        result.setType("Test Type");
        result.setTypeCode("FAX");
        result.setTypeId(2412l);
        result.setUserChid("Test User Chiid JUNIT");

        result.setAreaCode("250 ");
        result.setCommunicationPurpose("Communication Purpose");
        result.setCommunicationPurposeCode("BC");
        result.setCommunicationPurposeId(4241l);
        result.setExtension("ext. 1234");
        result.setNumber("555-1234 ");

        return result;
    }
    
    public static TelecommunicationDto getTelecommunicationPhone() {
        TelecommunicationDto result = new TelecommunicationDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("MOH");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setInvalidatedDate(null);
        result.setType("Test Type");
        result.setTypeCode("T");
        result.setTypeId(1161l);
        result.setUserChid("Test User Chiid JUNIT");

        result.setAreaCode("250 ");
        result.setCommunicationPurpose("Communication Purpose");
        result.setCommunicationPurposeCode("HC");
        result.setCommunicationPurposeId(2802l);
        result.setExtension("");
        result.setNumber("345-1111 ");

        return result;
    }

    public static ElectronicAddressDto getElectronicAddress() {
        ElectronicAddressDto result = new ElectronicAddressDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        //result.setDataOwnerCode("JUNIT");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(999L);
        result.setInvalidatedDate(null);
        result.setCommunicationPurposeId(2802l);
        result.setTypeId(2048l);
        result.setUserChid("TODO");
        result.setDataOwnerCode("MOH");
        result.setAddress("unittest@cgi.com");
        return result;
    }

    public static ExpertiseDto getExpertiseLanguageFrench() {
        ExpertiseDto result = new ExpertiseDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("MOH");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setInvalidatedDate(null);
        result.setType("French");
        result.setTypeCode("F16");
        result.setUserChid("Test User Chiid");

        result.setRoleType("Role Type");
        result.setRoleTypeCode("LANG");
        result.setSourcesCode("Sources Code");

        return result;
    }
    
    public static ExpertiseDto getExpertiseLanguageItalian() {
        ExpertiseDto result = new ExpertiseDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("MOH");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setInvalidatedDate(null);
        result.setType("Italian");
        result.setTypeCode("I21");
        result.setUserChid("Test User Chiid");

        result.setRoleType("Role Type");
        result.setRoleTypeCode("LANG");
        result.setSourcesCode("Sources Code");

        return result;
    }
    
    public static ExpertiseDto getExpertiseSpecialityPharma() {
        ExpertiseDto result = new ExpertiseDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("MOH");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setInvalidatedDate(null);
        result.setType("Test Type Speciality Nutrition Pharma");
        result.setTypeCode("NUTRX");
        result.setUserChid("Test User Chiid");

        result.setRoleType("Role Type");
        result.setRoleTypeCode("PHARM");
        result.setSourcesCode("Sources Code Pharm");

        return result;
    }

    public static ExpertiseDto getExpertiseSpecialityFamMedicine() {
        ExpertiseDto result = new ExpertiseDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("MOH");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setInvalidatedDate(null);
        result.setType("Test Type Speciality Family Medicine");
        result.setTypeCode("A160");
        result.setUserChid("Test User Chiid");

        result.setRoleType("Role Type");
        result.setRoleTypeCode("MD");
        result.setSourcesCode("Sources Code Med");

        return result;
    }
    
    public static CredentialsDto getCredentialsBD() {
        CredentialsDto result = new CredentialsDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("MOH");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setInvalidatedDate(null);
        result.setType("Test Type BD");
        result.setTypeCode("BD");
        result.setTypeId(1430l);
        result.setUserChid("Test User Chiid");

        result.setDesignation("BSc. in Fantastic Test");
        result.setGrantingInstitution("Queen's");
        result.setInstitutionCity("Victoria");
        result.setInstitutionCountry("Canada");
        result.setInstitutionCountryCode("CA");
        result.setInstitutionProvState("British Columbia");
        result.setInstitutionProvStateCode("BC");
        result.setRegistrationNumber("Reg Number 555 for BD");
        result.setYearIssued("2000");
        result.setEquivalencyFlag(true);

        result.setId(-1l);

        return result;
    }
    
    public static CredentialsDto getCredentialsMD() {
        CredentialsDto result = new CredentialsDto();
        result.setActive(true);
        result.setCreatedDate(new Date());
        result.setDataOwnerCode("MOH");
        result.setEffectiveEndDate(getEffectiveEndDate(CAL_EFF_END_DATE_YEAR, CAL_EFF_END_DATE_MONTH, CAL_EFF_END_DATE_DAY));
        result.setEffectiveStartDate(getEffectiveStartDate(CAL_EFF_START_DATE_YEAR, CAL_EFF_START_DATE_MONTH, CAL_EFF_START_DATE_DAY));
        result.setEndReasonCode(null);
        result.setGenerationNum(1L);
        result.setInvalidatedDate(null);
        result.setType("Test Type MD");
        result.setTypeCode("MD");
        result.setTypeId(1311l);
        result.setUserChid("Test User Chiid");

        result.setDesignation("Medical Degree in Hospital Test");
        result.setGrantingInstitution("UBC");
        result.setInstitutionCity("Vancouver");
        result.setInstitutionCountry("Canada");
        result.setInstitutionCountryCode("CA");
        result.setInstitutionProvState("British Columbia");
        result.setInstitutionProvStateCode("BC");
        result.setRegistrationNumber("Reg Number 222 for MD");
        result.setYearIssued("2005");
        result.setEquivalencyFlag(true);

        result.setId(-1l);

        return result;
    }

    /**
     * Creates an effective start date instance
     *
     * @param yearStart
     * @param monthStart
     * @param dayStart
     * @return Date instance for start time
     */
    public static Date getEffectiveStartDate(int yearStart, int monthStart, int dayStart) {
        Calendar cal = Calendar.getInstance();
        cal.clear();
        cal.set(yearStart, monthStart, dayStart);
        cal.set(Calendar.HOUR_OF_DAY, 11);
        cal.set(Calendar.MINUTE, 45);
        cal.set(Calendar.SECOND, 15);
//        truncateTime(cal);

        return cal.getTime();
    }

    /**
     * Creates an effective end date instance
     *
     * @param yearEnd
     * @param monthEnd
     * @param dayEnd
     * @return Date instance for end time
     */
    public static Date getEffectiveEndDate(int yearEnd, int monthEnd, int dayEnd) {
        Calendar cal = Calendar.getInstance();
        cal.clear();
        cal.set(yearEnd, monthEnd, dayEnd);        
        truncateTime(cal);

        return cal.getTime();
    }
    
    /**
     * Truncates time part of a Calendar object
     * @param cal 
     */
    public static void truncateTime(Calendar cal) {
        
        cal.set(Calendar.HOUR_OF_DAY, 0);
        cal.set(Calendar.MINUTE, 0);
        cal.set(Calendar.SECOND, 0);
        cal.set(Calendar.MILLISECOND, 0);
    }

}
