<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:camel="http://camel.apache.org/schema/spring"
       xmlns:broker="http://activemq.apache.org/schema/core"
       xmlns:jee="http://www.springframework.org/schema/jee"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans 
           http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
           http://www.springframework.org/schema/context
           http://www.springframework.org/schema/context/spring-context-3.2.xsd
           http://camel.apache.org/schema/spring
           http://camel.apache.org/schema/spring/camel-spring.xsd
           http://activemq.apache.org/schema/core 
           http://activemq.apache.org/schema/core/activemq-core.xsd
           http://www.springframework.org/schema/jee 
           http://www.springframework.org/schema/jee/spring-jee-3.2.xsd
           http://www.springframework.org/schema/tx
           http://www.springframework.org/schema/tx/spring-tx-3.2.xsd">
          
    <!--<import resource="classpath:META-INF/cxf/cxf.xml" />-->
    <import resource="classpath:environmentSpecific.xml"/>  
    <import resource="classpath:plrTestEnvironmentSpecific.xml"/>   
    <!--<import resource="classpath:jmsBroker.xml"/>--> 
    
    <bean id="fileDropConfigurationProperties" class="org.springframework.beans.factory.config.PropertiesFactoryBean">
        <property name="location" value="classpath:fileDropConfig.properties"/>
    </bean>
    
    <!--sslContextParameters id="sslParameters" xmlns="http://camel.apache.org/schema/spring">
        <keyManagers
            keyPassword="HCIM">
            <keyStore
                resource="multi.jks"
                password="changeit"
            />
        </keyManagers>
        <trustManagers>
            <keyStore 
                resource="trust.jks"
                password="changeit"/>
        </trustManagers>
    </sslContextParameters-->    
    
    <!--<context:component-scan base-package="ca.bc.gov.moh.hsa" />-->
    
<!--    Get rid of this later-->
    <bean id="transactionDao" class="ca.bc.gov.moh.hsa.util.audit.entity.dao.TransactionDAO"/>
<!--    Get rid of this later-->

    <bean id="ejbRoute" class="ca.bc.gov.moh.hsa.plr.serviceclient.EJBRouteBuilder"/>
    <bean id="batchRoute" class="ca.bc.gov.moh.hsa.plr.esb.service.batch.BatchServiceRouteBuilder"/>
    
    <camelContext xmlns="http://camel.apache.org/schema/spring" handleFault="true" trace="true">
        
        
        <!--<contextScan />-->
        
        <jmxAgent id="agent" createConnector="true"/>
        
        <routeBuilder ref="ejbRoute"/>
        <routeBuilder ref="batchRoute"/>
        <routeContextRef ref="customRoutes"/>
        <routeContextRef ref="customRoutes2"/>

    </camelContext>
    
    <bean id="entityManagerFactory"
          class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" >
        <property name="persistenceProviderClass" value="org.eclipse.persistence.jpa.PersistenceProvider"/>
        <property name="packagesToScan" value="ca.bc.gov.moh.hsa.util.audit.entity" />
        <property name="dataSource" ref="dataSource" />
        <property name="jpaVendorAdapter">
            <bean class="org.springframework.orm.jpa.vendor.EclipseLinkJpaVendorAdapter">
                <property name="showSql" value="false"/>
                <property name="generateDdl" value="false"/>
                <property name="databasePlatform" value="org.eclipse.persistence.platform.database.HSQLPlatform"/> 
            </bean>
        </property>
        <property name="jpaDialect">
            <bean class="org.springframework.orm.jpa.vendor.EclipseLinkJpaDialect" />
        </property>
        <property name="loadTimeWeaver">
            <bean class="org.springframework.instrument.classloading.SimpleLoadTimeWeaver" />
        </property>  
    </bean>
    
    <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
        <property name="entityManagerFactory" ref="entityManagerFactory" />
    </bean>
    
    <tx:annotation-driven />
 
    <bean id="persistenceExceptionTranslationPostProcessor"
          class="org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor" />
    
    
</beans>

