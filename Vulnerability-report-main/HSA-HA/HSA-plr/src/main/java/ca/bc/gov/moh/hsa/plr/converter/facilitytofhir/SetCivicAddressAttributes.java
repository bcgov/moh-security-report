/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.moh.hsa.plr.converter.facilitytofhir;

import static ca.bc.gov.moh.hsa.plr.converter.indivprovtofhir.ProviderFhirConstants.BC_COMM_PURPOSE_CODING_SYSTEM_LINK;
import ca.bc.gov.moh.hsa.plr.esb.fhir.common.FHIRFactory;
import java.util.Date;

/**
 *
 * @author jonathan.wiebe
 */
public class SetCivicAddressAttributes extends SetAttributesCommon {

    public SetCivicAddressAttributes(FHIRFactory theFactory) {
        super(theFactory);
    }

    public void addCivicAddressPeriod(Object address, Date start, Date end) {
        factory.getSetAddressAttributes().addAddressPeriod(address, start, end);
    }

    public void setCivicAddressCityStateCountry(Object address, String city, String provinceOrStateTxt, String countryCode) {
        factory.getSetAddressAttributes().setAddressCityStateCountry(address, city, provinceOrStateTxt, countryCode);
    }

    /**
     * Civic address can only be PHYSICAL
     *
     * @param address
     * @param addressType
     */
    public void setCivicAddressType(Object address) {
        if (version == FHIRFactory.FHIR_VERSION.R4 || version == FHIRFactory.FHIR_VERSION.R4BC1) {
            factory.callMethod(address, "setType", org.hl7.fhir.r4.model.Address.AddressType.PHYSICAL);
        }
    }

    void setCivicAddressAddressLines(Object address, String addressLineOne, String addressLineTwo, String addressLineThree) {
        factory.getSetAddressAttributes().setAddressLines(address, addressLineOne, addressLineTwo, addressLineThree);
    }

    /**
     * Civic address can only be WORK
     *
     * @param address
     * @param addressUse
     */
    void setCivicAddressUse(Object address) {
        Object cc = factory.newCodeableConcept();
        Object coding = factory.newCoding();
        factory.getSetCodingAttributes().setCodingSystem(coding, BC_COMM_PURPOSE_CODING_SYSTEM_LINK);
        factory.getSetCodingAttributes().setCodingCode(coding, "BC");
        factory.getSetCodeableConceptAttributes().setCoding(cc, coding);
        factory.getSetPurposeCodeAttributes().setPurposeCoding(address, cc);
    }
}
