/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.moh.hsa.plr.converter;

import java.util.Map;
import org.apache.camel.Exchange;
import org.apache.camel.Processor;

/**
 * Converts an incoming REST URL to a String message body for auditing and logging purposes
 * @author greg.perkins
 */
public class RestAuditLogProcessor implements Processor{

    /**
     * Sets the exchange body to be input URL (URI + query string)
     * @param exchange Exchange
     * @throws Exception 
     */
    @Override
    public void process(Exchange exchange) throws Exception {
        Map<String,Object> headers = exchange.getIn().getHeaders();
        StringBuilder body = new StringBuilder();
        body.append(headers.get(Exchange.HTTP_URI));
        Object query = headers.get(Exchange.HTTP_QUERY);
        if (query!=null && query.toString().length()>0){
            body.append("?");
            body.append(query.toString());
        }
        exchange.getIn().setBody(body.toString());
    }
    
}
