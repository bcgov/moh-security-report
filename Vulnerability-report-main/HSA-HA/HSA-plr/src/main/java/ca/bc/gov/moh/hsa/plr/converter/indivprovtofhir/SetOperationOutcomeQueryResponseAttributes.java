/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.moh.hsa.plr.converter.indivprovtofhir;

import ca.bc.gov.moh.hsa.plr.esb.fhir.common.FHIRFactory;
import ca.bc.gov.moh.hsa.plr.converter.facilitytofhir.SetAttributesCommon;
import static ca.bc.gov.moh.hsa.plr.converter.indivprovtofhir.ProviderFhirConstants.BC_OPERATION_OUTCOME_ISSUE_SYSTEM_CODE;
import java.util.ArrayList;
import java.util.List;
//import org.hl7.fhir.r4.model.OperationOutcome;
//import org.hl7.fhir.r4.model.OperationOutcome.OperationOutcomeIssueComponent;

/**
 *
 * @author dan.stepanov
 */
public class SetOperationOutcomeQueryResponseAttributes extends SetAttributesCommon {

    public SetOperationOutcomeQueryResponseAttributes(FHIRFactory theFactory) {
        super(theFactory);
        issueComponent = factory.newOperationOutcomeIssueComponent();
    }
    List<Object> issueComponents = new ArrayList<>();
    Object issueComponent = null; //new OperationOutcomeIssueComponent();

    public void setIssueDetails(Object parentIssue, String issueDetailCode) {
        Object issueDetailsCoding = factory.newCoding();
        // setCodingSystem for the issue details
        factory.getSetCodingAttributes().setCodingSystem(issueDetailsCoding, BC_OPERATION_OUTCOME_ISSUE_SYSTEM_CODE);
        factory.callMethod(parentIssue, "setCodingSystem", issueDetailsCoding);
        // setCodingCode for the issue details
        factory.getSetCodingAttributes().setCodingCode(issueDetailsCoding, issueDetailCode);
        factory.callMethod(parentIssue, "setCodingCode", issueDetailsCoding);
    }

    public void setIssueSeverity(Object parentIssue, Object issueSeverityType) {
        factory.callMethod(parentIssue, "setIssueSeverity", issueSeverityType);
    }

    public List<Object> getIssueComponents() {
        return issueComponents;
    }

    public void setIssueComponents(List<Object> issueComponents) {
        this.issueComponents = issueComponents;
    }

    public Object getIssueComponent() {
        factory.getSetOperationOutcomeIssueComponentAttributes().setIssueSeverity(issueComponent, factory.newOOIssueSeverity(FHIRFactory.OperationOutcomeIssueSeverity.WARNING));
        factory.getSetOperationOutcomeIssueComponentAttributes().setIssueCode(issueComponent, factory.newOOIssueCode(FHIRFactory.OperationOutcomeIssueCode.BUSINESSRULE));
        return issueComponent;
    }

    public void setIssueComponent(Object issueComponent) {
        this.issueComponent = issueComponent;
    }

    public void setIssue(Object parentObject, String codingSystem) {
        if (codingSystem != null) {
            factory.callMethod(parentObject, "setCodingSystem", codingSystem);
        }
    }

    public void setCodingCode(Object parentObject, String codingCode) {
        if (codingCode != null) {
            factory.callMethod(parentObject, "setCodingCode", codingCode);
        }
    }

}
