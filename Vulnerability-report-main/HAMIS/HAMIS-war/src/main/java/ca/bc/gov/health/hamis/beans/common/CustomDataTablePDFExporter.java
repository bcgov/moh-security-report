package ca.bc.gov.health.hamis.beans.common;

import com.lowagie.text.DocumentException;
import com.lowagie.text.pdf.PdfPTable;
import jakarta.faces.context.FacesContext;
import java.util.logging.Level;
import java.util.logging.Logger;
import org.primefaces.component.datatable.DataTable;
import org.primefaces.component.datatable.export.DataTablePDFExporter;
import org.primefaces.component.export.ExportConfiguration;

/**
 * A custom PrimeFaces {@link DataTablePDFExporter} that supports setting column widths.
 *
 * @author david.a.sharpe
 */
public class CustomDataTablePDFExporter extends DataTablePDFExporter {

  private final float[] widths;

  /** @param widths length must equal number of columns to export */
  public CustomDataTablePDFExporter(float[] widths) {
    this.widths = widths;
  }

  @Override
  protected PdfPTable exportTable(
      final FacesContext context, final DataTable table, final ExportConfiguration config) {

    PdfPTable exportTable = super.exportTable(context, table, config);

    try {
      exportTable.setWidths(widths);
    } catch (DocumentException ex) {
      Logger.getLogger(CustomDataTablePDFExporter.class.getName()).log(Level.SEVERE, null, ex);
      throw new RuntimeException(ex);
    }
    return exportTable;
  }
}
