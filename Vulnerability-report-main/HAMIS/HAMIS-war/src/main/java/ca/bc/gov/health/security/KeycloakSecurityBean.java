/*
 * *********************************************************************************************************************
 *  Copyright (c) 2020, Ministry of Health, BC.                                                                        *
 *                                                                                                                     *
 *  All rights reserved.                                                                                               *
 *    This information contained herein may not be used in whole                                                       *
 *    or in part without the express written consent of the                                                            *
 *    Government of British Columbia, Canada.                                                                          *
 *                                                                                                                     *
 *  Revision Control Information                                                                                       *
 *  File:                $Id:: KeycloakSecurityBean.java 1566 2023-01-13 18:37:53Z ahoplock                          $ *
 *  Date of Last Commit: $Date:: 2023-01-13 10:37:53 -0800 (Fri, 13 Jan 2023)                                        $ *
 *  Revision Number:     $Rev:: 1566                                                                                 $ *
 *  Last Commit by:      $Author:: ahoplock                                                                          $ *
 *                                                                                                                     *
 * *********************************************************************************************************************
 */
package ca.bc.gov.health.security;

import fish.payara.security.annotations.ClaimsDefinition;
import fish.payara.security.annotations.OpenIdAuthenticationDefinition;

/**
 * Configures an OIDC Client
 *
 * @author CGI Information Management Consultants Inc.
 */
@OpenIdAuthenticationDefinition(
    providerURI = "#{oidcConfig.providerUri}",
    clientId = "#{oidcConfig.clientId}",
    clientSecret = "#{oidcConfig.clientSecret}",
    redirectURI = "#{oidcConfig.redirectUri}",
    scope = "#{oidcConfig.scope}",
    claimsDefinition =
        @ClaimsDefinition(
            callerNameClaim = "#{oidcConfig.callerNameClaim}",
            callerGroupsClaim = "#{oidcConfig.callerGroupsClaim}"),
    /* Default jwksConnectTimeout values can trigger com.nimbusds.jose.RemoteKeySourceException: Couldn't retrieve remote JWK set: connect timed out */
    jwksConnectTimeout = 2000,
    /* Default jwksReadTimeout values can trigger com.nimbusds.jose.RemoteKeySourceException: Couldn't retrieve remote JWK set: Read timed out */
    jwksReadTimeout = 2000,
    /* extraParameters cannot reference CDI bean property unlike the other options above */
    extraParameters = {
      /* Comma separated list of which identity providers show up on the login page. By default all are shown. */
      "idps_to_show=idir,phsa,moh_idp"
    })
public class KeycloakSecurityBean {}
