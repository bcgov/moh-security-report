/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.health.hamis.session;

import ca.bc.gov.health.hamis.entity.SubmissionMessage;
import ca.bc.gov.health.hamis.service.ISubmissionMessageFacade;
import jakarta.ejb.Stateless;
import jakarta.persistence.Query;
import java.util.List;

/**
 * Implementation of the submission message facade interface
 *
 * @author greg.perkins
 */
@Stateless
public class SubmissionMessageFacade extends AbstractFacade<SubmissionMessage>
    implements ISubmissionMessageFacade {

  /** Default Constructor */
  public SubmissionMessageFacade() {
    super(SubmissionMessage.class);
  }

  /**
   * Loads the list of error messages for a submission
   *
   * @param subId Long - submission ID
   * @return List<String>
   */
  @Override
  public List<String> getErrorsForSubmission(Long subId) {
    String query = "SELECT MESSAGE FROM SUBMISSION_MESSAGES WHERE SUB_ID=? AND TYPE_CD <> 'WARNG'";
    Query q = getEntityManager().createNativeQuery(query);
    q.setParameter(1, subId);
    return (List<String>) q.getResultList();
  }
}
