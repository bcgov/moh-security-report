/*
 * *********************************************************************************************************************
 *  Copyright (c) 2020, Ministry of Health, BC.                                                                        *
 *                                                                                                                     *
 *  All rights reserved.                                                                                               *
 *    This information contained herein may not be used in whole                                                       *
 *    or in part without the express written consent of the                                                            *
 *    Government of British Columbia, Canada.                                                                          *
 *                                                                                                                     *
 *  Revision Control Information                                                                                       *
 *  File:                $Id:: OidcConfig.java 1643 2024-04-09 21:22:13Z tcusi                                       $ *
 *  Date of Last Commit: $Date:: 2024-04-09 14:22:13 -0700 (Tue, 09 Apr 2024)                                        $ *
 *  Revision Number:     $Rev:: 1643                                                                                 $ *
 *  Last Commit by:      $Author:: tcusi                                                                             $ *
 *                                                                                                                     *
 * *********************************************************************************************************************
 */
package ca.bc.gov.health.security;

import jakarta.annotation.PostConstruct;
import jakarta.annotation.Resource;
import jakarta.enterprise.context.ApplicationScoped;
import jakarta.inject.Named;
import java.util.Properties;

/**
 * Defines OpenId connect client configuration for Keycloak integration
 *
 * @author CGI Information Management Consultants Inc.
 */
@Named
@ApplicationScoped
public class OidcConfig {

  @Resource(lookup = "java:app/hamis/oidc_properties")
  Properties oidcProperties;

  @Resource(lookup = "java:app/hamis/service_account_properties")
  Properties serviceAccountProperties;

  private String providerUri;
  private String clientId;
  private String clientSecret;
  private String redirectUri;
  private String scope;
  private String callerGroupsClaim;
  private String callerNameClaim;
  private String siteminderLogoutUri;
  private String phsaLogoutUri;

  private String tokenUri;
  private String umsApiUri;

  @PostConstruct
  private void init() {

    providerUri = oidcProperties.getProperty("providerUri");
    clientId = oidcProperties.getProperty("clientId");
    clientSecret = oidcProperties.getProperty("clientSecret");
    redirectUri = oidcProperties.getProperty("redirectUri");
    scope = oidcProperties.getProperty("scope");
    callerGroupsClaim = oidcProperties.getProperty("callerGroupsClaim");
    callerNameClaim = oidcProperties.getProperty("callerNameClaim");
    siteminderLogoutUri = oidcProperties.getProperty("siteminderLogoutUri");
    phsaLogoutUri = oidcProperties.getProperty("phsaLogoutUri");

    tokenUri = serviceAccountProperties.getProperty("tokenUri");
    umsApiUri = serviceAccountProperties.getProperty("umsApiUri");
  }

  public String getProviderUri() {
    return providerUri;
  }

  public String getClientId() {
    return clientId;
  }

  public String getClientSecret() {
    return clientSecret;
  }

  public String getRedirectUri() {
    return redirectUri;
  }

  public String getScope() {
    return scope;
  }

  public String getCallerGroupsClaim() {
    return callerGroupsClaim;
  }

  public String getCallerNameClaim() {
    return callerNameClaim;
  }

  public String getSiteminderLogoutUri() {
    return siteminderLogoutUri;
  }

  public String getPhsaLogoutUri() {
    return phsaLogoutUri;
  }

  public String getTokenUri() {
    return tokenUri;
  }

  public String getUmsApiUri() {
    return umsApiUri;
  }
}
