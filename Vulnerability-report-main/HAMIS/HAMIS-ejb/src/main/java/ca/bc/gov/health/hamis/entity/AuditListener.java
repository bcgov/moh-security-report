/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ca.bc.gov.health.hamis.entity;

import jakarta.persistence.PrePersist;
import jakarta.persistence.PreUpdate;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.util.Date;

/** @author greg.perkins */
public class AuditListener {

  @PrePersist
  public void insert(Object entity) {
    setProperty(entity, "dateCreated", new Date());
    setProperty(entity, "userCreated", "TBD");
  }

  @PreUpdate
  public void update(Object entity) {
    setProperty(entity, "dateModified", new Date());
    setProperty(entity, "userModified", "TBD");
  }

  private void setProperty(Object target, String name, Object value) {
    try {
      String setterName = "set" + name.toUpperCase().substring(0, 1) + name.substring(1);
      Method setter = target.getClass().getMethod(setterName, value.getClass());
      setter.invoke(target, value);
    } catch (IllegalAccessException
        | IllegalArgumentException
        | NoSuchMethodException
        | SecurityException
        | InvocationTargetException e) {

    }
  }
}
