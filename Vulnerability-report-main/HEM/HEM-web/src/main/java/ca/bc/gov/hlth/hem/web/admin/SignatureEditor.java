package ca.bc.gov.hlth.hem.web.admin;

import ca.bc.gov.hlth.hem.entity.HemTeam;
import ca.bc.gov.hlth.hem.entity.HemUser;
import ca.bc.gov.hlth.hem.facade.HemTeamFacadeLocal;
import ca.bc.gov.hlth.hem.facade.HemUserFacadeLocal;
import ca.bc.gov.hlth.hem.jsf.BaseBean;
import ca.bc.gov.hlth.hem.security.Login;
import org.primefaces.PrimeFaces;

import javax.ejb.EJB;
import javax.enterprise.context.SessionScoped;
import javax.inject.Inject;
import javax.inject.Named;
import java.io.Serializable;
import java.util.logging.Level;
import java.util.logging.Logger;

@Named("SignatureEditor")
@SessionScoped
public class SignatureEditor extends BaseBean implements Serializable {

    private static final Logger LOGGER = Logger.getLogger(SignatureEditor.class.getSimpleName());

    @EJB
    private transient HemUserFacadeLocal hemUserFacade;

    @EJB
    private transient HemTeamFacadeLocal hemTeamFacade;

    @Inject
    private Login login;

    private HemUser selectedHemUser;
    private HemTeam selectedHemTeam;
    
    public SignatureEditor(){
    }

    public void save() {
        if(selectedHemUser != null){
            LOGGER.log(Level.INFO, "{0} is editing user signature", login.getLoginUserName());
            hemUserFacade.edit(selectedHemUser, login.getUserName());
            PrimeFaces context = PrimeFaces.current();
            context.executeScript("PF('signatureDialogEditor').hide();");
        }
        if(selectedHemTeam != null){
            LOGGER.log(Level.INFO, "{0} is editing team signature", selectedHemTeam.getTeamName());
            hemTeamFacade.edit(selectedHemTeam, login.getUserName());
            PrimeFaces context = PrimeFaces.current();
            context.executeScript("PF('signatureDialogEditor').hide();");
        }
    }

    public HemUser getSelectedHemUser() {
        return selectedHemUser;
    }

    public void setSelectedHemUser(HemUser selectedHemUser) {
        this.selectedHemUser = selectedHemUser;
    }

    public HemTeam getSelectedHemTeam() {
        return selectedHemTeam;
    }

    public void setSelectedHemTeam(HemTeam selectedHemTeam) {
        this.selectedHemTeam = selectedHemTeam;
    }
}
