package ca.bc.gov.hlth.hem.web.info;

import ca.bc.gov.hlth.hem.entity.HemEnvironment;
import ca.bc.gov.hlth.hem.facade.HemEnvironmentFacadeLocal;
import ca.bc.gov.hlth.hem.security.Login;
import ca.bc.gov.hlth.hem.utils.ReleaseWindowHelper;

import javax.inject.Inject;

public class ManageEnvironmentInfo extends EnvironmentInfo {

    @Inject
    private Login login;

    boolean sundayChecked = false;
    boolean mondayChecked = false;
    boolean tuesdayChecked = false;
    boolean wednesdayChecked = false;
    boolean thursdayChecked = false;
    boolean fridayChecked = false;
    boolean saturdayChecked = false;
    boolean beingEdited = false;

    public ManageEnvironmentInfo() {
    }

    public ManageEnvironmentInfo(HemEnvironmentFacadeLocal facade, HemEnvironment env) {
        updateInfoFromEnvironment(facade, env);
    }

    public void updateEnvironmentFromInfo(HemEnvironmentFacadeLocal facade, HemEnvironment env, Login login) {

        env.setEnvironmentId(environmentId);
        env.setEnvironmentName(environmentName);
        env.setEnvironmentReleaseWindow(environmentReleaseWindow);

        ReleaseWindowHelper.setDayReleasable(env, ReleaseWindowHelper.Day.Sunday, sundayChecked);
        ReleaseWindowHelper.setDayReleasable(env, ReleaseWindowHelper.Day.Monday, mondayChecked);
        ReleaseWindowHelper.setDayReleasable(env, ReleaseWindowHelper.Day.Tuesday, tuesdayChecked);
        ReleaseWindowHelper.setDayReleasable(env, ReleaseWindowHelper.Day.Wednesday, wednesdayChecked);
        ReleaseWindowHelper.setDayReleasable(env, ReleaseWindowHelper.Day.Thursday, thursdayChecked);
        ReleaseWindowHelper.setDayReleasable(env, ReleaseWindowHelper.Day.Friday, fridayChecked);
        ReleaseWindowHelper.setDayReleasable(env, ReleaseWindowHelper.Day.Saturday, saturdayChecked);

        facade.edit(env, login.getUserName());
    }

    public final void updateInfoFromEnvironment(HemEnvironmentFacadeLocal facade, HemEnvironment env) {

        environmentName = env.getEnvironmentName();
        environmentId = env.getEnvironmentId();
        environmentReleaseWindow = env.getEnvironmentReleaseWindow();

        sundayChecked = ReleaseWindowHelper.isDayReleasable(env, ReleaseWindowHelper.Day.Sunday);
        mondayChecked = ReleaseWindowHelper.isDayReleasable(env, ReleaseWindowHelper.Day.Monday);
        tuesdayChecked = ReleaseWindowHelper.isDayReleasable(env, ReleaseWindowHelper.Day.Tuesday);
        wednesdayChecked = ReleaseWindowHelper.isDayReleasable(env, ReleaseWindowHelper.Day.Wednesday);
        thursdayChecked = ReleaseWindowHelper.isDayReleasable(env, ReleaseWindowHelper.Day.Thursday);
        fridayChecked = ReleaseWindowHelper.isDayReleasable(env, ReleaseWindowHelper.Day.Friday);
        saturdayChecked = ReleaseWindowHelper.isDayReleasable(env, ReleaseWindowHelper.Day.Saturday);
    }

    public boolean isSundayChecked() {
        return sundayChecked;
    }

    public void setSundayChecked(boolean sundayChecked) {
        this.sundayChecked = sundayChecked;
    }

    public boolean isMondayChecked() {
        return mondayChecked;
    }

    public void setMondayChecked(boolean mondayChecked) {
        this.mondayChecked = mondayChecked;
    }

    public boolean isTuesdayChecked() {
        return tuesdayChecked;
    }

    public void setTuesdayChecked(boolean tuesdayChecked) {
        this.tuesdayChecked = tuesdayChecked;
    }

    public boolean isWednesdayChecked() {
        return wednesdayChecked;
    }

    public void setWednesdayChecked(boolean wednesdayChecked) {
        this.wednesdayChecked = wednesdayChecked;
    }

    public boolean isThursdayChecked() {
        return thursdayChecked;
    }

    public void setThursdayChecked(boolean thursdayChecked) {
        this.thursdayChecked = thursdayChecked;
    }

    public boolean isFridayChecked() {
        return fridayChecked;
    }

    public void setFridayChecked(boolean fridayChecked) {
        this.fridayChecked = fridayChecked;
    }

    public boolean isSaturdayChecked() {
        return saturdayChecked;
    }

    public void setSaturdayChecked(boolean saturdayChecked) {
        this.saturdayChecked = saturdayChecked;
    }

    public boolean isBeingEdited() {
        return beingEdited;
    }

    public void setBeingEdited(boolean beingEdited) {
        this.beingEdited = beingEdited;
    }

    @Override
    public String stats() {
        return super.stats()
                + ",[beingEdited=" + beingEdited
                + "],[sundayChecked=" + sundayChecked
                + "],[mondayChecked=" + mondayChecked
                + "],[tuesdayChecked=" + tuesdayChecked
                + "],[wednesdayChecked=" + wednesdayChecked
                + "],[thursdayChecked=" + thursdayChecked
                + "],[fridayChecked=" + fridayChecked
                + "],[saturdayChecked=" + saturdayChecked
                + "]";
    }

    public String statsPrettyfied() {
        StringBuilder sb = new StringBuilder();
        sb.append("[" + environmentId + "|" + environmentName + "] ")
                .append(sundayChecked ? "[X]" : "[ ]")
                .append(mondayChecked ? "[X]" : "[ ]")
                .append(tuesdayChecked ? "[X]" : "[ ]")
                .append(wednesdayChecked ? "[X]" : "[ ]")
                .append(thursdayChecked ? "[X]" : "[ ]")
                .append(fridayChecked ? "[X]" : "[ ]")
                .append(saturdayChecked ? "[X]" : "[ ]");

        return sb.toString();
    }
}
