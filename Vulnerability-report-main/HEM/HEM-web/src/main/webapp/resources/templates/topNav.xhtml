<?xml version='1.0' encoding='UTF-8' ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">            
<h:form xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:c="http://java.sun.com/jsp/jstl/core"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:p="http://primefaces.org/ui"
        id="topMenu">

    <div class="navbar-collapse collapse">
        <nav role ="navigation">
            <p:outputPanel style="display:block" rendered="#{Login.userLogged}">
                <ul class="menu nav navbar-nav" style="width:100%">
                    <li class="first leaf top-level-item">
                        <p:commandLink id="homeLink" action="#{MenuBean.changeMenu('/Scheduler')}" value="Home"/>
                    </li>
                    <c:if test="#{MenuBean.getSelectedMenu() eq '/Scheduler'}">
                        <li class="expanded dropdown top-level-item" style="display:list-item;" >
                            <p:commandLink value="Filters (#{Scheduler.numFiltersApplied})" 
                                           styleClass="serviceLink noborder"
                                           oncomplete="PF('leftSideBar').show();"
                                           id="filtersTopButton"/>                  
                        </li>
                    </c:if>
                    <c:if test="#{Login.userHasOneOfAdminRoles}">
                        <c:if test="#{MenuBean.getSelectedMenu() eq '/Scheduler'}">
                            <c:if test="#{Login.userHasAdminRole}">
                                <li class="expanded dropdown top-level-item" style="display:list-item;">
                                    <p:commandLink value="Add Change Request" type="button" oncomplete="PF('schedulerDialog').show();"
                                                   update="schedulerDialog" styleClass="serviceLink noborder"
                                                   action="#{Scheduler.callNewChangeRequest}"/>  
                                </li>
                            </c:if>
                        </c:if>                        
                        <c:if test="#{MenuBean.getSelectedMenu() eq '/admin/ManageCategories'}">
                            <li class="expanded dropdown top-level-item" style="display:list-item;">
                                <p:commandLink value="Add a change category" type="button"  styleClass="serviceLink noborder"
                                               action="#{manageCategories.prepareNewEntity()}" />
                            </li>
                        </c:if>
                        <c:if test="#{MenuBean.getSelectedMenu() eq '/admin/ManageEnvironments'}">
                            <li class="expanded dropdown top-level-item" style="display:list-item;">
                                <p:commandLink value="Add environment" type="button"  styleClass="serviceLink noborder"
                                               action="#{manageEnvironments.prepareNewEntity()}" />
                            </li>
                        </c:if>
                        <c:if test="#{MenuBean.getSelectedMenu() eq '/admin/ManageProducts'}">
                            <li class="expanded dropdown top-level-item" style="display:list-item;">
                                <p:commandLink value="Add a product" type="button"  styleClass="serviceLink noborder"
                                               action="#{manageProducts.prepareNewEntity()}" />
                            </li>
                        </c:if>
                        <c:if test="#{MenuBean.getSelectedMenu() eq '/admin/ManageRequestors'}">
                            <li class="expanded dropdown top-level-item" style="display:list-item;">
                                <p:commandLink value="Add a requestor" type="button"  styleClass="serviceLink noborder"
                                               action="#{manageRequestors.prepareNewEntity()}" />
                            </li>
                        </c:if>
                        <c:if test="#{MenuBean.getSelectedMenu() eq '/admin/ManageServers'}">
                            <li class="expanded dropdown top-level-item" style="display:list-item;">
                                <p:commandLink value="Add a server" type="button"  styleClass="serviceLink noborder"
                                               action="#{manageServers.prepareNewEntity()}" />
                            </li>
                        </c:if>
                        <c:if test="#{MenuBean.getSelectedMenu() eq '/admin/ManageUsers'}">
                            <li class="expanded dropdown top-level-item" style="display:list-item;">
                                <p:commandLink value="Add user" type="button"  styleClass="serviceLink noborder"
                                               action="#{manageUsers.prepareNewEntity()}" />
                            </li>
                        </c:if>
                        <c:if test="#{MenuBean.getSelectedMenu() eq '/admin/ManageTeams'}">
                            <li class="expanded dropdown top-level-item" style="display:list-item;">
                                <p:commandLink value="Add team" type="button"  styleClass="serviceLink noborder"
                                               action="#{manageTeams.prepareNewEntity()}" />
                            </li>
                        </c:if>
                        <c:if test="#{Login.userHasAdminRole}">
                            <li class="expanded dropdown top-level-item" style="display:list-item;">
                                <p:commandLink value="Code Table Maintenance" type="button"
                                               styleClass="serviceLink noborder" /> 
                                <ul class="dropdown-menu">
                                    <li class="first collapsed">
                                        <p:commandLink value="Manage Change Categories" 
                                                       styleClass="#{MenuBean.getSelectedMenu() eq '/admin/ManageCategories' ? 'selectedMenu':'serviceLink noborder'}"
                                                       action="#{MenuBean.changeMenu('/admin/ManageCategories')}"/>
                                    </li>
                                    <li class="collapsed">
                                        <p:commandLink value="Manage Environments"
                                                       styleClass="#{MenuBean.getSelectedMenu() eq '/admin/ManageEnvironments' ? 'selectedMenu':'serviceLink noborder'}"
                                                       action="#{MenuBean.changeMenu('/admin/ManageEnvironments')}"/>
                                    </li>
                                    <li class="collapsed">
                                        <p:commandLink value="Manage Products"
                                                       styleClass="#{MenuBean.getSelectedMenu() eq '/admin/ManageProducts' ? 'selectedMenu':'serviceLink noborder'}"								
                                                       action="#{MenuBean.changeMenu('/admin/ManageProducts')}"/>
                                    </li>
                                    <li class="collapsed">
                                        <p:commandLink value="Manage Requestors"
                                                       styleClass="#{MenuBean.getSelectedMenu() eq '/admin/ManageRequestors' ? 'selectedMenu':'serviceLink noborder'}"								
                                                       action="#{MenuBean.changeMenu('/admin/ManageRequestors')}"/>
                                    </li>      
                                    <li class="collapsed">
                                        <p:commandLink value="Manage Servers"
                                                       styleClass="#{MenuBean.getSelectedMenu() eq '/admin/ManageServers' ? 'selectedMenu':'serviceLink noborder'}"
                                                       action="#{MenuBean.changeMenu('/admin/ManageServers')}" />
                                    </li>
                                    <li class="last collapsed">
                                        <p:commandLink value="Manage Teams"
                                                       styleClass="#{MenuBean.getSelectedMenu() eq '/admin/ManageTeams' ? 'selectedMenu':'serviceLink noborder'}"
                                                       action="#{MenuBean.changeMenu('/admin/ManageTeams')}"/>
                                    </li>
                                    <li class="last collapsed">
                                        <p:commandLink value="Manage Users"
                                                       styleClass="#{MenuBean.getSelectedMenu() eq '/admin/ManageUsers' ? 'selectedMenu':'serviceLink noborder'}"
                                                       action="#{MenuBean.changeMenu('/admin/ManageUsers')}"/>
                                    </li>
                                </ul>
                            </li>     
                        </c:if>
                    </c:if>
                    <li class="last leaf" style="float: right;" >
                        <p:commandLink styleClass="serviceLink noborder" action="#{Logout.logout}">
                            <h:outputText value="#{Login.loginUserName}" style="position: absolute; color: #ccc; top:0; right:12px; font-size:0.7em;" />   
                            Logout
                        </p:commandLink>  
                    </li>
                </ul>
            </p:outputPanel>

        </nav>
    </div>
</h:form>
