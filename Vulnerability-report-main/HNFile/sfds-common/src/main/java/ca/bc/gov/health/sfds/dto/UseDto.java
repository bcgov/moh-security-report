package ca.bc.gov.health.sfds.dto;

import ca.bc.gov.health.sfds.enums.BooleanYesNo;
import ca.bc.gov.health.sfds.enums.Description;
import ca.bc.gov.health.sfds.enums.FileRecognizer;
import ca.bc.gov.health.sfds.enums.FileRenamer;
import ca.bc.gov.health.sfds.enums.NotificationType;
import ca.bc.gov.health.sfds.enums.SortComparator;
import ca.bc.gov.health.sfds.files.renamers.DefaultRenamer;
import ca.bc.gov.health.sfds.files.renamers.HCCRenamer;
import ca.bc.gov.health.sfds.files.renamers.HSCISRenamer;
import ca.bc.gov.health.sfds.files.renamers.MHMRRRenamer;
import com.google.gson.GsonBuilder;
import com.google.gson.annotations.Expose;
import jakarta.persistence.EnumType;
import jakarta.persistence.Enumerated;
import jakarta.persistence.MappedSuperclass;
import jakarta.persistence.Transient;
import java.io.Serializable;
import java.math.BigDecimal;
import java.util.Date;

/**
 * DTO for View Uses pages.
 *
 * @author alexey.malikov
 *
 */
@MappedSuperclass
public class UseDto implements Serializable {

    private static final long serialVersionUID = -8039142176068794614L;

    @Enumerated(EnumType.STRING)
    @Expose
    private NotificationType acknowledgement;
    @Enumerated(EnumType.STRING)
    @Expose
    private NotificationType confirmationType;
    @Expose
    private Date createDate;
    @Expose
    private String createUser;
    @Expose
    private String description;
    @Expose
    private String fileRecognizer;
    @Expose
    private String fileRenamer;
    @Expose
    private BigDecimal fileSizeLimit;
    @Expose
    private String getLabel;
    @Expose
    private Date modifyDate;
    @Expose
    private String modifyUser;
    @Expose
    private String name;
    @Expose
    @Enumerated(EnumType.STRING)
    private NotificationType notificationType;
    @Expose
    private String searchFields;
    @Expose
    private String sendLabel;
    @Expose
    private String sortComparator;
    @Expose
    private String textMessage;
    @Expose
    private BigDecimal timeLimit;
    @Expose
    private String useId;
    @Transient
    @Expose
    private RulesbasedaccountDto rulesbasedaccountDto;
    @Transient
    @Expose
    private boolean multi;
    @Transient
    @Expose
    private boolean persisted;

    public boolean isPersisted() {
        return persisted;
    }

    public void setPersisted(boolean persisted) {
        this.persisted = persisted;
    }

    public UseDto() {
        super();

        this.setDescription(Description.SEND_RECEIVE.getValue());
        this.setNotificationType(NotificationType.IMMEDIATE);
        this.setConfirmationType(NotificationType.IMMEDIATE);
        this.setAcknowledgement(NotificationType.NONE);
        this.setFileRecognizer(FileRecognizer.NONE.getValue());
        this.setSortComparator(SortComparator.DATE.getValue());
        this.setFileRenamer(FileRenamer.DEFAULT.getValue());
        this.setTextMessage(BooleanYesNo.NO.getValue());
        this.setFileSizeLimit(BigDecimal.valueOf(70));
        this.setTimeLimitDays(BigDecimal.valueOf(30));
        this.setMulti(false);
        this.setRulesbasedaccountDto(new RulesbasedaccountDto());
    }

    public NotificationType getAcknowledgement() {
        return acknowledgement;
    }

    public void setAcknowledgement(NotificationType acknowledgement) {
        this.acknowledgement = acknowledgement;
    }

    public NotificationType getConfirmationType() {
        return confirmationType;
    }

    public void setConfirmationType(NotificationType confirmationType) {
        this.confirmationType = confirmationType;
    }

    public Date getCreateDate() {
        return createDate;
    }

    public void setCreateDate(Date createDate) {
        this.createDate = createDate;
    }

    public String getCreateUser() {
        return createUser;
    }

    public void setCreateUser(String createUser) {
        this.createUser = createUser;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getFileRecognizer() {
        return fileRecognizer;
    }

    public void setFileRecognizer(String fileRecognizer) {
        this.fileRecognizer = fileRecognizer;
    }

    public String getFileRenamer() {
        return fileRenamer;
    }

    public void setFileRenamer(String fileRenamer) {
        this.fileRenamer = fileRenamer;
    }

    public BigDecimal getFileSizeLimit() {
        return fileSizeLimit;
    }

    public void setFileSizeLimit(BigDecimal fileSizeLimit) {
        this.fileSizeLimit = fileSizeLimit;
    }

    public String getGetLabel() {
        return getLabel;
    }

    public void setGetLabel(String getLabel) {
        this.getLabel = getLabel;
    }

    public Date getModifyDate() {
        return modifyDate;
    }

    public void setModifyDate(Date modifyDate) {
        this.modifyDate = modifyDate;
    }

    public String getModifyUser() {
        return modifyUser;
    }

    public void setModifyUser(String modifyUser) {
        this.modifyUser = modifyUser;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public NotificationType getNotificationType() {
        return notificationType;
    }

    public void setNotificationType(NotificationType notificationType) {
        this.notificationType = notificationType;
    }

    public String getSearchFields() {
        return searchFields;
    }

    public void setSearchFields(String searchFields) {
        this.searchFields = searchFields;
    }

    public String getSendLabel() {
        return sendLabel;
    }

    public void setSendLabel(String sendLabel) {
        this.sendLabel = sendLabel;
    }

    public String getSortComparator() {
        return sortComparator;
    }

    public void setSortComparator(String sortComparator) {
        this.sortComparator = sortComparator;
    }

    public String getTextMessage() {
        return textMessage;
    }

    public void setTextMessage(String textMessage) {
        this.textMessage = textMessage;
    }

    public BigDecimal getTimeLimit() {
        return timeLimit;
    }

    public void setTimeLimit(BigDecimal timeLimit) {
        this.timeLimit = timeLimit;
    }

    public String getUseId() {
        return useId;
    }

    public void setUseId(String useId) {
        this.useId = useId;
    }

    @Override
    public String toString() {

        return new GsonBuilder().excludeFieldsWithoutExposeAnnotation().create().toJson(this);
    }

    public boolean isMulti() {
        return multi;
    }

    public void setMulti(boolean multi) {
        this.multi = multi;
    }

    public BigDecimal getTimeLimitDays() {
        if (this.timeLimit == null) {
            return null;
        }

        return this.timeLimit.divide(BigDecimal.valueOf(24));
    }

    public void setTimeLimitDays(BigDecimal value) {
        this.timeLimit = value.multiply(BigDecimal.valueOf(24));
    }

    public RulesbasedaccountDto getRulesbasedaccountDto() {
        return rulesbasedaccountDto;
    }

    public void setRulesbasedaccountDto(RulesbasedaccountDto rulesbasedaccountDto) {
        this.rulesbasedaccountDto = rulesbasedaccountDto;
    }

    public ca.bc.gov.health.sfds.files.FileRenamer getRenamer() {
        switch (FileRenamer.get(this.getFileRenamer())) {
            case HCC:
                return new HCCRenamer();
            case MHMRR:
                return new MHMRRRenamer();
            case HSCIS:
                return new HSCISRenamer();
            case DEFAULT:
            default:
                return new DefaultRenamer();
        }
    }

    public MetaDto getMeta() {
        return new MetaDto(this.getUseId(), this.getName());
    }

}
