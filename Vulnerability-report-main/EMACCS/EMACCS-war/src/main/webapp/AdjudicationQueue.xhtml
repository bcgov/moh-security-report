<?xml version="1.0" encoding="UTF-8"?>
<!--
    Document: AdjudicationQueue.xhtml
    Created: Mon Nov 22 16:48:29 PST 2012
    Author: Dan Stepanov-->
<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/templates/gov30Template.xhtml">
    <ui:define name="title"><h:outputText value="#{msg['AdjudicationQueue.desc']}"/></ui:define>
    <ui:define name="body">

        <h1>#{msg['AdjudicationQueue.desc']}</h1>
        
        <h:form id="form1">
            <h:panelGroup rendered="#{!User.licenceNo.isEmpty()}">
                <h:outputText id="navWarning" value="#{msg['Navigation.warning']}" styleClass="text-danger" />
                
                <p:panel id="search" header="Search Form" style="margin-bottom: 20px">
                    
                    <div class="ui-g">                
                        <div class="ui-g-3">
                            <h:outputLabel value="#{msg['EmergencyMedicalAssistant.lname.desc']}"/><br/> 
                            <p:inputText value="#{AdjudicationQueue.paramsLicenceMaintenance.regisId.lname}" size="20" maxlength="20" />
                        </div>
                        
                        <div class="ui-g-9">
                            <h:outputLabel value="#{msg['OtherActivity.reportingYearId.desc']}"/><br/>
                            <h:selectOneMenu value="#{AdjudicationQueue.paramsLicenceMaintenance.reportyr.id}">
                                <f:selectItems value="#{Droplists.reportingYears}"></f:selectItems>
                            </h:selectOneMenu>
                        </div>
                        
                        <div class="ui-g-3">
                            <h:outputLabel value="#{msg['EmergencyMedicalAssistant.fname.desc']}"/><br/>
                            <p:inputText value="#{AdjudicationQueue.paramsLicenceMaintenance.regisId.fname}" size="20" maxlength="20" />
                        </div>
                        
                        <div class="ui-g-9">
                            <h:outputLabel value="#{msg['OtherActivity.assignedTo.desc']}"/> <br/>      
                            <h:selectOneMenu value="#{AdjudicationQueue.paramsLicenceMaintenance.assignedToUsername}" >
                                <f:selectItem itemValue="" itemLabel=""/>
                                <f:selectItems value="#{AdjudicationQueue.users}"/>
                            </h:selectOneMenu>
                        </div>
                        
                        <div class="ui-g-3">
                            <h:outputLabel value="#{msg['EmergencyMedicalAssistant.licno.desc']}"/><br/>
                            <p:inputText value="#{AdjudicationQueue.paramsLicenceMaintenance.licno}" size="6" maxlength="6" />
                        </div>
                        
                        <div class="ui-g-12">
                            <p:commandButton id="searchBtn" styleClass="submit-button"
                                                   action="#{AdjudicationQueue.search}"
                                                   onclick="$('.interactiveButton').attr('disabled','disabled');"
                                                   oncomplete="$('.interactiveButton').removeAttr('disabled');"
                                                   value="#{msg['button.search']}"
                                                   update="form1"/>
                            
                            <p:commandLink id="clearBtn" process="@this"
                                               action="#{AdjudicationQueue.clear}"
                                               onclick="$('.interactiveButton').attr('disabled','disabled');"
                                               oncomplete="$('.interactiveButton').removeAttr('disabled');"
                                               value="#{msg['button.clear']}"
                                               update="form1"/>
                        </div>
                    </div>
                </p:panel>

                <p:dataTable value="#{AdjudicationQueue.resultsLicence}" var="row" rows="10" id="resultsTable" style="margin-bottom:20px"
                             paginator="true" paginatorPosition="top" paginatorAlwaysVisible="false" rendered="#{AdjudicationQueue.resultsLicence!=null}"
                             paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}">
                    
                    <f:facet name="header">
                        #{msg['AdjudicationQueue.results']}
                        <h:outputText value="(Result Count: #{AdjudicationQueue.resultsLicence.size()})"
                                      style="font-weight: 400"/>
                    </f:facet>

                    <p:column style="width: 10px">
                        <h:graphicImage rendered="#{row.regisId.status.wsgcode=='S10'}" id="adjPendingStatus" alt="" value="/images/yellow-bullet.png" width="10"/>
                    </p:column>

                    <p:column sortBy="#{row.regisId.licno}">
                        <f:facet name="header">Licence<br/>Number</f:facet>
                        <h:outputText value="#{row.regisId.licno}"/>
                    </p:column>

                    <p:column sortBy="#{row.regisId.lname}">
                        <f:facet name="header">Licencee<br/>Name</f:facet>
                        <h:outputText value="#{row.regisId.fname} #{row.regisId.lname}"/>
                    </p:column>

                    <p:column sortBy="#{row.statusDate}">
                        <f:facet name="header">Status<br/>Date</f:facet>
                        <h:outputText value="#{AdjudicationQueue.getAsBasicDateString(row.statusDate)}">
                        </h:outputText>
                    </p:column>

                    <p:column headerText="#{msg['EmergencyMedicalAssistant.status.desc']}">
                        <h:selectOneMenu id="emaStatusDropdown" value="#{row.ccode.ccode}" style="width: 100%">
                            <f:selectItem itemValue="" itemLabel=""/>
                            <f:selectItems value="#{AdjudicationQueue.lkcmedats}"></f:selectItems>
                        </h:selectOneMenu>
                    </p:column>

                    <p:column sortBy="#{row.assignedToUsername}" headerText="Assigned To">
                       <ui:remove>
                        <h:selectOneMenu value="#{row.assignedToUsername}" style="width: 100%">
                            <f:selectItem itemValue="" itemLabel=""/>
                            <f:selectItems value="#{AdjudicationQueue.users}"/>
                        </h:selectOneMenu>
                        </ui:remove>
                        <p:inputText value="#{row.assignedToUsername}" size="20" maxlength="20" />
                    </p:column>

                    <p:column headerText="Reccomendation" style="width: 140px;">
                        <h:selectOneMenu id="recommendationDropdown" value="#{row.examRecommendation.id}"
                                         style="width: 100%">
                            <f:selectItems value="#{AdjudicationQueue.lkexamtype}"></f:selectItems>
                        </h:selectOneMenu>
                    </p:column>

                    <p:column>
                        <f:facet name="header"><h:outputText value="#{msg['AdjudicationQueue.patient.desc']} &lt;br/&gt;#{msg['AdjudicationQueue.contacts.desc']} &lt;br/&gt;Pre/Post" escape="false"/></f:facet>
                        <h:outputText rendered="#{row.regisId.patientContactList!=null}" value="#{row.patientCount_Pre}/#{row.patientCount_Post}"/>
                    </p:column>

                    <p:column>
                        <f:facet name="header"><h:outputText value="#{msg['AdjudicationQueue.approvedActs.desc']} &lt;br/&gt;#{msg['AdjudicationQueue.credits.desc']}&lt;br/&gt; Pre/Post" escape="false" /></f:facet>
                        <h:outputText value="#{row.approvedActivityCredits_Pre} / #{row.approvedActivityCredits_Post}"/>
                    </p:column>

                    <p:column>
                        <f:facet name="header"><h:outputText value="#{msg['AdjudicationQueue.otherActs.desc']} &lt;br/&gt;#{msg['AdjudicationQueue.credits.desc']}&lt;br/&gt; Pre/Post" escape="false"/></f:facet>
                        <h:outputText value="#{row.otherActivityCredits_App}/#{row.otherActivityCredits_Adj}"/>
                    </p:column>

                    <p:column id="dirApproval">
                        <f:facet name="header">Director<br/>Approval</f:facet>
                        <h:selectOneMenu id="directorApprovalDropdown" value="#{row.directorApproval.id}" rendered="#{row.ccode.ccode=='T302'||row.ccode.ccode=='T305'}">
                            <f:selectItems value="#{AdjudicationQueue.lkadjstatus}"></f:selectItems>
                        </h:selectOneMenu>
                    </p:column>

                    <p:column>
                        <f:facet name="header">Last<br/>Approval<br/>Status</f:facet>
                        <h:panelGroup rendered="#{!row.directorApproval.addesc.equals(' ')}">
                            <h:outputText value="#{AdjudicationQueue.getAsBasicDateString(row.lastDirectorApprovalDate)}">
                            </h:outputText><br />
                            <h:outputText value="#{row.directorApproval.addesc}"/><br />
                            <h:outputText value="#{row.lastEmaStatus.cdesc}"/>
                        </h:panelGroup>
                        <h:outputText value="N/A" rendered="#{row.directorApproval.addesc.equals(' ')}" />
                    </p:column>

                    <p:column styleClass="center">
                        <f:facet name="header">View<br/>Details</f:facet>
                        <p:commandLink id="detailsContactsLink" process="@this"
                                       value="#{msg['AdjudicationQueue.contacts.desc']}"
                                       action="#{LogPatientContacts.navigateTo}">
                            <f:setPropertyActionListener id="detailsContactsLinkIndex"
                                       value="#{row.regisId.regisId}" 
                                       target="#{AdjudicationQueue.selectedKey}"/>
                            <f:setPropertyActionListener id="viewContactsEmaParam"
                                                         target="#{flash.emaId}"
                                                         value="#{row.regisId.regisId}" />
                            <f:setPropertyActionListener id="viewContactsLicNoParam"
                                                         target="#{flash.licenceNumber}"
                                                         value="#{row.regisId.licno}" />
                            <f:setPropertyActionListener id="viewContactsRepYrParam"
                                                         target="#{flash.reportingYearId}"
                                                         value="#{row.reportyr.id}" />
                        </p:commandLink>
                        <br />
                        <p:commandLink id="detailsActivitiesLink" process="@this"
                                       value="#{msg['AdjudicationQueue.activities']}"
                                       action="#{AdjudicationQueue.selectOtherActivity}">
                            <f:setPropertyActionListener id="detailsActivitiesLinkIndex"
                                                            value="#{row.regisId.regisId}"
                                                            target="#{AdjudicationQueue.selectedKey}"/>
                            <f:setPropertyActionListener id="viewActivitiesEmaParam"
                                                         target="#{flash.emaId}"
                                                         value="#{row.regisId.regisId}" />
                            <f:setPropertyActionListener id="viewActivitiesRepYrParam"
                                                         target="#{flash.reportingYearId}"
                                                         value="#{row.reportyr.id}" />
                        </p:commandLink>

                        <p:commandButton id="selectDetailsButton" 
                                           value="Details" process="@this"
                                           action="#{AdjudicationQueue.select}" styleClass="datatable-options"
                                           onmouseover="window.status = 'Click to view CC Details';
                                                return true;"
                                           onmouseout="window.status = '';
                                                return true;">
                            <f:setPropertyActionListener id="emaId"
                                       value="#{row.regisId.regisId}"
                                       target="#{AdjudicationQueue.selectedKey}"/>
                            <f:setPropertyActionListener id="licenceNumberParam"
                                                         target="#{flash.licenceNumber}"
                                                         value="#{row.regisId.licno}" />
                            <f:setPropertyActionListener id="emaIdParam"
                                                         target="#{flash.emaId}"
                                                         value="#{row.regisId.regisId}" />
                            <f:setPropertyActionListener id="reportYrParam"
                                                         target="#{flash.reportingYearId}"
                                                         value="#{row.reportyr.id}" />
                        </p:commandButton>
                    </p:column>
                </p:dataTable>

                <p:commandButton id="saveBtn" styleClass="submit-button"
                                 type="submit"
                                 action="#{AdjudicationQueue.save}"
                                 value="#{msg['button.save']}"
                                 update="form1 global-messages"/>

                <p:commandLink id="cancelBtn"
                                   action="#{AdjudicationQueue.cancel}"
                                   value="#{msg['button.cancel']}"
                                   update="form1"/>

            </h:panelGroup>
        </h:form>
    </ui:define>
</ui:composition>
