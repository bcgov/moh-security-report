<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:emaccs="http://java.sun.com/jsf/composite/emaccs"
                template="/WEB-INF/templates/gov30Template.xhtml">
    <ui:define name="title">My Contact Information</ui:define>
    <ui:define name="body">

        <h1>My Contact Information</h1>   
        <h:form id="form1">

            <ui:fragment rendered="#{User.isInactive}">
                <ui:include src="/WEB-INF/fragments/noAccess.xhtml" />
            </ui:fragment>

            <ui:fragment rendered="#{not User.isInactive}">
                <h:panelGroup id="licenceNumber" style="padding-left: 25px; margin-bottom: 20px">
<!--                    <p:panelGrid columns="2" styleClass="borderless ui-grid-blank" layout="grid" -->
<!--                                 columnClasses="ui-grid-col-1 label-col, ui-grid-col-4" style="margin-bottom: 20px">-->

                        #{msg['EmergencyMedicalAssistant.licno.desc']}:
                        <p:inputText value="#{MyContactInformation.licenceNumber}" size="10" maxlength="6" label="LicenceNumber" id="LicenceNumber" 
                                     valueChangeListener="#{MyContactInformation.changeLicenceNumber}"
                                     style="margin-left:20px; margin-right: 20px" >
<!--                            <p:ajax event="change" update="form1 global-messages" process="@this" />-->
                        </p:inputText>
                    <p:commandButton action="#{MyContactInformation.search}"  styleClass="submit-button interactiveButton"
                                     value="#{msg['button.search']}"
                                     update="form1 global-messages" partialSubmit="true" process="LicenceNumber" />
<!--                    </p:panelGrid>-->

                </h:panelGroup>

                <h:panelGroup rendered="#{!MyContactInformation.licenceNumber.isEmpty() and MyContactInformation.validLicenceNumber}">

                    <h:outputText rendered="#{User.returnedMail}" value="#{msg['EmergencyMedicalAssistant.returnmail.desc']}" styleClass="text-danger"/>
                    <h:outputText id="navWarning" value="#{msg['Navigation.warning']}" styleClass="text-danger"/>

                    <p:panel id="entry" header="Edit Contact Information">
                        <h:inputHidden value="#{MyContactInformation.emergencyMedicalAssistant.returnmail}" id="returnmail" />
                        <p:messages/>
                        <div class="ui-g">
                            <div class="ui-g-5">
                                <span class="required">* </span> <p:outputLabel for="address" value="Address" /> <br/>
                                <p:inputText id="address" value="#{MyContactInformation.emergencyMedicalAssistant.address}" size="40" required="true"
                                             requiredMessage="#{msg['EmergencyMedicalAssistant.address.desc']} is required" 
                                             onchange="unsetReturned()" />
                            </div>
                            <div class="ui-g-7">
                                If you need to enter a foreign (non-Canadian) address, please submit the 
                                <a href="https://www.health.gov.bc.ca/exforms/ema/7107.html">
                                    contact information update</a> form, as some options are not available on this screen.
                            </div>

                            <div class="ui-g-12">
                                <span class="required">* </span><p:outputLabel for="city" value="City" /> <br/>
                                <p:inputText value="#{MyContactInformation.emergencyMedicalAssistant.city}" size="40" maxlength="20" required="true"
                                             requiredMessage="#{msg['EmergencyMedicalAssistant.city.desc']} is required" onchange="unsetReturned()" id="city" />
                            </div>

                            <div class="ui-g-2">
                                <span class="required">* </span><p:outputLabel for="prov" value="Province" /> <br/>
                                <h:selectOneMenu value="#{MyContactInformation.emergencyMedicalAssistant.prov}" style="min-width: 100px"
                                                 required="true" requiredMessage="#{msg['EmergencyMedicalAssistant.prov.desc']} is required" 
                                                 onchange="unsetReturned()" id="prov">
                                    <f:selectItems value="#{Droplists.provinces}" />
                                </h:selectOneMenu>
                            </div>

                            <div class="ui-g-10" style="margin-left: -7%;">
                                <span class="required">* </span><p:outputLabel for="postal" value="Postal Code" /> <br/>
                                <p:inputText value="#{MyContactInformation.emergencyMedicalAssistant.pcode}" size="7" maxlength="7"
                                             required="true" requiredMessage="#{msg['EmergencyMedicalAssistant.pcode.desc']} is required"
                                             onchange="unsetReturned()" id="postal">
                                    <f:validator validatorId="validator.postalCodeFormat"/>
                                </p:inputText>
                            </div>                     

                            <div class="ui-g-2">
                                <span class="required">* </span><p:outputLabel for="phonePri" value="Primary Contact #" /> <br/>
                                <p:inputText value="#{MyContactInformation.emergencyMedicalAssistant.phone}"
                                             size="17" maxlength="17"
                                             required="true"
                                             requiredMessage="#{msg['EmergencyMedicalAssistant.phone.desc']} is required"
                                             id="phonePri"
                                             >
                                    <f:validator validatorId="validator.phoneNumberLength"/>
                                </p:inputText>
                            </div>

                            <div class="ui-g-6">
                                <p:outputLabel for="phoneAlt" value="Alternate Contact #" /> <br/>
                                <p:inputText value="#{MyContactInformation.emergencyMedicalAssistant.altphone}" 
                                             size="17" maxlength="17" id="phoneAlt">
                                    <f:validator validatorId="validator.phoneNumberLength"/>
                                </p:inputText>
                            </div>

                            <div class="ui-g-12">
                                <span class="required">* </span><p:outputLabel for="email" value="Primary Email Address" /> <br/>
                                <p:inputText value="#{MyContactInformation.emergencyMedicalAssistant.email}"
                                             size="40" maxlength="54" id="email" required="true"
                                             requiredMessage="Primary email is required">
                                    <f:validator validatorId="validator.emailFormat"/>
                                </p:inputText>
                            </div>

                            <div class="ui-g-12">
                                <p:outputLabel for="secondaryEmail" value="Secondary Email Address" /> <br/>
                                <p:inputText value="#{MyContactInformation.secondaryEmail}"
                                             size="40" maxlength="54" id="secondaryEmail">
                                    <f:validator validatorId="validator.emailFormat"/>
                                </p:inputText>
                            </div>

                            <div class="ui-g-12">
                                <p:outputLabel value="Last Updated" /> <br/>
                                <p:inputText value="#{MyContactInformation.getAsBasicDateString(MyContactInformation.emergencyMedicalAssistant.lastModifiedOnDtm)}" size="17" 
                                             disabled="true" id="lastUpdated" rendered="#{MyContactInformation.emergencyMedicalAssistant.lastModifiedOnDtm != null}"/>
                                <p:inputText value="#{MyContactInformation.getAsBasicDateString(MyContactInformation.emergencyMedicalAssistant.createdOnDtm)}" size="17"
                                             disabled="true" id="createdOnDtm" rendered="#{MyContactInformation.emergencyMedicalAssistant.lastModifiedOnDtm == null}"/>
                            </div>

                            <div class="ui-g-12">
                                <p:commandButton action="#{MyContactInformation.update}" 
                                                 value="#{msg['button.save']}" update="form1" styleClass="submit-button"/>

                                <p:commandLink action="#{MyContactInformation.clear}" value="#{msg['button.cancel']}" update="form1" 
                                               process="@this"/>
                            </div>         
                        </div>
                    </p:panel>
                </h:panelGroup>
            </ui:fragment>
        </h:form>
    </ui:define>
</ui:composition>
