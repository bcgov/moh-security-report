package ca.bc.gov.health.security;

import fish.payara.security.annotations.ClaimsDefinition;
import fish.payara.security.annotations.OpenIdAuthenticationDefinition;

/**
 * Configures an OIDC Client
 *
 * @author CGI Information Management Consultants Inc.
 */
@OpenIdAuthenticationDefinition(
        providerURI = "#{oidcConfig.providerUri}",
        clientId = "#{oidcConfig.clientId}",
        clientSecret = "#{oidcConfig.clientSecret}",
        redirectURI = "#{oidcConfig.redirectUri}",
        scope = "#{oidcConfig.scope}",
        claimsDefinition = @ClaimsDefinition(callerNameClaim = "#{oidcConfig.callerNameClaim}", callerGroupsClaim = "#{oidcConfig.callerGroupsClaim}"),
        /* Default jwksConnectTimeout values can trigger com.nimbusds.jose.RemoteKeySourceException: Couldn't retrieve remote JWK set: connect timed out */
        jwksConnectTimeout = 2000,
        /* Default jwksReadTimeout values can trigger com.nimbusds.jose.RemoteKeySourceException: Couldn't retrieve remote JWK set: Read timed out */
        jwksReadTimeout = 2000,
        /* extraParameters cannot reference CDI bean property unlike the other options above */
        extraParameters = {
            /* Comma separated list of which identity providers show up on the login page. By default all are shown. */
            "idps_to_show=idir,moh_idp"
        })
public class KeycloakSecurityBean {
}
